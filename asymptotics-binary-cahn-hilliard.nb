(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    365451,       8808]
NotebookOptionsPosition[    343509,       8477]
NotebookOutlinePosition[    344017,       8496]
CellTagsIndexPosition[    343974,       8493]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Binary Cahn-Hilliard Asymptotics", "Title",
 CellChangeTimes->{{3.933267422020184*^9, 3.933267429750689*^9}, {
  3.9412520630120783`*^9, 3.941252066100484*^9}, {3.941293321364293*^9, 
  3.941293328453167*^9}, {3.94129336901433*^9, 3.9412933702676787`*^9}, {
  3.950145411129249*^9, 
  3.95014541249474*^9}},ExpressionUUID->"9957c294-0a75-4edb-b5e5-\
9fa1a6fed270"],

Cell[CellGroupData[{

Cell["Introduction", "Chapter",
 CellChangeTimes->{{3.9412935616519737`*^9, 
  3.941293562950368*^9}},ExpressionUUID->"3fa8cc1f-a853-49b5-80a7-\
65381421731e"],

Cell[CellGroupData[{

Cell["Binary Cahn-Hilliard", "Section",
 CellChangeTimes->{{3.941293566151616*^9, 
  3.941293572386099*^9}},ExpressionUUID->"a2fc9a33-21f9-4606-a116-\
ab325b887aea"],

Cell[TextData[{
 "This notebook derives the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CurlyEpsilon]", "->", "0"}], TraditionalForm]],ExpressionUUID->
  "ff5e6b0b-b9a7-4348-803b-e7b05e1d5109"],
 " singular limit of a three-phase generalisation of the Cahn-Hilliard \
equation."
}], "Text",
 CellChangeTimes->{{3.941293329738095*^9, 3.941293376691072*^9}, {
  3.949072819533813*^9, 
  3.949072820166726*^9}},ExpressionUUID->"d33044d5-ed65-4aa1-8f0d-\
931d4809a59a"],

Cell[TextData[{
 "To reproduce the known behaviour of the classic Cahn-Hilliard equation, the \
traditional Ginzburg-Landau free energy functional for a single scalar valued \
field ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", ":", "\[CapitalOmega]"}], "->", 
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "4b995367-5ce3-4cc1-8583-4f6e6f70290b"],
 ", representing a local volume concentration is defined by"
}], "Text",
 CellChangeTimes->{{3.9412933800859003`*^9, 3.941293466838044*^9}, {
  3.941293594417304*^9, 
  3.941293603369301*^9}},ExpressionUUID->"93a75d16-71d8-4ba9-a8bc-\
7709e2db438b"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"c", ";", "\[CurlyEpsilon]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Integral]", "\[CapitalOmega]"], 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", "\[CurlyEpsilon]"}]], 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["c", "2"], "(", 
        RowBox[{"1", "-", "c"}], ")"}], "2"]}]}], "+", 
    RowBox[{
     FractionBox["\[CurlyEpsilon]", "2"], 
     RowBox[{
      RowBox[{"\[Del]", "c"}], "\[CenterDot]", 
      RowBox[{"\[Del]", "c"}]}], " ", "dA"}]}]}], 
  TraditionalForm]],ExpressionUUID->"504bde18-3944-4ee4-8316-a86b22fb0db2"]], \
"Text",
 CellChangeTimes->{{3.941293470099112*^9, 
  3.941293544819295*^9}},ExpressionUUID->"d714e0ab-0bb9-4503-bb3a-\
42479fd1ffe5"],

Cell[TextData[{
 "To derive an evolution law for the ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "16ade9c8-2434-4a6e-afcc-e6a1e931e3a4"],
 ", we assume a gradient flow for the free energy ",
 Cell[BoxData[
  FormBox["F", TraditionalForm]],ExpressionUUID->
  "a2adb8cb-fb7f-4e55-9ac1-af1abf5fbfcc"],
 ", measured in the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "1"], TraditionalForm]],ExpressionUUID->
  "2efcd91d-0c6f-4a2a-bec4-cc91b7cea11d"],
 " norm. To derive it, we examine the total derivative of the free energy"
}], "Text",
 CellChangeTimes->{{3.941293606920192*^9, 
  3.941293698652288*^9}},ExpressionUUID->"3b67e6ef-684b-4bc9-a155-\
06ed84d10fbd"],

Cell[TextData[Cell[BoxData[{
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["d", "dt"], 
    RowBox[{"F", "[", "c", "]"}]}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Integral]", "\[CapitalOmega]"], " ", 
     RowBox[{
      FractionBox["1", "\[CurlyEpsilon]"], 
      RowBox[{"c", "(", 
       RowBox[{"1", "-", "c"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "c"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "t"], "c"}]}]}], " ", "+", 
    RowBox[{"\[CurlyEpsilon]", " ", 
     RowBox[{
      RowBox[{"\[Del]", "c"}], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], "c"}]}]}], " ", "dA"}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"\t", 
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Integral]", "\[CapitalOmega]"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "\[CurlyEpsilon]"], 
          RowBox[{"c", "(", 
           RowBox[{"1", "-", "c"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "c"}]}], ")"}]}], " ", "-", 
         RowBox[{"\[CurlyEpsilon]", " ", "\[CapitalDelta]", " ", "c"}]}], 
        ")"}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], "c"}], " ", "dA"}]}], " ", "+", " ",
      "BC"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"\t", 
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Integral]", "\[CapitalOmega]"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "\[CurlyEpsilon]"], 
         RowBox[{"c", "(", 
          RowBox[{"1", "-", "c"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "c"}]}], ")"}]}], " ", "-", 
        RowBox[{"\[CurlyEpsilon]", " ", "\[CapitalDelta]", " ", "c"}]}], 
       ")"}], 
      RowBox[{"\[CapitalDelta]", "(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "\[CurlyEpsilon]"], 
         RowBox[{"c", "(", 
          RowBox[{"1", "-", "c"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "c"}]}], ")"}]}], " ", "-", 
        RowBox[{"\[CurlyEpsilon]", " ", "\[CapitalDelta]", " ", "c"}]}], 
       ")"}], " ", "dA"}]}]}]}], TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"\t", 
   RowBox[{"=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Integral]", "\[CapitalOmega]"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"\[LeftBracketingBar]", 
          RowBox[{"\[Del]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "\[CurlyEpsilon]"], 
              RowBox[{"c", "(", 
               RowBox[{"1", "-", "c"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", "c"}]}], ")"}]}], " ", "-", 
             RowBox[{"\[CurlyEpsilon]", " ", "\[CapitalDelta]", " ", "c"}]}], 
            ")"}]}], "\[RightBracketingBar]"}], "2"], " ", "dA"}]}]}], "+", 
     "BC"}]}]}], 
  TraditionalForm]}],ExpressionUUID->"0b92d2d1-5dfc-4e3b-9ca1-294531fe52e9"]],\
 "Text",
 CellChangeTimes->{{3.941293701406988*^9, 3.941293777687896*^9}, {
  3.9412939206746063`*^9, 3.941294043227878*^9}, {3.9412940811472588`*^9, 
  3.9412940811473703`*^9}, {3.9412941871296597`*^9, 3.941294190751223*^9}, {
  3.9412942369992123`*^9, 3.941294238247102*^9}, {3.942597211739393*^9, 
  3.942597221672501*^9}},ExpressionUUID->"e439fce4-6949-4d4d-bda5-\
212166485781"],

Cell[TextData[{
 "where we integrated by parts twice to show that the evolution law specified \
in the third line leads to a negative definite expression that guarantees the \
free energy will decrease over time.\nThat is, we have the system\n\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"\[CurlyEpsilon]", 
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], "c"}]}], "=", 
    RowBox[{"\[CapitalDelta]", " ", "m"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"m", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "'"}], 
      RowBox[{"(", "c", ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[CurlyEpsilon]", "2"], "\[CapitalDelta]", " ", 
      "c"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "c", ")"}], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["c", "2"], "(", 
       RowBox[{"1", "-", "c"}], ")"}], "2"]}]}], TraditionalForm]}],
  FormatType->TraditionalForm,ExpressionUUID->
  "cb508541-b145-4b7b-bb25-3aec7aa4fa4a"]
}], "Text",
 CellChangeTimes->{{3.9412939916085587`*^9, 3.941293993059185*^9}, {
  3.941294048213825*^9, 3.941294104178097*^9}, {3.950669883406652*^9, 
  3.950669951982568*^9}},ExpressionUUID->"e80ca07a-15dd-4f83-a16e-\
47972fcbf85b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Chapter",
 CellChangeTimes->{{3.928999415929866*^9, 
  3.9289994169683857`*^9}},ExpressionUUID->"2511758e-a1c1-43cf-8d83-\
d46e9bbe3aef"],

Cell["First, make it jump to the next code cell after evaluating", "Text",
 CellChangeTimes->{{3.942597369767076*^9, 
  3.9425973816867323`*^9}},ExpressionUUID->"d2f91a31-08f0-46bf-9164-\
6f28da40bdf1"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellProlog", ":>", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{
      RowBox[{"NextCell", "[", 
       RowBox[{"CellStyle", "->", "\"\<Input\>\""}], "]"}], ",", "All", ",", 
      "Cell"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.929083308751431*^9, 3.929083335513579*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d245ddc3-c3b7-481e-85e2-5132700e0656"],

Cell["\<\
The key to performing the asymptotic analysis is to break up the \
transformations into constituent steps. We implement some convenience \
functions to ease the process of applying many patterned transformations to \
the data. The key Mathematica tools are the replacement operator /. , and the \
Series function. This is the important one, applyTransforms, which starts \
with some expression, and applies a sequence of rules (possibly using \
patterns), or direct functions.\
\>", "Text",
 CellChangeTimes->{{3.941306375892534*^9, 3.941306446820347*^9}, {
  3.941655172376624*^9, 3.941655205581753*^9}, {3.942597401471642*^9, 
  3.942597410222584*^9}},ExpressionUUID->"4c8bc760-465c-480e-bbc0-\
425718bdc610"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{"exp_", ",", "transforms_", ",", 
    RowBox[{"print_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", "exp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Rule", ",", "RuleDelayed", ",", "List"}], "}"}], ",", 
            RowBox[{"Head", "[", "transform", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "transform", "]"}], ">", "1"}], "&&", 
             RowBox[{
              RowBox[{"transform", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", "\"\<Repeat\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"out", "=", 
             RowBox[{"out", "//.", 
              RowBox[{"transform", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"out", "=", 
             RowBox[{"out", "/.", "transform"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"out", "=", 
           RowBox[{"(", 
            RowBox[{"out", "//", "transform"}], ")"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"print", ",", 
          RowBox[{"Print", "[", "out", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"transform", ",", 
         RowBox[{"Select", "[", 
          RowBox[{"transforms", ",", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"#", "===", "Null"}], "]"}], "&"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.928999599254465*^9, 3.928999601643208*^9}, {
   3.930060658710493*^9, 3.930060658853343*^9}, {3.930060755161675*^9, 
   3.930060884819683*^9}, 3.930144427952158*^9, {3.930783594123849*^9, 
   3.930783645838066*^9}, {3.930783737454996*^9, 3.930783737918212*^9}, {
   3.930783780916743*^9, 3.93078378285373*^9}, {3.930784371641079*^9, 
   3.930784382931843*^9}, {3.931373264952323*^9, 3.9313732653446417`*^9}, {
   3.931374782684216*^9, 3.931374816258524*^9}, {3.931374961453587*^9, 
   3.931374967976866*^9}, {3.931400788714535*^9, 3.93140082483627*^9}, {
   3.931400972023016*^9, 3.931400978023467*^9}, {3.931554551103041*^9, 
   3.931554551338146*^9}, {3.931814725941661*^9, 3.931814726496642*^9}, {
   3.9361812299455214`*^9, 3.936181231954846*^9}, {3.9413064732832527`*^9, 
   3.9413064810601997`*^9}, {3.942597330662489*^9, 3.9425973313054943`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"97a0a8a2-d246-4e28-a03e-d9266675464a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"printReturn", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"Print", "[", "x", "]"}], ";", "x"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"printReturn", "[", "x_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", "x", "]"}], ";", "x"}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"printReturn", "[", 
     RowBox[{"x_", ",", "msg_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", "msg", "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<    \>\"", ",", "x"}], "]"}], ";", "x"}], ")"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.948868229541548*^9, 3.9488682451799307`*^9}, {
  3.9488683832211246`*^9, 3.9488684407579412`*^9}, {3.948868709055861*^9, 
  3.948868711311391*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"50c9be8c-32d2-4e38-bfdb-21c6784c8e77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"convenient", " ", "pattern", " ", "matching", " ", "functions"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"matchPatt", "[", "patt_List", "]"}], ":=", 
     RowBox[{"Function", "[", 
      RowBox[{"exp", ",", 
       RowBox[{"Or", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"matchPatt", "[", "#", "]"}], "[", "exp", "]"}], "&"}], 
          ",", "patt"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"matchPatt", "[", "patt_", "]"}], ":=", 
     RowBox[{"Function", "[", 
      RowBox[{"exp", ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"exp", ",", "patt"}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.928999599254465*^9, 3.928999601643208*^9}, {
   3.930060658710493*^9, 3.930060658853343*^9}, {3.930060755161675*^9, 
   3.930060884819683*^9}, 3.930144427952158*^9, {3.930783594123849*^9, 
   3.930783645838066*^9}, {3.930783737454996*^9, 3.930783737918212*^9}, {
   3.930783780916743*^9, 3.93078378285373*^9}, {3.930784371641079*^9, 
   3.930784382931843*^9}, {3.931373264952323*^9, 3.9313732653446417`*^9}, {
   3.931374782684216*^9, 3.931374816258524*^9}, {3.931374961453587*^9, 
   3.931374967976866*^9}, {3.931400788714535*^9, 3.93140082483627*^9}, {
   3.931400972023016*^9, 3.931400978023467*^9}, {3.931554551103041*^9, 
   3.931554551338146*^9}, {3.931814725941661*^9, 3.931814726496642*^9}, {
   3.9361812299455214`*^9, 3.936181231954846*^9}, {3.9413064732832527`*^9, 
   3.9413064810601997`*^9}, 3.9425973019135*^9, {3.9425973375285473`*^9, 
   3.942597337990509*^9}, {3.9494745555658484`*^9, 3.94947457234823*^9}, 
   3.949474735975726*^9, 3.9500951157707977`*^9, {3.950669977922347*^9, 
   3.950669982224999*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"63a54cc5-33c6-42d2-800a-ba5c5e58e255"],

Cell[BoxData[
 RowBox[{
  RowBox[{"patternToFunction", "[", "pat_", "]"}], ":=", 
  RowBox[{
   RowBox[{"pat", "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Longest", "[", "a_", "]"}], "[", "l___", "]"}], "->", "b_"}],
       ")"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "->", "b"}], ")"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"List", "[", "l", "]"}], "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Slot", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"List", "[", "l", "]"}], "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ")"}]}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a_", "->", "b_"}], ")"}], "->", 
    RowBox[{"(", 
     RowBox[{"a", "->", 
      RowBox[{"(", 
       RowBox[{"b", "&"}], ")"}]}], ")"}]}]}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"7b991653-62d5-41b8-9bed-f40f138e2a51"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expressions", "Chapter",
 CellChangeTimes->{{3.933267503336691*^9, 
  3.933267504815824*^9}},ExpressionUUID->"f723894c-d5a8-4ecd-a176-\
2abbbcbe47f7"],

Cell["\<\
We will use several dictionaries to store the intermediate expressions we \
generate (es), as well as the rules we use to transform them (rs).\
\>", "Text",
 CellChangeTimes->{{3.9413065389807663`*^9, 
  3.941306583308016*^9}},ExpressionUUID->"cc2f5f5c-f733-4666-b10b-\
db1ea202a563"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "=", 
    RowBox[{"<|", "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<evalFuncs\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a_", "->", 
      RowBox[{
       RowBox[{"HoldPattern", "[", "Function", "]"}], "[", 
       RowBox[{"l__", ",", "b_"}], "]"}]}], ")"}], ":>", 
    RowBox[{"(", 
     RowBox[{"a", "->", 
      RowBox[{"Function", "[", 
       RowBox[{"l", ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Simplify", "[", "b", "]"}], "]"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<f\>\"", "]"}], "=", 
   RowBox[{"f", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["#1", "2"]}], ")"}], "2"]}], "&"}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.925410686925483*^9, 3.9254107660507603`*^9}, {
   3.925410830387848*^9, 3.92541089017825*^9}, {3.925410928891109*^9, 
   3.925410980717381*^9}, {3.925411063527159*^9, 3.925411310957692*^9}, {
   3.925411439270929*^9, 3.925411489255529*^9}, {3.925411528545823*^9, 
   3.925411560905282*^9}, {3.925411603206799*^9, 3.925411679947967*^9}, {
   3.925411712171166*^9, 3.9254117849856586`*^9}, {3.925411820821084*^9, 
   3.925411965914876*^9}, {3.925412020805942*^9, 3.925412193962242*^9}, {
   3.925412226276422*^9, 3.925412346350092*^9}, {3.925412379987615*^9, 
   3.925412415176692*^9}, {3.925412468394409*^9, 3.925412531083593*^9}, {
   3.925412574775857*^9, 3.925412646440061*^9}, {3.9254126825785*^9, 
   3.925412851470252*^9}, {3.92541289283495*^9, 3.925412965820825*^9}, {
   3.92541341097471*^9, 3.925413576240059*^9}, {3.925413610945981*^9, 
   3.925413722244555*^9}, {3.925413774573417*^9, 3.925413777120391*^9}, {
   3.925413834372891*^9, 3.9254138356746273`*^9}, {3.925413882990925*^9, 
   3.925414091078267*^9}, {3.92541412661858*^9, 3.925414309573999*^9}, {
   3.92541434615676*^9, 3.925414364311376*^9}, {3.92541453063266*^9, 
   3.9254145546585407`*^9}, {3.925414593356914*^9, 3.9254146605777*^9}, {
   3.925414710591429*^9, 3.925414768974921*^9}, {3.925414804162609*^9, 
   3.925414823974945*^9}, {3.925414867068237*^9, 3.925414905228904*^9}, {
   3.925414936993082*^9, 3.925415107049269*^9}, {3.9254151432451463`*^9, 
   3.925415213722327*^9}, {3.925415245710903*^9, 3.9254153985629*^9}, {
   3.925415487219271*^9, 3.925415512213025*^9}, {3.925415562169866*^9, 
   3.9254155918739347`*^9}, {3.925415700529805*^9, 3.9254157735914583`*^9}, {
   3.925415873175067*^9, 3.925415873331398*^9}, {3.925416011413009*^9, 
   3.925416173668475*^9}, {3.925416211931176*^9, 3.925416489236919*^9}, {
   3.925416532983465*^9, 3.925416533669909*^9}, {3.925416598658949*^9, 
   3.925416914141212*^9}, {3.925416944913143*^9, 3.92541706556323*^9}, {
   3.9254171058965054`*^9, 3.925417118786487*^9}, {3.925417149516284*^9, 
   3.92541718902902*^9}, {3.925417258027317*^9, 3.925417358742579*^9}, {
   3.925417407507038*^9, 3.925417411791795*^9}, {3.925417449008486*^9, 
   3.925417551991803*^9}, {3.92541758520912*^9, 3.925417585635527*^9}, {
   3.925417741720288*^9, 3.925417753993677*^9}, {3.925417821282898*^9, 
   3.925417881143179*^9}, {3.925417937391917*^9, 3.925417955259959*^9}, {
   3.925430411278133*^9, 3.925430416478302*^9}, {3.925430497175742*^9, 
   3.925430513667574*^9}, 3.925430579635147*^9, {3.925430710807773*^9, 
   3.9254307127607822`*^9}, {3.925430818810457*^9, 3.925430864896277*^9}, {
   3.925463644874638*^9, 3.925463704270145*^9}, {3.925463764042646*^9, 
   3.925463800376926*^9}, {3.9254639765867033`*^9, 3.9254640089047213`*^9}, {
   3.925464046201472*^9, 3.925464074216558*^9}, {3.925470105442244*^9, 
   3.925470215381029*^9}, {3.925470328810892*^9, 3.925470388735385*^9}, 
   3.925470429582185*^9, {3.925470465716573*^9, 3.925470604639782*^9}, {
   3.925470652142866*^9, 3.925470861448613*^9}, {3.92547089693116*^9, 
   3.925471011613266*^9}, {3.925471090701519*^9, 3.925471156814423*^9}, {
   3.9254712038138723`*^9, 3.925471316626903*^9}, {3.925471443946589*^9, 
   3.925471511323885*^9}, 3.925471543304433*^9, {3.925471692363459*^9, 
   3.925471719080811*^9}, {3.92547175583163*^9, 3.9254718155501204`*^9}, {
   3.92547184710555*^9, 3.925471880194324*^9}, {3.925471910945205*^9, 
   3.92547191871286*^9}, {3.925471958525156*^9, 3.925472078139413*^9}, {
   3.925472117923146*^9, 3.925472137665878*^9}, {3.925472229181511*^9, 
   3.925472260615786*^9}, {3.9254723274239397`*^9, 3.925472406215194*^9}, {
   3.925472458932505*^9, 3.925472611181235*^9}, 3.925472657252408*^9, {
   3.925472738255528*^9, 3.925472791128469*^9}, {3.9254728244174433`*^9, 
   3.925472990985017*^9}, 3.925473127404223*^9, {3.925490487511595*^9, 
   3.925490621627142*^9}, {3.925496877253932*^9, 3.925496911300791*^9}, {
   3.925497058257701*^9, 3.925497173656856*^9}, {3.925497233296894*^9, 
   3.925497433480867*^9}, {3.925497469535129*^9, 3.925497647979775*^9}, {
   3.925518783224534*^9, 3.9255187939897423`*^9}, {3.925518837974482*^9, 
   3.925518843305045*^9}, {3.925518932202539*^9, 3.92551907751511*^9}, {
   3.925519136796869*^9, 3.925519137767964*^9}, 3.925519552537704*^9, {
   3.9256406687407928`*^9, 3.9256407106192303`*^9}, {3.925640835791711*^9, 
   3.925640926204642*^9}, {3.925640977445459*^9, 3.9256410842383957`*^9}, {
   3.9256411394721*^9, 3.9256411488082523`*^9}, {3.925641184733033*^9, 
   3.925641185278343*^9}, {3.925641250511858*^9, 3.925641277584804*^9}, 
   3.925641312924683*^9, {3.925641369737673*^9, 3.92564139281398*^9}, {
   3.925641424754411*^9, 3.925641509666863*^9}, {3.925641762125755*^9, 
   3.925641786932507*^9}, {3.925641828658832*^9, 3.925641854775062*^9}, {
   3.9256420447525473`*^9, 3.925642058529503*^9}, {3.925642212028014*^9, 
   3.925642231767747*^9}, {3.925642311266077*^9, 3.925642368693316*^9}, {
   3.925642556577857*^9, 3.92564257730676*^9}, {3.925642626843559*^9, 
   3.925642686846953*^9}, {3.925642796330684*^9, 3.925642798717202*^9}, {
   3.925642895053193*^9, 3.925642895836752*^9}, {3.925642943394953*^9, 
   3.925643000849737*^9}, {3.925643032200781*^9, 3.925643040489093*^9}, {
   3.925643154600471*^9, 3.925643174689171*^9}, {3.925643424754437*^9, 
   3.925643436065697*^9}, {3.925643717494294*^9, 3.92564376456769*^9}, {
   3.925643803839929*^9, 3.9256438112851763`*^9}, {3.925643887741283*^9, 
   3.9256438906164913`*^9}, {3.925644108268881*^9, 3.925644141898965*^9}, {
   3.925644174137979*^9, 3.9256442167896433`*^9}, {3.925644249589325*^9, 
   3.925644389926091*^9}, {3.925644429499857*^9, 3.925644446296219*^9}, {
   3.925644708397355*^9, 3.9256447101543913`*^9}, {3.925644999344623*^9, 
   3.925645142234886*^9}, {3.925645663949786*^9, 3.925645669720319*^9}, {
   3.925645783962129*^9, 3.925645784524869*^9}, {3.925645823707058*^9, 
   3.925645832270645*^9}, {3.925650409585557*^9, 3.925650417400633*^9}, {
   3.9259190250852737`*^9, 3.925919048580121*^9}, {3.925919843860767*^9, 
   3.925919844135592*^9}, {3.925920484859653*^9, 3.925920573971195*^9}, {
   3.925920608464291*^9, 3.925920666499436*^9}, {3.9259244993140483`*^9, 
   3.925924554660249*^9}, {3.925924638510784*^9, 3.925924700454774*^9}, {
   3.92592473351258*^9, 3.925924770926766*^9}, {3.925924803114419*^9, 
   3.925924810411546*^9}, {3.925940275435001*^9, 3.92594033035479*^9}, {
   3.925940374487308*^9, 3.9259403879712057`*^9}, {3.925940491465773*^9, 
   3.925940604410649*^9}, {3.925940678072773*^9, 3.925940741362468*^9}, {
   3.925940786373087*^9, 3.925940813007029*^9}, {3.925940959030951*^9, 
   3.925941003314311*^9}, {3.925941666825403*^9, 3.9259417128505096`*^9}, {
   3.925941760778157*^9, 3.925941791607195*^9}, {3.925941823578835*^9, 
   3.925941868761372*^9}, {3.925941934778737*^9, 3.925941942195022*^9}, {
   3.925941988474377*^9, 3.925942165022881*^9}, {3.925942207329323*^9, 
   3.925942316180415*^9}, {3.925942457304144*^9, 3.925942466165268*^9}, {
   3.925942505555979*^9, 3.9259425299817963`*^9}, {3.9259439987915993`*^9, 
   3.925944001087237*^9}, {3.925945350325037*^9, 3.925945350994561*^9}, {
   3.925945405583636*^9, 3.9259454127095*^9}, {3.925945450877384*^9, 
   3.925945451180237*^9}, {3.925945514003962*^9, 3.925945542628718*^9}, 
   3.925945575289652*^9, {3.925945614806068*^9, 3.9259456152023773`*^9}, {
   3.925945760757162*^9, 3.9259457981513844`*^9}, {3.92594605518559*^9, 
   3.925946215783018*^9}, {3.9259467813931913`*^9, 3.925946782924684*^9}, {
   3.925946828022904*^9, 3.925946843102127*^9}, {3.925947085240675*^9, 
   3.925947501624868*^9}, {3.925947548090802*^9, 3.925948145299657*^9}, {
   3.9260971266127453`*^9, 3.926097146495175*^9}, {3.926618661239552*^9, 
   3.926618684769106*^9}, {3.926618739459273*^9, 3.926618923586027*^9}, {
   3.926619044421625*^9, 3.9266190561005087`*^9}, {3.9266191549767933`*^9, 
   3.926619162888148*^9}, {3.926619236925301*^9, 3.92661923797571*^9}, {
   3.92662005236668*^9, 3.926620053949233*^9}, {3.9266201549817677`*^9, 
   3.926620158071278*^9}, {3.926620403961007*^9, 3.926620404974864*^9}, {
   3.9266204500411797`*^9, 3.926620603320011*^9}, {3.926620637974948*^9, 
   3.9266206672284193`*^9}, {3.926620758125596*^9, 3.926620844784169*^9}, {
   3.926620918680159*^9, 3.926620989261848*^9}, {3.9266210732426033`*^9, 
   3.926621151627458*^9}, {3.926622645860815*^9, 3.926622670109545*^9}, {
   3.926622727585648*^9, 3.92662282220388*^9}, {3.9266228744474897`*^9, 
   3.926622880417741*^9}, {3.9266250278904057`*^9, 3.926625052692921*^9}, {
   3.926625196526383*^9, 3.926625213697743*^9}, {3.9266253660421553`*^9, 
   3.926625405794985*^9}, {3.926625988734427*^9, 3.926626118191979*^9}, {
   3.926626159552002*^9, 3.926626399499148*^9}, {3.926626470353749*^9, 
   3.926626526678968*^9}, {3.926626565798501*^9, 3.926626755623301*^9}, {
   3.9266268593078957`*^9, 3.926626865283855*^9}, {3.926626906029542*^9, 
   3.926627120761113*^9}, {3.926627172297103*^9, 3.926627242111*^9}, {
   3.9266273143456373`*^9, 3.926627397630018*^9}, {3.926627431064539*^9, 
   3.926627777728271*^9}, {3.92662781471867*^9, 3.926627818045527*^9}, {
   3.926627926925622*^9, 3.926627947736575*^9}, {3.926627993754353*^9, 
   3.9266279972071457`*^9}, {3.9266280563536797`*^9, 3.92662816252536*^9}, {
   3.926628203243499*^9, 3.926628247058563*^9}, {3.926628294468389*^9, 
   3.926628301372465*^9}, {3.926628361166174*^9, 3.926628363125066*^9}, {
   3.926628413171448*^9, 3.92662841761786*^9}, {3.9266284724423018`*^9, 
   3.926628504839519*^9}, {3.926628607301285*^9, 3.926628806159783*^9}, {
   3.926628884730983*^9, 3.926628886818036*^9}, {3.926637252480709*^9, 
   3.92663727715349*^9}, {3.926637422003912*^9, 3.926637422190289*^9}, {
   3.926639945254268*^9, 3.926639956286813*^9}, {3.926639993099669*^9, 
   3.9266399948577*^9}, {3.926640089048705*^9, 3.926640090231439*^9}, {
   3.926640125131091*^9, 3.926640172381157*^9}, {3.926640276139696*^9, 
   3.926640283696463*^9}, {3.926640617621235*^9, 3.92664066410904*^9}, {
   3.9266407516052732`*^9, 3.926640917064811*^9}, {3.926640958164799*^9, 
   3.926640963068991*^9}, {3.926641043001585*^9, 3.9266410463843813`*^9}, {
   3.926641104496961*^9, 3.926641148834687*^9}, {3.926641193080079*^9, 
   3.9266412176122303`*^9}, {3.926641262186844*^9, 3.926641265353759*^9}, {
   3.926641320570208*^9, 3.926641325813965*^9}, 3.926642437934095*^9, {
   3.926642519901617*^9, 3.926642737853281*^9}, {3.9266428018176107`*^9, 
   3.926642807042605*^9}, {3.92664285750268*^9, 3.926642978599292*^9}, {
   3.926643011744535*^9, 3.926643052786866*^9}, {3.926643085922058*^9, 
   3.926643099548058*^9}, {3.926677494940881*^9, 3.9266775526927032`*^9}, 
   3.9266778403748627`*^9, {3.926677920034314*^9, 3.92667794606006*^9}, {
   3.926677976910888*^9, 3.9266780033016367`*^9}, 3.926678034350536*^9, {
   3.926678074881413*^9, 3.926678104169224*^9}, {3.926678158777864*^9, 
   3.926678161758038*^9}, {3.926678445099201*^9, 3.926678453383772*^9}, {
   3.926678501595512*^9, 3.926678511312772*^9}, {3.926678581766487*^9, 
   3.926678604164518*^9}, {3.926678641171679*^9, 3.9266786677674522`*^9}, 
   3.92667895353615*^9, {3.926679016290677*^9, 3.926679090942739*^9}, {
   3.926679135839398*^9, 3.926679305409171*^9}, {3.926679339522484*^9, 
   3.926679443370703*^9}, {3.926679566506235*^9, 3.926679655197221*^9}, {
   3.926679689173218*^9, 3.9266797685888166`*^9}, {3.92667983017798*^9, 
   3.926679843010433*^9}, 3.92668011091184*^9, 3.926680257730434*^9, {
   3.92668030177103*^9, 3.926680407985086*^9}, {3.926680453328801*^9, 
   3.926680503467994*^9}, {3.92668053963123*^9, 3.926680675164212*^9}, {
   3.92668106556907*^9, 3.9266811701231947`*^9}, {3.9266812046609*^9, 
   3.926681375388711*^9}, 3.926681411985491*^9, {3.926681446842987*^9, 
   3.926681451119415*^9}, {3.9266817661017*^9, 3.926682039176491*^9}, {
   3.92668208365723*^9, 3.926682141568017*^9}, {3.926682456867999*^9, 
   3.926682471878976*^9}, {3.926682508603834*^9, 3.92668251441337*^9}, {
   3.926682605732058*^9, 3.926682624451644*^9}, {3.926682774928075*^9, 
   3.926682829441577*^9}, {3.926682861058363*^9, 3.926682867886271*^9}, {
   3.926682916132958*^9, 3.926682936415158*^9}, {3.926683007380936*^9, 
   3.92668305414933*^9}, {3.926683384523347*^9, 3.92668352392207*^9}, {
   3.9266837344915667`*^9, 3.926684067618012*^9}, {3.926684190164133*^9, 
   3.926684191251293*^9}, {3.926684244479905*^9, 3.926684355559031*^9}, {
   3.926684390421715*^9, 3.926684405064234*^9}, {3.92668445374419*^9, 
   3.926684456124658*^9}, {3.926684534558231*^9, 3.926684592310801*^9}, {
   3.926684638737491*^9, 3.926684661341066*^9}, {3.926684695208951*^9, 
   3.926684848076465*^9}, {3.9266848994805307`*^9, 3.926684979506524*^9}, {
   3.926685011589582*^9, 3.926685024750055*^9}, {3.926685058151209*^9, 
   3.926685078566437*^9}, {3.9266852411291237`*^9, 3.9266853638428183`*^9}, {
   3.926697030313027*^9, 3.926697143736764*^9}, {3.926697205927791*^9, 
   3.926697235457863*^9}, {3.926697270419034*^9, 3.926697350489312*^9}, {
   3.926697399692216*^9, 3.92669740902578*^9}, {3.926697444468149*^9, 
   3.926697470341204*^9}, {3.926697510102458*^9, 3.9266975309986763`*^9}, {
   3.926697660081338*^9, 3.9266977836808777`*^9}, {3.926697817254685*^9, 
   3.926697823928283*^9}, {3.926697876317273*^9, 3.926697878644417*^9}, {
   3.9266981220844193`*^9, 3.926698131205424*^9}, {3.92669837628048*^9, 
   3.926698475491504*^9}, 3.926698529206216*^9, {3.926698593318774*^9, 
   3.926698595555357*^9}, {3.926702970357356*^9, 3.926702971451695*^9}, {
   3.926703020896246*^9, 3.926703056852838*^9}, {3.927159261454791*^9, 
   3.927159269276444*^9}, {3.9271596361577997`*^9, 3.927159656591415*^9}, {
   3.927159723068132*^9, 3.927159740644443*^9}, {3.927159792120784*^9, 
   3.927159816790938*^9}, {3.927159902227395*^9, 3.927159936351653*^9}, {
   3.927160067246153*^9, 3.927160205936183*^9}, {3.927160250625888*^9, 
   3.927160295931014*^9}, {3.927160365422079*^9, 3.927160396685096*^9}, {
   3.927160437157071*^9, 3.9271604686960406`*^9}, {3.927160510548294*^9, 
   3.927160576386003*^9}, {3.927160616315659*^9, 3.927160775781019*^9}, {
   3.927160911070426*^9, 3.927160940775629*^9}, 3.927164269733857*^9, {
   3.927164386730577*^9, 3.927164403567309*^9}, 3.927164445506919*^9, 
   3.927164493040428*^9, {3.9271646261330957`*^9, 3.927164710426641*^9}, {
   3.92716477320242*^9, 3.927164774540675*^9}, 3.927164822219185*^9, {
   3.927164919161426*^9, 3.927164989727371*^9}, {3.927165155422741*^9, 
   3.927165221977819*^9}, {3.92716531150848*^9, 3.927165335414904*^9}, {
   3.927165585962169*^9, 3.927165607882536*^9}, {3.927165655184515*^9, 
   3.927165658896492*^9}, {3.927165700764578*^9, 3.9271657097744226`*^9}, {
   3.927167093939491*^9, 3.927167095567349*^9}, {3.927167148595939*^9, 
   3.927167336454813*^9}, {3.927167376237451*^9, 3.92716737753694*^9}, {
   3.927167466357589*^9, 3.927167500803281*^9}, {3.927167644197748*^9, 
   3.927167705703717*^9}, 3.927167737711275*^9, {3.927187764947317*^9, 
   3.927187814146552*^9}, {3.927188410967307*^9, 3.927188459355567*^9}, 
   3.927249796632001*^9, {3.927249892424629*^9, 3.927249895366764*^9}, {
   3.927250350355296*^9, 3.927250367543517*^9}, {3.927250403554167*^9, 
   3.927250439454172*^9}, {3.92725072626142*^9, 3.9272507313917017`*^9}, {
   3.927250794710149*^9, 3.92725082822313*^9}, {3.927250895225114*^9, 
   3.92725091584934*^9}, {3.927250961338564*^9, 3.927251014728086*^9}, {
   3.927251049760665*^9, 3.927251058081777*^9}, {3.9272510941377487`*^9, 
   3.927251116790792*^9}, {3.927251231786856*^9, 3.927251264400777*^9}, {
   3.927251313551909*^9, 3.927251313781898*^9}, {3.927251407214114*^9, 
   3.9272514261251287`*^9}, {3.927253640873938*^9, 3.927253650850684*^9}, {
   3.927253705365641*^9, 3.927253781230363*^9}, {3.9272538369439*^9, 
   3.927253837524995*^9}, {3.927253984535984*^9, 3.927253986961845*^9}, {
   3.927337442381399*^9, 3.9273374431501*^9}, {3.927337493086511*^9, 
   3.927337627572579*^9}, {3.927337698758582*^9, 3.927337739605052*^9}, {
   3.927337833645364*^9, 3.927337841094141*^9}, {3.927337879737088*^9, 
   3.927337880701614*^9}, {3.927337935907854*^9, 3.927337964570752*^9}, {
   3.927338002787032*^9, 3.927338040445351*^9}, 3.927338075048592*^9, {
   3.927338818021122*^9, 3.927338956935814*^9}, {3.9273390003402042`*^9, 
   3.927339000582526*^9}, {3.927339615941594*^9, 3.927339711858244*^9}, {
   3.927339853018165*^9, 3.927339853341767*^9}, 3.9274568517138863`*^9, {
   3.927466936339467*^9, 3.927466942789423*^9}, {3.9274670701377497`*^9, 
   3.927467114893643*^9}, {3.927467358352126*^9, 3.9274674498799562`*^9}, {
   3.927467546135248*^9, 3.92746755003341*^9}, {3.927467635238927*^9, 
   3.927467639100675*^9}, 3.927700897018374*^9, {3.927701100142588*^9, 
   3.92770110034732*^9}, {3.928216128982723*^9, 3.928216129098212*^9}, {
   3.928216337356014*^9, 3.9282163391276093`*^9}, {3.92821760246837*^9, 
   3.928217715204542*^9}, {3.928217746345793*^9, 3.928217845962517*^9}, {
   3.928218955770005*^9, 3.928218961289006*^9}, {3.928219053840019*^9, 
   3.9282190553657312`*^9}, {3.9282190870767*^9, 3.928219157323605*^9}, {
   3.928219859967042*^9, 3.928219865168086*^9}, {3.928219908472279*^9, 
   3.928219915275625*^9}, {3.928219948549296*^9, 3.928219969605023*^9}, {
   3.928220017676469*^9, 3.928220021768836*^9}, {3.9282200747486153`*^9, 
   3.928220097689188*^9}, {3.928220128415308*^9, 3.928220157877393*^9}, 
   3.928220199026829*^9, {3.928220244249847*^9, 3.928220276264702*^9}, {
   3.928220642336429*^9, 3.928220649178397*^9}, {3.928220828039917*^9, 
   3.928220833821905*^9}, 3.928913732310934*^9, {3.928914110732763*^9, 
   3.928914119432996*^9}, {3.92891415926531*^9, 3.928914160587376*^9}, {
   3.928914192085792*^9, 3.928914194966801*^9}, {3.928914263886251*^9, 
   3.928914272483041*^9}, {3.928914385664253*^9, 3.928914386415983*^9}, {
   3.928914424040804*^9, 3.928914441067935*^9}, {3.928914530085784*^9, 
   3.92891485072805*^9}, {3.928914922737582*^9, 3.928915096834044*^9}, {
   3.928915136031841*^9, 3.928915136994087*^9}, {3.928915190769579*^9, 
   3.928915281648067*^9}, {3.928915366098811*^9, 3.9289154135577507`*^9}, {
   3.928915443884858*^9, 3.928915459802536*^9}, {3.928994355674395*^9, 
   3.928994394815767*^9}, 3.928994575708689*^9, {3.930145439119627*^9, 
   3.930145439745442*^9}, {3.931814729099843*^9, 3.9318147301514683`*^9}, 
   3.931828402225156*^9, {3.933267519035698*^9, 3.933267544573119*^9}, {
   3.933267961940856*^9, 3.933267964170967*^9}, {3.941306566362276*^9, 
   3.941306593232728*^9}, {3.9500951216856318`*^9, 3.950095123024413*^9}, {
   3.950148444254635*^9, 3.950148444612941*^9}, {3.9501487460327253`*^9, 
   3.9501487465179996`*^9}, {3.950669989233844*^9, 3.950669989633697*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6af17ee4-eb8b-4a2f-b8b4-cbcbb9583403"],

Cell[TextData[{
 "We now define the equations at their most abstract level, rescaling the \
functional derivative and its equation by a factor of ",
 Cell[BoxData[
  FormBox["\[CurlyEpsilon]", TraditionalForm]],ExpressionUUID->
  "7b210343-2cb2-4216-b58b-ae0ef981215f"],
 " so ensure everything starts at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "1", ")"}], TraditionalForm]],ExpressionUUID->
  "d466a563-99eb-4ac4-b32c-9c3cdc5a9662"],
 "."
}], "Text",
 CellChangeTimes->{{3.941306651404722*^9, 
  3.941306693307086*^9}},ExpressionUUID->"2e71ec46-df48-4fb8-860c-\
26902e395a2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"defining", " ", "the", " ", "equations"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<energy\>\"", "->", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"f", "[", "c", "]"}], "\[CurlyEpsilon]"], "+", 
         RowBox[{
          FractionBox["1", "2"], "\[CurlyEpsilon]", " ", 
          RowBox[{"norm", "[", 
           RowBox[{"grad", "[", "c", "]"}], "]"}]}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<flow\>\"", "->", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", " ", "\[Alpha]", " ", 
         RowBox[{"dt", "[", "c", "]"}]}], "-", 
        RowBox[{"lap", "[", "m", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<chem\>\"", "->", 
       RowBox[{"m", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "'"}], "[", "c", "]"}], "-", 
          RowBox[{
           SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
           RowBox[{"lap", "[", "c", "]"}]}]}], ")"}]}]}]}], "|>"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.925410686925483*^9, 3.9254107660507603`*^9}, {
   3.925410830387848*^9, 3.92541089017825*^9}, {3.925410928891109*^9, 
   3.925410980717381*^9}, {3.925411063527159*^9, 3.925411310957692*^9}, {
   3.925411439270929*^9, 3.925411489255529*^9}, {3.925411528545823*^9, 
   3.925411560905282*^9}, {3.925411603206799*^9, 3.925411679947967*^9}, {
   3.925411712171166*^9, 3.9254117849856586`*^9}, {3.925411820821084*^9, 
   3.925411965914876*^9}, {3.925412020805942*^9, 3.925412193962242*^9}, {
   3.925412226276422*^9, 3.925412346350092*^9}, {3.925412379987615*^9, 
   3.925412415176692*^9}, {3.925412468394409*^9, 3.925412531083593*^9}, {
   3.925412574775857*^9, 3.925412646440061*^9}, {3.9254126825785*^9, 
   3.925412851470252*^9}, {3.92541289283495*^9, 3.925412965820825*^9}, {
   3.92541341097471*^9, 3.925413576240059*^9}, {3.925413610945981*^9, 
   3.925413722244555*^9}, {3.925413774573417*^9, 3.925413777120391*^9}, {
   3.925413834372891*^9, 3.9254138356746273`*^9}, {3.925413882990925*^9, 
   3.925414091078267*^9}, {3.92541412661858*^9, 3.925414309573999*^9}, {
   3.92541434615676*^9, 3.925414364311376*^9}, {3.92541453063266*^9, 
   3.9254145546585407`*^9}, {3.925414593356914*^9, 3.9254146605777*^9}, {
   3.925414710591429*^9, 3.925414768974921*^9}, {3.925414804162609*^9, 
   3.925414823974945*^9}, {3.925414867068237*^9, 3.925414905228904*^9}, {
   3.925414936993082*^9, 3.925415107049269*^9}, {3.9254151432451463`*^9, 
   3.925415213722327*^9}, {3.925415245710903*^9, 3.9254153985629*^9}, {
   3.925415487219271*^9, 3.925415512213025*^9}, {3.925415562169866*^9, 
   3.9254155918739347`*^9}, {3.925415700529805*^9, 3.9254157735914583`*^9}, {
   3.925415873175067*^9, 3.925415873331398*^9}, {3.925416011413009*^9, 
   3.925416173668475*^9}, {3.925416211931176*^9, 3.925416489236919*^9}, {
   3.925416532983465*^9, 3.925416533669909*^9}, {3.925416598658949*^9, 
   3.925416914141212*^9}, {3.925416944913143*^9, 3.92541706556323*^9}, {
   3.9254171058965054`*^9, 3.925417118786487*^9}, {3.925417149516284*^9, 
   3.92541718902902*^9}, {3.925417258027317*^9, 3.925417358742579*^9}, {
   3.925417407507038*^9, 3.925417411791795*^9}, {3.925417449008486*^9, 
   3.925417551991803*^9}, {3.92541758520912*^9, 3.925417585635527*^9}, {
   3.925417741720288*^9, 3.925417753993677*^9}, {3.925417821282898*^9, 
   3.925417881143179*^9}, {3.925417937391917*^9, 3.925417955259959*^9}, {
   3.925430411278133*^9, 3.925430416478302*^9}, {3.925430497175742*^9, 
   3.925430513667574*^9}, 3.925430579635147*^9, {3.925430710807773*^9, 
   3.9254307127607822`*^9}, {3.925430818810457*^9, 3.925430864896277*^9}, {
   3.925463644874638*^9, 3.925463704270145*^9}, {3.925463764042646*^9, 
   3.925463800376926*^9}, {3.9254639765867033`*^9, 3.9254640089047213`*^9}, {
   3.925464046201472*^9, 3.925464074216558*^9}, {3.925470105442244*^9, 
   3.925470215381029*^9}, {3.925470328810892*^9, 3.925470388735385*^9}, 
   3.925470429582185*^9, {3.925470465716573*^9, 3.925470604639782*^9}, {
   3.925470652142866*^9, 3.925470861448613*^9}, {3.92547089693116*^9, 
   3.925471011613266*^9}, {3.925471090701519*^9, 3.925471156814423*^9}, {
   3.9254712038138723`*^9, 3.925471316626903*^9}, {3.925471443946589*^9, 
   3.925471511323885*^9}, 3.925471543304433*^9, {3.925471692363459*^9, 
   3.925471719080811*^9}, {3.92547175583163*^9, 3.9254718155501204`*^9}, {
   3.92547184710555*^9, 3.925471880194324*^9}, {3.925471910945205*^9, 
   3.92547191871286*^9}, {3.925471958525156*^9, 3.925472078139413*^9}, {
   3.925472117923146*^9, 3.925472137665878*^9}, {3.925472229181511*^9, 
   3.925472260615786*^9}, {3.9254723274239397`*^9, 3.925472406215194*^9}, {
   3.925472458932505*^9, 3.925472611181235*^9}, 3.925472657252408*^9, {
   3.925472738255528*^9, 3.925472791128469*^9}, {3.9254728244174433`*^9, 
   3.925472990985017*^9}, 3.925473127404223*^9, {3.925490487511595*^9, 
   3.925490621627142*^9}, {3.925496877253932*^9, 3.925496911300791*^9}, {
   3.925497058257701*^9, 3.925497173656856*^9}, {3.925497233296894*^9, 
   3.925497433480867*^9}, {3.925497469535129*^9, 3.925497647979775*^9}, {
   3.925518783224534*^9, 3.9255187939897423`*^9}, {3.925518837974482*^9, 
   3.925518843305045*^9}, {3.925518932202539*^9, 3.92551907751511*^9}, {
   3.925519136796869*^9, 3.925519137767964*^9}, 3.925519552537704*^9, {
   3.9256406687407928`*^9, 3.9256407106192303`*^9}, {3.925640835791711*^9, 
   3.925640926204642*^9}, {3.925640977445459*^9, 3.9256410842383957`*^9}, {
   3.9256411394721*^9, 3.9256411488082523`*^9}, {3.925641184733033*^9, 
   3.925641185278343*^9}, {3.925641250511858*^9, 3.925641277584804*^9}, 
   3.925641312924683*^9, {3.925641369737673*^9, 3.92564139281398*^9}, {
   3.925641424754411*^9, 3.925641509666863*^9}, {3.925641762125755*^9, 
   3.925641786932507*^9}, {3.925641828658832*^9, 3.925641854775062*^9}, {
   3.9256420447525473`*^9, 3.925642058529503*^9}, {3.925642212028014*^9, 
   3.925642231767747*^9}, {3.925642311266077*^9, 3.925642368693316*^9}, {
   3.925642556577857*^9, 3.92564257730676*^9}, {3.925642626843559*^9, 
   3.925642686846953*^9}, {3.925642796330684*^9, 3.925642798717202*^9}, {
   3.925642895053193*^9, 3.925642895836752*^9}, {3.925642943394953*^9, 
   3.925643000849737*^9}, {3.925643032200781*^9, 3.925643040489093*^9}, {
   3.925643154600471*^9, 3.925643174689171*^9}, {3.925643424754437*^9, 
   3.925643436065697*^9}, {3.925643717494294*^9, 3.92564376456769*^9}, {
   3.925643803839929*^9, 3.9256438112851763`*^9}, {3.925643887741283*^9, 
   3.9256438906164913`*^9}, {3.925644108268881*^9, 3.925644141898965*^9}, {
   3.925644174137979*^9, 3.9256442167896433`*^9}, {3.925644249589325*^9, 
   3.925644389926091*^9}, {3.925644429499857*^9, 3.925644446296219*^9}, {
   3.925644708397355*^9, 3.9256447101543913`*^9}, {3.925644999344623*^9, 
   3.925645142234886*^9}, {3.925645663949786*^9, 3.925645669720319*^9}, {
   3.925645783962129*^9, 3.925645784524869*^9}, {3.925645823707058*^9, 
   3.925645832270645*^9}, {3.925650409585557*^9, 3.925650417400633*^9}, {
   3.9259190250852737`*^9, 3.925919048580121*^9}, {3.925919843860767*^9, 
   3.925919844135592*^9}, {3.925920484859653*^9, 3.925920573971195*^9}, {
   3.925920608464291*^9, 3.925920666499436*^9}, {3.9259244993140483`*^9, 
   3.925924554660249*^9}, {3.925924638510784*^9, 3.925924700454774*^9}, {
   3.92592473351258*^9, 3.925924770926766*^9}, {3.925924803114419*^9, 
   3.925924810411546*^9}, {3.925940275435001*^9, 3.92594033035479*^9}, {
   3.925940374487308*^9, 3.9259403879712057`*^9}, {3.925940491465773*^9, 
   3.925940604410649*^9}, {3.925940678072773*^9, 3.925940741362468*^9}, {
   3.925940786373087*^9, 3.925940813007029*^9}, {3.925940959030951*^9, 
   3.925941003314311*^9}, {3.925941666825403*^9, 3.9259417128505096`*^9}, {
   3.925941760778157*^9, 3.925941791607195*^9}, {3.925941823578835*^9, 
   3.925941868761372*^9}, {3.925941934778737*^9, 3.925941942195022*^9}, {
   3.925941988474377*^9, 3.925942165022881*^9}, {3.925942207329323*^9, 
   3.925942316180415*^9}, {3.925942457304144*^9, 3.925942466165268*^9}, {
   3.925942505555979*^9, 3.9259425299817963`*^9}, {3.9259439987915993`*^9, 
   3.925944001087237*^9}, {3.925945350325037*^9, 3.925945350994561*^9}, {
   3.925945405583636*^9, 3.9259454127095*^9}, {3.925945450877384*^9, 
   3.925945451180237*^9}, {3.925945514003962*^9, 3.925945542628718*^9}, 
   3.925945575289652*^9, {3.925945614806068*^9, 3.9259456152023773`*^9}, {
   3.925945760757162*^9, 3.9259457981513844`*^9}, {3.92594605518559*^9, 
   3.925946215783018*^9}, {3.9259467813931913`*^9, 3.925946782924684*^9}, {
   3.925946828022904*^9, 3.925946843102127*^9}, {3.925947085240675*^9, 
   3.925947501624868*^9}, {3.925947548090802*^9, 3.925948145299657*^9}, {
   3.9260971266127453`*^9, 3.926097146495175*^9}, {3.926618661239552*^9, 
   3.926618684769106*^9}, {3.926618739459273*^9, 3.926618923586027*^9}, {
   3.926619044421625*^9, 3.9266190561005087`*^9}, {3.9266191549767933`*^9, 
   3.926619162888148*^9}, {3.926619236925301*^9, 3.92661923797571*^9}, {
   3.92662005236668*^9, 3.926620053949233*^9}, {3.9266201549817677`*^9, 
   3.926620158071278*^9}, {3.926620403961007*^9, 3.926620404974864*^9}, {
   3.9266204500411797`*^9, 3.926620603320011*^9}, {3.926620637974948*^9, 
   3.9266206672284193`*^9}, {3.926620758125596*^9, 3.926620844784169*^9}, {
   3.926620918680159*^9, 3.926620989261848*^9}, {3.9266210732426033`*^9, 
   3.926621151627458*^9}, {3.926622645860815*^9, 3.926622670109545*^9}, {
   3.926622727585648*^9, 3.92662282220388*^9}, {3.9266228744474897`*^9, 
   3.926622880417741*^9}, {3.9266250278904057`*^9, 3.926625052692921*^9}, {
   3.926625196526383*^9, 3.926625213697743*^9}, {3.9266253660421553`*^9, 
   3.926625405794985*^9}, {3.926625988734427*^9, 3.926626118191979*^9}, {
   3.926626159552002*^9, 3.926626399499148*^9}, {3.926626470353749*^9, 
   3.926626526678968*^9}, {3.926626565798501*^9, 3.926626755623301*^9}, {
   3.9266268593078957`*^9, 3.926626865283855*^9}, {3.926626906029542*^9, 
   3.926627120761113*^9}, {3.926627172297103*^9, 3.926627242111*^9}, {
   3.9266273143456373`*^9, 3.926627397630018*^9}, {3.926627431064539*^9, 
   3.926627777728271*^9}, {3.92662781471867*^9, 3.926627818045527*^9}, {
   3.926627926925622*^9, 3.926627947736575*^9}, {3.926627993754353*^9, 
   3.9266279972071457`*^9}, {3.9266280563536797`*^9, 3.92662816252536*^9}, {
   3.926628203243499*^9, 3.926628247058563*^9}, {3.926628294468389*^9, 
   3.926628301372465*^9}, {3.926628361166174*^9, 3.926628363125066*^9}, {
   3.926628413171448*^9, 3.92662841761786*^9}, {3.9266284724423018`*^9, 
   3.926628504839519*^9}, {3.926628607301285*^9, 3.926628806159783*^9}, {
   3.926628884730983*^9, 3.926628886818036*^9}, {3.926637252480709*^9, 
   3.92663727715349*^9}, {3.926637422003912*^9, 3.926637422190289*^9}, {
   3.926639945254268*^9, 3.926639956286813*^9}, {3.926639993099669*^9, 
   3.9266399948577*^9}, {3.926640089048705*^9, 3.926640090231439*^9}, {
   3.926640125131091*^9, 3.926640172381157*^9}, {3.926640276139696*^9, 
   3.926640283696463*^9}, {3.926640617621235*^9, 3.92664066410904*^9}, {
   3.9266407516052732`*^9, 3.926640917064811*^9}, {3.926640958164799*^9, 
   3.926640963068991*^9}, {3.926641043001585*^9, 3.9266410463843813`*^9}, {
   3.926641104496961*^9, 3.926641148834687*^9}, {3.926641193080079*^9, 
   3.9266412176122303`*^9}, {3.926641262186844*^9, 3.926641265353759*^9}, {
   3.926641320570208*^9, 3.926641325813965*^9}, 3.926642437934095*^9, {
   3.926642519901617*^9, 3.926642737853281*^9}, {3.9266428018176107`*^9, 
   3.926642807042605*^9}, {3.92664285750268*^9, 3.926642978599292*^9}, {
   3.926643011744535*^9, 3.926643052786866*^9}, {3.926643085922058*^9, 
   3.926643099548058*^9}, {3.926677494940881*^9, 3.9266775526927032`*^9}, 
   3.9266778403748627`*^9, {3.926677920034314*^9, 3.92667794606006*^9}, {
   3.926677976910888*^9, 3.9266780033016367`*^9}, 3.926678034350536*^9, {
   3.926678074881413*^9, 3.926678104169224*^9}, {3.926678158777864*^9, 
   3.926678161758038*^9}, {3.926678445099201*^9, 3.926678453383772*^9}, {
   3.926678501595512*^9, 3.926678511312772*^9}, {3.926678581766487*^9, 
   3.926678604164518*^9}, {3.926678641171679*^9, 3.9266786677674522`*^9}, 
   3.92667895353615*^9, {3.926679016290677*^9, 3.926679090942739*^9}, {
   3.926679135839398*^9, 3.926679305409171*^9}, {3.926679339522484*^9, 
   3.926679443370703*^9}, {3.926679566506235*^9, 3.926679655197221*^9}, {
   3.926679689173218*^9, 3.9266797685888166`*^9}, {3.92667983017798*^9, 
   3.926679843010433*^9}, 3.92668011091184*^9, 3.926680257730434*^9, {
   3.92668030177103*^9, 3.926680407985086*^9}, {3.926680453328801*^9, 
   3.926680503467994*^9}, {3.92668053963123*^9, 3.926680675164212*^9}, {
   3.92668106556907*^9, 3.9266811701231947`*^9}, {3.9266812046609*^9, 
   3.926681375388711*^9}, 3.926681411985491*^9, {3.926681446842987*^9, 
   3.926681451119415*^9}, {3.9266817661017*^9, 3.926682039176491*^9}, {
   3.92668208365723*^9, 3.926682141568017*^9}, {3.926682456867999*^9, 
   3.926682471878976*^9}, {3.926682508603834*^9, 3.92668251441337*^9}, {
   3.926682605732058*^9, 3.926682624451644*^9}, {3.926682774928075*^9, 
   3.926682829441577*^9}, {3.926682861058363*^9, 3.926682867886271*^9}, {
   3.926682916132958*^9, 3.926682936415158*^9}, {3.926683007380936*^9, 
   3.92668305414933*^9}, {3.926683384523347*^9, 3.92668352392207*^9}, {
   3.9266837344915667`*^9, 3.926684067618012*^9}, {3.926684190164133*^9, 
   3.926684191251293*^9}, {3.926684244479905*^9, 3.926684355559031*^9}, {
   3.926684390421715*^9, 3.926684405064234*^9}, {3.92668445374419*^9, 
   3.926684456124658*^9}, {3.926684534558231*^9, 3.926684592310801*^9}, {
   3.926684638737491*^9, 3.926684661341066*^9}, {3.926684695208951*^9, 
   3.926684848076465*^9}, {3.9266848994805307`*^9, 3.926684979506524*^9}, {
   3.926685011589582*^9, 3.926685024750055*^9}, {3.926685058151209*^9, 
   3.926685078566437*^9}, {3.9266852411291237`*^9, 3.9266853638428183`*^9}, {
   3.926697030313027*^9, 3.926697143736764*^9}, {3.926697205927791*^9, 
   3.926697235457863*^9}, {3.926697270419034*^9, 3.926697350489312*^9}, {
   3.926697399692216*^9, 3.92669740902578*^9}, {3.926697444468149*^9, 
   3.926697470341204*^9}, {3.926697510102458*^9, 3.9266975309986763`*^9}, {
   3.926697660081338*^9, 3.9266977836808777`*^9}, {3.926697817254685*^9, 
   3.926697823928283*^9}, {3.926697876317273*^9, 3.926697878644417*^9}, {
   3.9266981220844193`*^9, 3.926698131205424*^9}, {3.92669837628048*^9, 
   3.926698475491504*^9}, 3.926698529206216*^9, {3.926698593318774*^9, 
   3.926698595555357*^9}, {3.926702970357356*^9, 3.926702971451695*^9}, {
   3.926703020896246*^9, 3.926703056852838*^9}, {3.927159261454791*^9, 
   3.927159269276444*^9}, {3.9271596361577997`*^9, 3.927159656591415*^9}, {
   3.927159723068132*^9, 3.927159740644443*^9}, {3.927159792120784*^9, 
   3.927159816790938*^9}, {3.927159902227395*^9, 3.927159936351653*^9}, {
   3.927160067246153*^9, 3.927160205936183*^9}, {3.927160250625888*^9, 
   3.927160295931014*^9}, {3.927160365422079*^9, 3.927160396685096*^9}, {
   3.927160437157071*^9, 3.9271604686960406`*^9}, {3.927160510548294*^9, 
   3.927160576386003*^9}, {3.927160616315659*^9, 3.927160775781019*^9}, {
   3.927160911070426*^9, 3.927160940775629*^9}, 3.927164269733857*^9, {
   3.927164386730577*^9, 3.927164403567309*^9}, 3.927164445506919*^9, 
   3.927164493040428*^9, {3.9271646261330957`*^9, 3.927164710426641*^9}, {
   3.92716477320242*^9, 3.927164774540675*^9}, 3.927164822219185*^9, {
   3.927164919161426*^9, 3.927164989727371*^9}, {3.927165155422741*^9, 
   3.927165221977819*^9}, {3.92716531150848*^9, 3.927165335414904*^9}, {
   3.927165585962169*^9, 3.927165607882536*^9}, {3.927165655184515*^9, 
   3.927165658896492*^9}, {3.927165700764578*^9, 3.9271657097744226`*^9}, {
   3.927167093939491*^9, 3.927167095567349*^9}, {3.927167148595939*^9, 
   3.927167336454813*^9}, {3.927167376237451*^9, 3.92716737753694*^9}, {
   3.927167466357589*^9, 3.927167500803281*^9}, {3.927167644197748*^9, 
   3.927167705703717*^9}, 3.927167737711275*^9, {3.927187764947317*^9, 
   3.927187814146552*^9}, {3.927188410967307*^9, 3.927188459355567*^9}, 
   3.927249796632001*^9, {3.927249892424629*^9, 3.927249895366764*^9}, {
   3.927250350355296*^9, 3.927250367543517*^9}, {3.927250403554167*^9, 
   3.927250439454172*^9}, {3.92725072626142*^9, 3.9272507313917017`*^9}, {
   3.927250794710149*^9, 3.92725082822313*^9}, {3.927250895225114*^9, 
   3.92725091584934*^9}, {3.927250961338564*^9, 3.927251014728086*^9}, {
   3.927251049760665*^9, 3.927251058081777*^9}, {3.9272510941377487`*^9, 
   3.927251116790792*^9}, {3.927251231786856*^9, 3.927251264400777*^9}, {
   3.927251313551909*^9, 3.927251313781898*^9}, {3.927251407214114*^9, 
   3.9272514261251287`*^9}, {3.927253640873938*^9, 3.927253650850684*^9}, {
   3.927253705365641*^9, 3.927253781230363*^9}, {3.9272538369439*^9, 
   3.927253837524995*^9}, {3.927253984535984*^9, 3.927253986961845*^9}, {
   3.927337442381399*^9, 3.9273374431501*^9}, {3.927337493086511*^9, 
   3.927337627572579*^9}, {3.927337698758582*^9, 3.927337739605052*^9}, {
   3.927337833645364*^9, 3.927337841094141*^9}, {3.927337879737088*^9, 
   3.927337880701614*^9}, {3.927337935907854*^9, 3.927337964570752*^9}, {
   3.927338002787032*^9, 3.927338040445351*^9}, 3.927338075048592*^9, {
   3.927338818021122*^9, 3.927338956935814*^9}, {3.9273390003402042`*^9, 
   3.927339000582526*^9}, {3.927339615941594*^9, 3.927339711858244*^9}, {
   3.927339853018165*^9, 3.927339853341767*^9}, 3.9274568517138863`*^9, {
   3.927466936339467*^9, 3.927466942789423*^9}, {3.9274670701377497`*^9, 
   3.927467114893643*^9}, {3.927467358352126*^9, 3.9274674498799562`*^9}, {
   3.927467546135248*^9, 3.92746755003341*^9}, {3.927467635238927*^9, 
   3.927467639100675*^9}, 3.927700897018374*^9, {3.927701100142588*^9, 
   3.92770110034732*^9}, {3.928216128982723*^9, 3.928216129098212*^9}, {
   3.928216337356014*^9, 3.9282163391276093`*^9}, {3.92821760246837*^9, 
   3.928217715204542*^9}, {3.928217746345793*^9, 3.928217845962517*^9}, {
   3.928218955770005*^9, 3.928218961289006*^9}, {3.928219053840019*^9, 
   3.9282190553657312`*^9}, {3.9282190870767*^9, 3.928219157323605*^9}, {
   3.928219859967042*^9, 3.928219865168086*^9}, {3.928219908472279*^9, 
   3.928219915275625*^9}, {3.928219948549296*^9, 3.928219969605023*^9}, {
   3.928220017676469*^9, 3.928220021768836*^9}, {3.9282200747486153`*^9, 
   3.928220097689188*^9}, {3.928220128415308*^9, 3.928220157877393*^9}, 
   3.928220199026829*^9, {3.928220244249847*^9, 3.928220276264702*^9}, {
   3.928220642336429*^9, 3.928220649178397*^9}, {3.928220828039917*^9, 
   3.928220833821905*^9}, 3.928913732310934*^9, {3.928914110732763*^9, 
   3.928914119432996*^9}, {3.92891415926531*^9, 3.928914160587376*^9}, {
   3.928914192085792*^9, 3.928914194966801*^9}, {3.928914263886251*^9, 
   3.928914272483041*^9}, {3.928914385664253*^9, 3.928914386415983*^9}, {
   3.928914424040804*^9, 3.928914441067935*^9}, {3.928914530085784*^9, 
   3.92891485072805*^9}, {3.928914922737582*^9, 3.928915096834044*^9}, {
   3.928915136031841*^9, 3.928915136994087*^9}, {3.928915190769579*^9, 
   3.928915281648067*^9}, {3.928915366098811*^9, 3.9289154135577507`*^9}, {
   3.928915443884858*^9, 3.928915459802536*^9}, {3.928994355674395*^9, 
   3.928994394815767*^9}, {3.928994575708689*^9, 3.928994579011952*^9}, {
   3.929084822915059*^9, 3.929084826604391*^9}, {3.931395961841812*^9, 
   3.93139597620878*^9}, {3.931396053545888*^9, 3.931396060263893*^9}, {
   3.931396409345767*^9, 3.931396431265647*^9}, {3.933267555314159*^9, 
   3.933267658882918*^9}, {3.933267941745458*^9, 3.933267981024144*^9}, {
   3.933268016864097*^9, 3.933268035853898*^9}, {3.934976449335038*^9, 
   3.934976451397008*^9}, {3.935475082580221*^9, 3.935475085609577*^9}, {
   3.935475167223491*^9, 3.935475170763995*^9}, {3.935475420453244*^9, 
   3.935475442504323*^9}, {3.940915478117817*^9, 3.940915496842934*^9}, {
   3.9409176302936277`*^9, 3.940917727278156*^9}, {3.940918420253887*^9, 
   3.940918430568033*^9}, {3.941252194913098*^9, 3.941252242116357*^9}, {
   3.941252334912389*^9, 3.941252335247078*^9}, {3.941255713788656*^9, 
   3.941255727024184*^9}, {3.941273011456546*^9, 3.94127301418226*^9}, {
   3.942597654664213*^9, 3.942597656197475*^9}, {3.948794184284853*^9, 
   3.948794198384913*^9}, {3.950072909586636*^9, 3.9500729349181128`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"8232a3dc-997a-4404-852c-0c1da016ef94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Signed Distance Calculus", "Chapter",
 CellChangeTimes->{{3.928999510492601*^9, 
  3.928999515885682*^9}},ExpressionUUID->"211e14ed-9724-47b0-b70f-\
9abc63754d1c"],

Cell[TextData[{
 "While the logic of standard coordinate systems is implemented in the vector \
calculus functionality of Mathematica, it does not easily support tensor \
calculus for general coordinate systems. We must implement this by hand for \
the signed distance coordinate system in the vicinity of a co-dimension 1 \
boundary (in our case a curve). See Hester and Vasil 2023 for a full \
derivation in the three dimensional case.\n\nIn short, we implement vector \
calculus operators for the signed distance coordinate system in two \
dimensions. We do this using the orthonormal vector frame provided by the \
tangent vector ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["t", "^"], TraditionalForm]],ExpressionUUID->
  "95796bd2-bf55-4ad6-a0c3-8f3924d5c59e"],
 " and normal vector ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["n", "^"], TraditionalForm]],ExpressionUUID->
  "96f91ce7-6705-4085-8fa5-5978883e89fe"],
 " of the curve. This simplifies the calculation of connection coefficients. \
There is no need to implement a raising or lowering operator for \
contra/covariant transformations (or more general transforms associated with \
the use of multiple possible vector frames).\n\nThe full logic of arbitrary \
order tensor calculus is captured by writing the gradient operator in terms \
of normal ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "r"], TraditionalForm]],ExpressionUUID->
  "2a0a2caf-f059-4939-a458-296c70a1718a"],
 " and arclength tangent ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "s"], TraditionalForm]],ExpressionUUID->
  "1b5604d1-0d3f-4ea8-ad4c-a0789a405faf"],
 " derivatives, which are in turn defined by curvature ",
 Cell[BoxData[
  FormBox["\[Kappa]", TraditionalForm]],ExpressionUUID->
  "30303d3f-0579-4cd7-aa47-6362980b09c7"],
 " dependent scaling factors ",
 Cell[BoxData[
  FormBox[
   RowBox[{"h", ",", " ", "\[Gamma]"}], TraditionalForm]],ExpressionUUID->
  "67d11cbc-f5cf-4952-a0e7-a652df395032"],
 ":"
}], "Text",
 CellChangeTimes->{{3.941306788514029*^9, 3.941307187057575*^9}, {
  3.941307346313363*^9, 
  3.941307368787101*^9}},ExpressionUUID->"86a157dc-9b80-477a-ab04-\
dec6feb2dc4b"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "=", 
     OverscriptBox["n", "^"]}], "\[TensorProduct]", 
    RowBox[{
     SubscriptBox["\[PartialD]", "r"], 
     RowBox[{"+", 
      RowBox[{
       FractionBox[
        OverscriptBox["t", "^"], 
        RowBox[{
         RowBox[{"h", "(", 
          RowBox[{"t", ",", "s"}], ")"}], 
         RowBox[{"\[Gamma]", "(", 
          RowBox[{"t", ",", "s", ",", "r"}], ")"}]}]], "\[TensorProduct]", 
       SubscriptBox["\[PartialD]", "s"]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"c2435a59-f8d2-4fdf-9409-717ce0a191b2"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"h", "(", 
     RowBox[{"t", ",", "s"}], ")"}], "=", 
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["\[PartialD]", "s"], 
      RowBox[{"x", "(", 
       RowBox[{"t", ",", "s"}], ")"}]}], "\[RightBracketingBar]"}]}], 
   TraditionalForm]],ExpressionUUID->"3d295d1a-facf-4820-abf4-0e0e8b61d2fb"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Gamma]", "(", 
     RowBox[{"t", ",", "s", ",", "r"}], ")"}], "=", 
    RowBox[{"1", "-", 
     RowBox[{"r", " ", 
      RowBox[{"\[Kappa]", "(", 
       RowBox[{"t", ",", "s"}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "bc444ab7-1301-4a6b-81ac-745a28f400b3"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Kappa]", "(", 
     RowBox[{"t", ",", "s"}], ")"}], "=", 
    RowBox[{
     FractionBox["1", "h"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[PartialD]", "s"], 
        OverscriptBox["t", "^"]}], ")"}], "\[CenterDot]", 
      OverscriptBox["n", "^"]}]}]}], TraditionalForm]],ExpressionUUID->
  "54710c16-52ac-4629-8c4f-43871d69a9ba"]
}], "Text",
 CellChangeTimes->{{3.941307190525002*^9, 3.94130734069272*^9}, {
  3.941655061449926*^9, 3.941655063376071*^9}, {3.9425979540001307`*^9, 
  3.9425979594814034`*^9}, {3.9425979895012007`*^9, 
  3.9425979951759243`*^9}},ExpressionUUID->"a105e703-c9b2-467f-a4e0-\
aabc6b893a8e"],

Cell["\<\
We then need the gradient of the basis vectors in terms of corresponding \
2-tensors (we note that technically the gradient of the frame does not \
transform as a tensor under coordinate transformation. They are in the jet \
space, but they aren\[CloseCurlyQuote]t tensors. We\[CloseCurlyQuote]ll think \
of them as one, though).\
\>", "Text",
 CellChangeTimes->{{3.941306788514029*^9, 3.941307186605864*^9}, {
  3.9413073717796803`*^9, 3.9413073776749783`*^9}, {3.9413074215919313`*^9, 
  3.941307427085698*^9}},ExpressionUUID->"571b9aaa-f6f2-4e90-b2c5-\
bfa41e616bf0"],

Cell[TextData[Cell[BoxData[{
 FormBox[
  RowBox[{
   RowBox[{"\[Del]", 
    OverscriptBox["n", "^"]}], "=", 
   RowBox[{
    RowBox[{"-", "\[Kappa]"}], " ", 
    RowBox[{
     OverscriptBox["t", "^"], "\[TensorProduct]", 
     OverscriptBox["t", "^"]}]}]}], TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   RowBox[{"\[Del]", 
    OverscriptBox["t", "^"]}], "=", 
   RowBox[{"\[Kappa]", " ", 
    RowBox[{
     OverscriptBox["t", "^"], "\[TensorProduct]", 
     OverscriptBox["n", "^"]}]}]}], TraditionalForm]}],
 FormatType->
  TraditionalForm,ExpressionUUID->"f887e4ee-905b-4edb-ad3b-f8cf1cdaeabf"]], \
"Text",
 CellChangeTimes->{{3.941307383895541*^9, 
  3.9413074676990967`*^9}},ExpressionUUID->"1e04977c-8571-435d-9fed-\
33a3620978d6"],

Cell[TextData[{
 "Next we need to know the time derivative operator transformation in terms \
of the interface velocity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{
      SubscriptBox["|", 
       RowBox[{"s", ",", "r"}]], "p"}]}], "=", 
    RowBox[{"v", "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["v", "n"], 
       OverscriptBox["n", "^"]}], "+", 
      RowBox[{
       SubscriptBox["v", "t"], 
       OverscriptBox["t", "^"]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "46368e6d-b804-4537-a524-b613171b90e0"],
 ","
}], "Text",
 CellChangeTimes->{{3.9413074730582933`*^9, 3.941307492091805*^9}, {
  3.941307574987804*^9, 
  3.941307643662628*^9}},ExpressionUUID->"8c74dcda-1e4e-43e5-a068-\
0a4a883974df"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     SubscriptBox["|", 
      RowBox[{"x", ",", "y"}]]}], "->", 
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{
      SubscriptBox["|", 
       RowBox[{"s", ",", "r"}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "h"]}], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["v", "t"], "-", 
         FractionBox[
          RowBox[{"r", 
           RowBox[{
            SubscriptBox["\[Del]", "s"], 
            SubscriptBox["v", "n"]}]}], "\[Gamma]"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Del]", "s"], 
        RowBox[{"-", 
         SubscriptBox["v", "n"]}]}], 
       SubscriptBox["\[PartialD]", "r"]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "25fd628f-0ade-4aa9-ae8c-bfd14291d79b"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     OverscriptBox["n", "^"]}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Del]", "s"], 
        SubscriptBox["v", "n"]}], "\[Gamma]"]}], 
     OverscriptBox["t", "^"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6a8e5adf-543d-4148-a014-d80ce19b4e89"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     OverscriptBox["t", "^"]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["\[Del]", "s"], 
       SubscriptBox["v", "n"]}], "\[Gamma]"], 
     OverscriptBox["n", "^"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c3bfcad0-a188-40ff-930c-014aaa0fdb01"]
}], "Text",
 CellChangeTimes->{
  3.941307494890922*^9, {3.9413075252427177`*^9, 3.941307572403591*^9}, {
   3.941307651437098*^9, 3.941307716398789*^9}, {3.94130870142027*^9, 
   3.9413087695175543`*^9}},ExpressionUUID->"2b777d49-127e-4b6a-8e17-\
a2ca8260dc09"],

Cell["\<\
To create the Mathematica code for this, we implement:
1. Partial derivative operators in the time, tangent, and normal directions
2. A Jacobian 2-tensor to multiply the partial derivatives by corresponding \
scale factors
3. A connection coefficient 3-tensor to store all components of all partial \
derivatives of all basis vectors in each direction.
4. A spacetime gradient function to combine the operations into one, \
recursively contracting the connection coefficients over required dimensions
5. Space and time projection operators to extract just the time and spatial \
gradients.

As part of this we also implement convenience functions to abbreviate \
required transpositions and contractions etc.\
\>", "Text",
 CellChangeTimes->{{3.9413086871690903`*^9, 3.941308698386858*^9}, {
  3.941308794706573*^9, 3.941308982123046*^9}, {3.94130901319751*^9, 
  3.941309038449292*^9}, {3.9413091251080236`*^9, 
  3.941309129963937*^9}},ExpressionUUID->"b7f240a0-ff3f-4412-add4-\
233ab11d361d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "=", 
   RowBox[{"<|", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.933270618026483*^9, 3.933270620468909*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d6f58052-e3e7-4c18-a2cc-c5c2e6cc0a8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "tensor", " ", "calculus", " ", "for", " ", "signed", " ", "distance", " ",
     "function"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rs", "[", "\"\<\[Gamma]\>\"", "]"}], "=", 
     RowBox[{"\[Gamma]", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "}"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"\[Rho]", " ", 
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}]}]}], "]"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rs", "[", "\"\<h\>\"", "]"}], "=", 
     RowBox[{"h", "->", 
      RowBox[{"(", 
       RowBox[{"1", "&"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", "\"\<jacobian\>\"", 
      "]"}], "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", 
               RowBox[{"h", "[", 
                RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"v\[Sigma]", "[", 
                RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}], "-", 
               FractionBox[
                RowBox[{"\[Rho]", " ", 
                 RowBox[{
                  SubscriptBox["\[PartialD]", "\[Sigma]"], 
                  RowBox[{"v\[Rho]", "[", 
                   RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}]}], 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}], 
                 RowBox[{"h", "[", 
                  RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}]]}], ")"}]}], 
            ",", 
            FractionBox["1", 
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}], 
              RowBox[{"h", "[", 
               RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}]], ",", "0"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v\[Rho]", "[", 
              RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}], ",", "0", ",", 
            "1"}], "}"}]}], "}"}], "\[Transpose]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", "\"\<connection\>\"", 
      "]"}], "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{
                SubscriptBox["\[PartialD]", "\[Sigma]"], 
                RowBox[{"v\[Rho]", "[", 
                 RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}], 
               RowBox[{
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}], 
                RowBox[{"h", "[", 
                 RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}]], ",", 
              FractionBox[
               RowBox[{"\[Kappa]", "[", 
                RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}]], 
              ",", "0"}], "}"}]}], "}"}], "\[Transpose]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{
                 SubscriptBox["\[PartialD]", "\[Sigma]"], 
                 RowBox[{"v\[Rho]", "[", 
                  RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}], 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}], 
                 RowBox[{"h", "[", 
                  RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}]}]]}], ",", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[Kappa]", "[", 
                 RowBox[{"\[Tau]", ",", "\[Sigma]"}], "]"}], 
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"\[Tau]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}]]}],
               ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], 
          "\[Transpose]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"enumerate", "[", "l_", "]"}], " ", ":=", " ", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "}"}], "&"}], ")"}], 
       ",", "l"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"calcMultiPermutation", "[", 
      RowBox[{"pairs_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "posPairs", ",", "sources", ",", "targets", ",", "unspecified", ",", 
         "permutation", ",", "source", ",", "target"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pairs", "==", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Range", "[", "n", "]"}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"posPairs", "=", 
           RowBox[{"pairs", "/.", 
            RowBox[{
             RowBox[{"a_Integer", "/;", 
              RowBox[{"a", "<", "0"}]}], ":>", 
             RowBox[{"n", "+", "1", "+", "a"}]}]}]}], ";", "\n", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sources", ",", "targets"}], "}"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"posPairs", "/.", 
              RowBox[{"Rule", "->", "List"}]}], ")"}], "\[Transpose]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"unspecified", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Range", "[", "n", "]"}], ",", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"targets", ",", "#"}], "]"}], "]"}], "&"}]}], "]"}]}],
           ";", "\n", "\t", 
          RowBox[{"permutation", "=", "unspecified"}], ";", "\n", "\t", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"source", ",", "target"}], "}"}], "=", 
              RowBox[{"List", "@@", "pair"}]}], ";", 
             RowBox[{"permutation", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"permutation", ",", "target", ",", "source"}], 
               "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"pair", ",", 
              RowBox[{"SortBy", "[", 
               RowBox[{"posPairs", ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], "}"}]}], 
           "]"}], ";", "\n", "\t", "permutation"}]}], "]"}]}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"contractConnection", "[", 
      RowBox[{"tensor_", ",", "connection_", ",", "slot_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "rank", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"TensorRank", "[", "tensor", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"connection", "\[TensorProduct]", "tensor"}], 
           "\[IndentingNewLine]", "//", 
           RowBox[{
            RowBox[{"TensorContract", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"slot", "+", "3"}]}], "}"}], "}"}]}], "]"}], "&"}]}],
           "\[IndentingNewLine]", "//", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"calcMultiPermutation", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "->", 
                 RowBox[{"slot", "+", "1"}]}], "}"}], ",", 
               RowBox[{"rank", "+", "1"}]}], "]"}]}], "]"}], "&"}]}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"contractOne", "[", 
      RowBox[{"tensor_", ",", "mat_", ",", "slot_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "rank", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"TensorRank", "[", "tensor", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"tensor", "\[IndentingNewLine]", "//", 
            RowBox[{
             RowBox[{"#", "\[TensorProduct]", "mat"}], "&"}]}], 
           "\[IndentingNewLine]", "//", 
           RowBox[{
            RowBox[{"TensorContract", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"slot", ",", 
                 RowBox[{"rank", "+", "1"}]}], "}"}], "}"}]}], "]"}], "&"}]}],
           "\[IndentingNewLine]", "//", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"calcMultiPermutation", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rank", "->", "slot"}], "}"}], ",", "rank"}], "]"}]}],
             "]"}], "&"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"spaceTimeGrad", "[", 
      RowBox[{"f_", ",", "coords_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rank", ",", "partials"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "f", "]"}], "===", "List"}], ",", 
           RowBox[{"TensorRank", "[", "f", "]"}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"partials", "=", 
         RowBox[{
          RowBox[{"Grad", "[", 
           RowBox[{"f", ",", "coords"}], "]"}], "//", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"#", ",", 
             RowBox[{"RotateLeft", "[", 
              RowBox[{"Range", "[", 
               RowBox[{"rank", "+", "1"}], "]"}], "]"}]}], "]"}], "&"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", 
             "\"\<jacobian\>\"", "]"}], "@@", "coords"}], ")"}], ".", 
          "partials"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"contractConnection", "[", 
            RowBox[{"f", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", 
               "\"\<connection\>\"", "]"}], "@@", "coords"}], ",", "ii"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "rank"}], "}"}]}], "]"}]}]}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", "\"\<spaceProj\>\"", 
      "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"UnitVector", "[", 
         RowBox[{"3", ",", "ii"}], "]"}], "//", 
        RowBox[{
         RowBox[{"#", "\[TensorProduct]", "#"}], "&"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", "\"\<spaceFilter\>\"", 
      "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", "\"\<spaceProj\>\"", 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", 
      "\"\<spaceTimeFilter\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", "\"\<spaceFilter\>\"", 
       "]"}], "\[Transpose]"}]}], ";", 
    RowBox[{
     RowBox[{"toSpaceTime", "[", "f_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rank", ",", "shape", ",", "spaceInds", ",", "out"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"shape", "=", 
         RowBox[{"Dimensions", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"rank", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "f", "]"}], "===", "List"}], ",", 
           RowBox[{"TensorRank", "[", "f", "]"}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rank", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"spaceInds", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"len", "==", "2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"len", ",", "shape"}], "}"}]}], "]"}], 
                "\[IndentingNewLine]", "//", "enumerate"}], 
               "\[IndentingNewLine]", "//", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "True"}], "&"}]}], 
                 "]"}], "&"}]}], "\[IndentingNewLine]", "//", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "&"}]}], ")"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"out", "=", "f"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"out", "=", 
              RowBox[{"contractOne", "[", 
               RowBox[{"out", ",", 
                RowBox[{
                 RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", 
                 "\"\<spaceTimeFilter\>\"", "]"}], ",", "slot"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"slot", ",", "spaceInds"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "out"}], ",", "\[IndentingNewLine]", "f"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toSpace", "[", "f_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rank", ",", "shape", ",", "fullInds", ",", "out"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"shape", "=", 
         RowBox[{"Dimensions", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"rank", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "f", "]"}], "===", "List"}], ",", 
           RowBox[{"TensorRank", "[", "f", "]"}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rank", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fullInds", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"len", "==", "3"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"len", ",", "shape"}], "}"}]}], "]"}], 
                "\[IndentingNewLine]", "//", "enumerate"}], 
               "\[IndentingNewLine]", "//", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "True"}], "&"}]}], 
                 "]"}], "&"}]}], "\[IndentingNewLine]", "//", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "&"}]}], ")"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"out", "=", "f"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"out", "=", 
              RowBox[{"contractOne", "[", 
               RowBox[{"out", ",", 
                RowBox[{
                 RowBox[{"es", "[", "\"\<arrs\>\"", "]"}], "[", 
                 "\"\<spaceFilter\>\"", "]"}], ",", "slot"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"slot", ",", "fullInds"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "out"}], ",", "\[IndentingNewLine]", "f"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"spaceGrad", "[", 
      RowBox[{"f_", ",", "coords_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "toSpaceTime"}], "//", 
       RowBox[{
        RowBox[{"spaceTimeGrad", "[", 
         RowBox[{"#", ",", "coords"}], "]"}], "&"}]}], "//", "toSpace"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt0", "[", 
      RowBox[{"f_", ",", "coords_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "toSpaceTime"}], "//", 
       RowBox[{
        RowBox[{"spaceTimeGrad", "[", 
         RowBox[{"#", ",", "coords"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ".", "#"}], "&"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.925410686925483*^9, 3.9254107660507603`*^9}, {
   3.925410830387848*^9, 3.92541089017825*^9}, {3.925410928891109*^9, 
   3.925410980717381*^9}, {3.925411063527159*^9, 3.925411310957692*^9}, {
   3.925411439270929*^9, 3.925411489255529*^9}, {3.925411528545823*^9, 
   3.925411560905282*^9}, {3.925411603206799*^9, 3.925411679947967*^9}, {
   3.925411712171166*^9, 3.9254117849856586`*^9}, {3.925411820821084*^9, 
   3.925411965914876*^9}, {3.925412020805942*^9, 3.925412193962242*^9}, {
   3.925412226276422*^9, 3.925412346350092*^9}, {3.925412379987615*^9, 
   3.925412415176692*^9}, {3.925412468394409*^9, 3.925412531083593*^9}, {
   3.925412574775857*^9, 3.925412646440061*^9}, {3.9254126825785*^9, 
   3.925412851470252*^9}, {3.92541289283495*^9, 3.925412965820825*^9}, {
   3.92541341097471*^9, 3.925413576240059*^9}, {3.925413610945981*^9, 
   3.925413722244555*^9}, {3.925413774573417*^9, 3.925413777120391*^9}, {
   3.925413834372891*^9, 3.9254138356746273`*^9}, {3.925413882990925*^9, 
   3.925414091078267*^9}, {3.92541412661858*^9, 3.925414309573999*^9}, {
   3.92541434615676*^9, 3.925414364311376*^9}, {3.92541453063266*^9, 
   3.9254145546585407`*^9}, {3.925414593356914*^9, 3.9254146605777*^9}, {
   3.925414710591429*^9, 3.925414768974921*^9}, {3.925414804162609*^9, 
   3.925414823974945*^9}, {3.925414867068237*^9, 3.925414905228904*^9}, {
   3.925414936993082*^9, 3.925415107049269*^9}, {3.9254151432451463`*^9, 
   3.925415213722327*^9}, {3.925415245710903*^9, 3.9254153985629*^9}, {
   3.925415487219271*^9, 3.925415512213025*^9}, {3.925415562169866*^9, 
   3.9254155918739347`*^9}, {3.925415700529805*^9, 3.9254157735914583`*^9}, {
   3.925415873175067*^9, 3.925415873331398*^9}, {3.925416011413009*^9, 
   3.925416173668475*^9}, {3.925416211931176*^9, 3.925416489236919*^9}, {
   3.925416532983465*^9, 3.925416533669909*^9}, {3.925416598658949*^9, 
   3.925416914141212*^9}, {3.925416944913143*^9, 3.92541706556323*^9}, {
   3.9254171058965054`*^9, 3.925417118786487*^9}, {3.925417149516284*^9, 
   3.92541718902902*^9}, {3.925417258027317*^9, 3.925417358742579*^9}, {
   3.925417407507038*^9, 3.925417411791795*^9}, {3.925417449008486*^9, 
   3.925417551991803*^9}, {3.92541758520912*^9, 3.925417585635527*^9}, {
   3.925417741720288*^9, 3.925417753993677*^9}, {3.925417821282898*^9, 
   3.925417881143179*^9}, {3.925417937391917*^9, 3.925417955259959*^9}, {
   3.925430411278133*^9, 3.925430416478302*^9}, {3.925430497175742*^9, 
   3.925430513667574*^9}, 3.925430579635147*^9, {3.925430710807773*^9, 
   3.9254307127607822`*^9}, {3.925430818810457*^9, 3.925430864896277*^9}, {
   3.925463644874638*^9, 3.925463704270145*^9}, {3.925463764042646*^9, 
   3.925463800376926*^9}, {3.9254639765867033`*^9, 3.9254640089047213`*^9}, {
   3.925464046201472*^9, 3.925464074216558*^9}, {3.925470105442244*^9, 
   3.925470215381029*^9}, {3.925470328810892*^9, 3.925470388735385*^9}, 
   3.925470429582185*^9, {3.925470465716573*^9, 3.925470604639782*^9}, {
   3.925470652142866*^9, 3.925470861448613*^9}, {3.92547089693116*^9, 
   3.925471011613266*^9}, {3.925471090701519*^9, 3.925471156814423*^9}, {
   3.9254712038138723`*^9, 3.925471316626903*^9}, {3.925471443946589*^9, 
   3.925471511323885*^9}, 3.925471543304433*^9, {3.925471692363459*^9, 
   3.925471719080811*^9}, {3.92547175583163*^9, 3.9254718155501204`*^9}, {
   3.92547184710555*^9, 3.925471880194324*^9}, {3.925471910945205*^9, 
   3.92547191871286*^9}, {3.925471958525156*^9, 3.925472078139413*^9}, {
   3.925472117923146*^9, 3.925472137665878*^9}, {3.925472229181511*^9, 
   3.925472260615786*^9}, {3.9254723274239397`*^9, 3.925472406215194*^9}, {
   3.925472458932505*^9, 3.925472611181235*^9}, 3.925472657252408*^9, {
   3.925472738255528*^9, 3.925472791128469*^9}, {3.9254728244174433`*^9, 
   3.925472990985017*^9}, 3.925473127404223*^9, {3.925490487511595*^9, 
   3.925490621627142*^9}, {3.925496877253932*^9, 3.925496911300791*^9}, {
   3.925497058257701*^9, 3.925497173656856*^9}, {3.925497233296894*^9, 
   3.925497433480867*^9}, {3.925497469535129*^9, 3.925497647979775*^9}, {
   3.925518783224534*^9, 3.9255187939897423`*^9}, {3.925518837974482*^9, 
   3.925518843305045*^9}, {3.925518932202539*^9, 3.92551907751511*^9}, {
   3.925519136796869*^9, 3.925519137767964*^9}, 3.925519552537704*^9, {
   3.9256406687407928`*^9, 3.9256407106192303`*^9}, {3.925640835791711*^9, 
   3.925640926204642*^9}, {3.925640977445459*^9, 3.9256410842383957`*^9}, {
   3.9256411394721*^9, 3.9256411488082523`*^9}, {3.925641184733033*^9, 
   3.925641185278343*^9}, {3.925641250511858*^9, 3.925641277584804*^9}, 
   3.925641312924683*^9, {3.925641369737673*^9, 3.92564139281398*^9}, {
   3.925641424754411*^9, 3.925641509666863*^9}, {3.925641762125755*^9, 
   3.925641786932507*^9}, {3.925641828658832*^9, 3.925641854775062*^9}, {
   3.9256420447525473`*^9, 3.925642058529503*^9}, {3.925642212028014*^9, 
   3.925642231767747*^9}, {3.925642311266077*^9, 3.925642368693316*^9}, {
   3.925642556577857*^9, 3.92564257730676*^9}, {3.925642626843559*^9, 
   3.925642686846953*^9}, {3.925642796330684*^9, 3.925642798717202*^9}, {
   3.925642895053193*^9, 3.925642895836752*^9}, {3.925642943394953*^9, 
   3.925643000849737*^9}, {3.925643032200781*^9, 3.925643040489093*^9}, {
   3.925643154600471*^9, 3.925643174689171*^9}, {3.925643424754437*^9, 
   3.925643436065697*^9}, {3.925643717494294*^9, 3.92564376456769*^9}, {
   3.925643803839929*^9, 3.9256438112851763`*^9}, {3.925643887741283*^9, 
   3.9256438906164913`*^9}, {3.925644108268881*^9, 3.925644141898965*^9}, {
   3.925644174137979*^9, 3.9256442167896433`*^9}, {3.925644249589325*^9, 
   3.925644389926091*^9}, {3.925644429499857*^9, 3.925644446296219*^9}, {
   3.925644708397355*^9, 3.9256447101543913`*^9}, {3.925644999344623*^9, 
   3.925645142234886*^9}, {3.925645663949786*^9, 3.925645669720319*^9}, {
   3.925645783962129*^9, 3.925645784524869*^9}, {3.925645823707058*^9, 
   3.925645832270645*^9}, {3.925650409585557*^9, 3.925650417400633*^9}, {
   3.9259190250852737`*^9, 3.925919048580121*^9}, {3.925919843860767*^9, 
   3.925919844135592*^9}, {3.925920484859653*^9, 3.925920573971195*^9}, {
   3.925920608464291*^9, 3.925920666499436*^9}, {3.9259244993140483`*^9, 
   3.925924554660249*^9}, {3.925924638510784*^9, 3.925924700454774*^9}, {
   3.92592473351258*^9, 3.925924770926766*^9}, {3.925924803114419*^9, 
   3.925924810411546*^9}, {3.925940275435001*^9, 3.92594033035479*^9}, {
   3.925940374487308*^9, 3.9259403879712057`*^9}, {3.925940491465773*^9, 
   3.925940604410649*^9}, {3.925940678072773*^9, 3.925940741362468*^9}, {
   3.925940786373087*^9, 3.925940813007029*^9}, {3.925940959030951*^9, 
   3.925941003314311*^9}, {3.925941666825403*^9, 3.9259417128505096`*^9}, {
   3.925941760778157*^9, 3.925941791607195*^9}, {3.925941823578835*^9, 
   3.925941868761372*^9}, {3.925941934778737*^9, 3.925941942195022*^9}, {
   3.925941988474377*^9, 3.925942165022881*^9}, {3.925942207329323*^9, 
   3.925942316180415*^9}, {3.925942457304144*^9, 3.925942466165268*^9}, {
   3.925942505555979*^9, 3.9259425299817963`*^9}, {3.9259439987915993`*^9, 
   3.925944001087237*^9}, {3.925945350325037*^9, 3.925945350994561*^9}, {
   3.925945405583636*^9, 3.9259454127095*^9}, {3.925945450877384*^9, 
   3.925945451180237*^9}, {3.925945514003962*^9, 3.925945542628718*^9}, 
   3.925945575289652*^9, {3.925945614806068*^9, 3.9259456152023773`*^9}, {
   3.925945760757162*^9, 3.9259457981513844`*^9}, {3.92594605518559*^9, 
   3.925946215783018*^9}, {3.9259467813931913`*^9, 3.925946782924684*^9}, {
   3.925946828022904*^9, 3.925946843102127*^9}, {3.925947085240675*^9, 
   3.925947501624868*^9}, {3.925947548090802*^9, 3.925948145299657*^9}, {
   3.9260971266127453`*^9, 3.926097146495175*^9}, {3.926618661239552*^9, 
   3.926618684769106*^9}, {3.926618739459273*^9, 3.926618923586027*^9}, {
   3.926619044421625*^9, 3.9266190561005087`*^9}, {3.9266191549767933`*^9, 
   3.926619162888148*^9}, {3.926619236925301*^9, 3.92661923797571*^9}, {
   3.92662005236668*^9, 3.926620053949233*^9}, {3.9266201549817677`*^9, 
   3.926620158071278*^9}, {3.926620403961007*^9, 3.926620404974864*^9}, {
   3.9266204500411797`*^9, 3.926620603320011*^9}, {3.926620637974948*^9, 
   3.9266206672284193`*^9}, {3.926620758125596*^9, 3.926620844784169*^9}, {
   3.926620918680159*^9, 3.926620989261848*^9}, {3.9266210732426033`*^9, 
   3.926621151627458*^9}, {3.926622645860815*^9, 3.926622670109545*^9}, {
   3.926622727585648*^9, 3.92662282220388*^9}, {3.9266228744474897`*^9, 
   3.926622880417741*^9}, {3.9266250278904057`*^9, 3.926625052692921*^9}, {
   3.926625196526383*^9, 3.926625213697743*^9}, {3.9266253660421553`*^9, 
   3.926625405794985*^9}, {3.926625988734427*^9, 3.926626118191979*^9}, {
   3.926626159552002*^9, 3.926626399499148*^9}, {3.926626470353749*^9, 
   3.926626526678968*^9}, {3.926626565798501*^9, 3.926626755623301*^9}, {
   3.9266268593078957`*^9, 3.926626865283855*^9}, {3.926626906029542*^9, 
   3.926627120761113*^9}, {3.926627172297103*^9, 3.926627242111*^9}, {
   3.9266273143456373`*^9, 3.926627397630018*^9}, {3.926627431064539*^9, 
   3.926627777728271*^9}, {3.92662781471867*^9, 3.926627818045527*^9}, {
   3.926627926925622*^9, 3.926627947736575*^9}, {3.926627993754353*^9, 
   3.9266279972071457`*^9}, {3.9266280563536797`*^9, 3.92662816252536*^9}, {
   3.926628203243499*^9, 3.926628247058563*^9}, {3.926628294468389*^9, 
   3.926628301372465*^9}, {3.926628361166174*^9, 3.926628363125066*^9}, {
   3.926628413171448*^9, 3.92662841761786*^9}, {3.9266284724423018`*^9, 
   3.926628504839519*^9}, {3.926628607301285*^9, 3.926628806159783*^9}, {
   3.926628884730983*^9, 3.926628886818036*^9}, {3.926637252480709*^9, 
   3.92663727715349*^9}, {3.926637422003912*^9, 3.926637422190289*^9}, {
   3.926639945254268*^9, 3.926639956286813*^9}, {3.926639993099669*^9, 
   3.9266399948577*^9}, {3.926640089048705*^9, 3.926640090231439*^9}, {
   3.926640125131091*^9, 3.926640172381157*^9}, {3.926640276139696*^9, 
   3.926640283696463*^9}, {3.926640617621235*^9, 3.92664066410904*^9}, {
   3.9266407516052732`*^9, 3.926640917064811*^9}, {3.926640958164799*^9, 
   3.926640963068991*^9}, {3.926641043001585*^9, 3.9266410463843813`*^9}, {
   3.926641104496961*^9, 3.926641148834687*^9}, {3.926641193080079*^9, 
   3.9266412176122303`*^9}, {3.926641262186844*^9, 3.926641265353759*^9}, {
   3.926641320570208*^9, 3.926641325813965*^9}, 3.926642437934095*^9, {
   3.926642519901617*^9, 3.926642737853281*^9}, {3.9266428018176107`*^9, 
   3.926642807042605*^9}, {3.92664285750268*^9, 3.926642978599292*^9}, {
   3.926643011744535*^9, 3.926643052786866*^9}, {3.926643085922058*^9, 
   3.926643099548058*^9}, {3.926677494940881*^9, 3.9266775526927032`*^9}, 
   3.9266778403748627`*^9, {3.926677920034314*^9, 3.92667794606006*^9}, {
   3.926677976910888*^9, 3.9266780033016367`*^9}, 3.926678034350536*^9, {
   3.926678074881413*^9, 3.926678104169224*^9}, {3.926678158777864*^9, 
   3.926678161758038*^9}, {3.926678445099201*^9, 3.926678453383772*^9}, {
   3.926678501595512*^9, 3.926678511312772*^9}, {3.926678581766487*^9, 
   3.926678604164518*^9}, {3.926678641171679*^9, 3.9266786677674522`*^9}, 
   3.92667895353615*^9, {3.926679016290677*^9, 3.926679090942739*^9}, {
   3.926679135839398*^9, 3.926679305409171*^9}, {3.926679339522484*^9, 
   3.926679443370703*^9}, {3.926679566506235*^9, 3.926679655197221*^9}, {
   3.926679689173218*^9, 3.9266797685888166`*^9}, {3.92667983017798*^9, 
   3.926679843010433*^9}, 3.92668011091184*^9, 3.926680257730434*^9, {
   3.92668030177103*^9, 3.926680407985086*^9}, {3.926680453328801*^9, 
   3.926680503467994*^9}, {3.92668053963123*^9, 3.926680675164212*^9}, {
   3.92668106556907*^9, 3.9266811701231947`*^9}, {3.9266812046609*^9, 
   3.926681375388711*^9}, 3.926681411985491*^9, {3.926681446842987*^9, 
   3.926681451119415*^9}, {3.9266817661017*^9, 3.926682039176491*^9}, {
   3.92668208365723*^9, 3.926682141568017*^9}, {3.926682456867999*^9, 
   3.926682471878976*^9}, {3.926682508603834*^9, 3.92668251441337*^9}, {
   3.926682605732058*^9, 3.926682624451644*^9}, {3.926682774928075*^9, 
   3.926682829441577*^9}, {3.926682861058363*^9, 3.926682867886271*^9}, {
   3.926682916132958*^9, 3.926682936415158*^9}, {3.926683007380936*^9, 
   3.92668305414933*^9}, {3.926683384523347*^9, 3.92668352392207*^9}, {
   3.9266837344915667`*^9, 3.926684067618012*^9}, {3.926684190164133*^9, 
   3.926684191251293*^9}, {3.926684244479905*^9, 3.926684355559031*^9}, {
   3.926684390421715*^9, 3.926684405064234*^9}, {3.92668445374419*^9, 
   3.926684456124658*^9}, {3.926684534558231*^9, 3.926684592310801*^9}, {
   3.926684638737491*^9, 3.926684661341066*^9}, {3.926684695208951*^9, 
   3.926684848076465*^9}, {3.9266848994805307`*^9, 3.926684979506524*^9}, {
   3.926685011589582*^9, 3.926685024750055*^9}, {3.926685058151209*^9, 
   3.926685078566437*^9}, {3.9266852411291237`*^9, 3.9266853638428183`*^9}, {
   3.926697030313027*^9, 3.926697143736764*^9}, {3.926697205927791*^9, 
   3.926697235457863*^9}, {3.926697270419034*^9, 3.926697350489312*^9}, {
   3.926697399692216*^9, 3.92669740902578*^9}, {3.926697444468149*^9, 
   3.926697470341204*^9}, {3.926697510102458*^9, 3.9266975309986763`*^9}, {
   3.926697660081338*^9, 3.9266977836808777`*^9}, {3.926697817254685*^9, 
   3.926697823928283*^9}, {3.926697876317273*^9, 3.926697878644417*^9}, {
   3.9266981220844193`*^9, 3.926698131205424*^9}, {3.92669837628048*^9, 
   3.926698475491504*^9}, 3.926698529206216*^9, {3.926698593318774*^9, 
   3.926698595555357*^9}, {3.926702970357356*^9, 3.926702971451695*^9}, {
   3.926703020896246*^9, 3.926703056852838*^9}, {3.927159261454791*^9, 
   3.927159269276444*^9}, {3.9271596361577997`*^9, 3.927159656591415*^9}, {
   3.927159723068132*^9, 3.927159740644443*^9}, {3.927159792120784*^9, 
   3.927159816790938*^9}, {3.927159902227395*^9, 3.927159936351653*^9}, {
   3.927160067246153*^9, 3.927160205936183*^9}, {3.927160250625888*^9, 
   3.927160295931014*^9}, {3.927160365422079*^9, 3.927160396685096*^9}, {
   3.927160437157071*^9, 3.9271604686960406`*^9}, {3.927160510548294*^9, 
   3.927160576386003*^9}, {3.927160616315659*^9, 3.927160775781019*^9}, {
   3.927160911070426*^9, 3.927160940775629*^9}, 3.927164269733857*^9, {
   3.927164386730577*^9, 3.927164403567309*^9}, 3.927164445506919*^9, 
   3.927164493040428*^9, {3.9271646261330957`*^9, 3.927164710426641*^9}, {
   3.92716477320242*^9, 3.927164774540675*^9}, 3.927164822219185*^9, {
   3.927164919161426*^9, 3.927164989727371*^9}, {3.927165155422741*^9, 
   3.927165221977819*^9}, {3.92716531150848*^9, 3.927165335414904*^9}, {
   3.927165585962169*^9, 3.927165607882536*^9}, {3.927165655184515*^9, 
   3.927165658896492*^9}, {3.927165700764578*^9, 3.9271657097744226`*^9}, {
   3.927167093939491*^9, 3.927167095567349*^9}, {3.927167148595939*^9, 
   3.927167336454813*^9}, {3.927167376237451*^9, 3.92716737753694*^9}, {
   3.927167466357589*^9, 3.927167500803281*^9}, {3.927167644197748*^9, 
   3.927167705703717*^9}, 3.927167737711275*^9, {3.927187764947317*^9, 
   3.927187814146552*^9}, {3.927188410967307*^9, 3.927188459355567*^9}, 
   3.927249796632001*^9, {3.927249892424629*^9, 3.927249895366764*^9}, {
   3.927250350355296*^9, 3.927250367543517*^9}, {3.927250403554167*^9, 
   3.927250439454172*^9}, {3.92725072626142*^9, 3.9272507313917017`*^9}, {
   3.927250794710149*^9, 3.92725082822313*^9}, {3.927250895225114*^9, 
   3.92725091584934*^9}, {3.927250961338564*^9, 3.927251014728086*^9}, {
   3.927251049760665*^9, 3.927251058081777*^9}, {3.9272510941377487`*^9, 
   3.927251116790792*^9}, {3.927251231786856*^9, 3.927251264400777*^9}, {
   3.927251313551909*^9, 3.927251313781898*^9}, {3.927251407214114*^9, 
   3.9272514261251287`*^9}, {3.927253640873938*^9, 3.927253650850684*^9}, {
   3.927253705365641*^9, 3.927253781230363*^9}, {3.9272538369439*^9, 
   3.927253837524995*^9}, {3.927253984535984*^9, 3.927253986961845*^9}, {
   3.927337442381399*^9, 3.9273374431501*^9}, {3.927337493086511*^9, 
   3.927337627572579*^9}, {3.927337698758582*^9, 3.927337739605052*^9}, {
   3.927337833645364*^9, 3.927337841094141*^9}, {3.927337879737088*^9, 
   3.927337880701614*^9}, {3.927337935907854*^9, 3.927337964570752*^9}, {
   3.927338002787032*^9, 3.927338040445351*^9}, 3.927338075048592*^9, {
   3.927338818021122*^9, 3.927338956935814*^9}, {3.9273390003402042`*^9, 
   3.927339000582526*^9}, {3.927339615941594*^9, 3.927339711858244*^9}, {
   3.927339853018165*^9, 3.927339853341767*^9}, 3.9274568517138863`*^9, {
   3.927466936339467*^9, 3.927466942789423*^9}, {3.9274670701377497`*^9, 
   3.927467114893643*^9}, {3.927467358352126*^9, 3.9274674498799562`*^9}, {
   3.927467546135248*^9, 3.92746755003341*^9}, {3.927467635238927*^9, 
   3.927467639100675*^9}, 3.927700897018374*^9, {3.927701100142588*^9, 
   3.92770110034732*^9}, {3.928216128982723*^9, 3.928216129098212*^9}, {
   3.928216337356014*^9, 3.9282163391276093`*^9}, {3.92821760246837*^9, 
   3.928217715204542*^9}, {3.928217746345793*^9, 3.928217845962517*^9}, {
   3.928218955770005*^9, 3.928218961289006*^9}, {3.928219053840019*^9, 
   3.9282190553657312`*^9}, {3.9282190870767*^9, 3.928219157323605*^9}, {
   3.928219859967042*^9, 3.928219865168086*^9}, {3.928219908472279*^9, 
   3.928219915275625*^9}, {3.928219948549296*^9, 3.928219969605023*^9}, {
   3.928220017676469*^9, 3.928220021768836*^9}, {3.9282200747486153`*^9, 
   3.928220097689188*^9}, {3.928220128415308*^9, 3.928220157877393*^9}, 
   3.928220199026829*^9, {3.928220244249847*^9, 3.928220276264702*^9}, {
   3.928220642336429*^9, 3.928220649178397*^9}, {3.928220828039917*^9, 
   3.928220833821905*^9}, 3.928913732310934*^9, {3.928914110732763*^9, 
   3.928914119432996*^9}, {3.92891415926531*^9, 3.928914160587376*^9}, {
   3.928914192085792*^9, 3.928914194966801*^9}, {3.928914263886251*^9, 
   3.928914272483041*^9}, {3.928914385664253*^9, 3.928914386415983*^9}, {
   3.928914424040804*^9, 3.928914441067935*^9}, {3.928914530085784*^9, 
   3.92891485072805*^9}, {3.928914922737582*^9, 3.928915096834044*^9}, {
   3.928915136031841*^9, 3.928915136994087*^9}, {3.928915190769579*^9, 
   3.928915281648067*^9}, {3.928915366098811*^9, 3.9289154135577507`*^9}, {
   3.928915443884858*^9, 3.928915459802536*^9}, {3.928994355674395*^9, 
   3.928994394815767*^9}, {3.928994575708689*^9, 3.92899459628908*^9}, {
   3.931396546652409*^9, 3.931396637841362*^9}, 3.935475344886028*^9, 
   3.941308989767963*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"1c66e148-d259-41ca-8126-105798aa12aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deriving the equations", "Chapter",
 CellChangeTimes->{{3.941170833191956*^9, 3.941170836574898*^9}, {
  3.948856979716914*^9, 
  3.9488569823870773`*^9}},ExpressionUUID->"7ce1cebf-32b9-443e-902a-\
23c639c5c94c"],

Cell[CellGroupData[{

Cell["Area", "Section",
 CellChangeTimes->{{3.94885706865172*^9, 
  3.9488570690587683`*^9}},ExpressionUUID->"95d6e8a5-62e3-4927-a1a2-\
0dde2013826f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "=", 
   RowBox[{"<|", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948795454536257*^9, 3.948795459412518*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"e669b7f6-9036-47f9-8ad4-f58016cf1478"],

Cell[CellGroupData[{

Cell["The evolution equations for all orders", "Subsection",
 CellChangeTimes->{{3.948794624476554*^9, 
  3.948794634990965*^9}},ExpressionUUID->"a0e8d823-0b17-4c01-abc6-\
210e63d8ccf0"],

Cell[TextData[{
 "This cell will take the very abstract equations we defined above, and \
perform all the necessary steps to expand them into full form, for an \
asymptotic expansion ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["c", 
      SubscriptBox["A", "j"]], "(", 
     RowBox[{"t", ",", "x", ",", "y", ",", "\[CurlyEpsilon]"}], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     RowBox[{
      SuperscriptBox["\[CurlyEpsilon]", "k"], 
      RowBox[{
       SubsuperscriptBox["c", "k", 
        SubscriptBox["A", "j"]], "(", 
       RowBox[{"t", ",", "x", ",", "y"}], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9b352688-19ff-43dd-a0db-fa74f8896b5f"],
 " in the bulk regions ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"j", "=", 
     RowBox[{"+", "1"}]}], ",", 
    RowBox[{"-", "1"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d8af939d-c310-4fca-9782-90a28d49c927"],
 "."
}], "Text",
 CellChangeTimes->{{3.950670178056015*^9, 
  3.9506702957548637`*^9}},ExpressionUUID->"a96ceb7a-71ca-42f0-bbce-\
1b83e986f924"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<flow\>\"", "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", ":>", 
       RowBox[{"m", "[", 
        RowBox[{"\"\<A\>\"", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"c", ":>", 
       RowBox[{"c", "[", 
        RowBox[{"\"\<A\>\"", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"f_", "[", 
        RowBox[{"\"\<A\>\"", ",", "j_"}], "]"}], ":>", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"\"\<A\>\"", ",", "j"}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
           RowBox[{"t", ",", "x", ",", "y"}], "]"}], 
          SuperscriptBox["\[CurlyEpsilon]", "k"]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"f", "===", "m"}], ",", "0", ",", "1"}], "]"}], "*)"}], 
           "0", ",", "2"}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dt", "[", "f_", "]"}], ":>", 
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], "f"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lap", "[", "f_", "]"}], ":>", 
       RowBox[{"Laplacian", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "Simplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], 
          "[", "\"\<flow\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "\[IndentingNewLine]", "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9487944266037817`*^9, 3.9487944304893703`*^9}, {
   3.9487944744820213`*^9, 3.948794615132736*^9}, {3.9487949597856693`*^9, 
   3.948794961414356*^9}, {3.9487954488834257`*^9, 3.948795497341589*^9}, {
   3.948795692988615*^9, 3.9487956940635147`*^9}, {3.948796559855783*^9, 
   3.948796581143991*^9}, {3.94879664174852*^9, 3.948796681347948*^9}, 
   3.948816019492938*^9, {3.950090070402792*^9, 3.950090140861228*^9}, {
   3.9500901954412003`*^9, 3.950090230581052*^9}, {3.950092225540264*^9, 
   3.950092235247735*^9}, {3.9506703378683453`*^9, 3.9506703395907907`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"5c6cf941-e756-4fa2-88c4-0841d0ee30a2"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<flow\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "}"}], ",", "0"}], 
      "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
      "\"\<flow\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948795518760186*^9, 3.94879559065802*^9}, {
  3.948795698361738*^9, 3.948795700131199*^9}, {3.948796447442148*^9, 
  3.948796447694159*^9}, {3.950090236574016*^9, 3.950090246894498*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"0f65d2b2-6fcd-46fa-80a9-8f4dcc864c09"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The chemical potential equations for all orders", "Subsection",
 CellChangeTimes->{{3.948794640961928*^9, 
  3.948794654297941*^9}},ExpressionUUID->"bccd526b-8feb-4ec6-9e16-\
e15153da1f37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<chem\>\"", "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", ":>", 
       RowBox[{"m", "[", 
        RowBox[{"\"\<A\>\"", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"c", ":>", 
       RowBox[{"c", "[", 
        RowBox[{"\"\<A\>\"", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"f_", "[", 
        RowBox[{"\"\<A\>\"", ",", "j_"}], "]"}], ":>", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"\"\<A\>\"", ",", "j"}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
           RowBox[{"t", ",", "x", ",", "y"}], "]"}], 
          SuperscriptBox["\[CurlyEpsilon]", "k"]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lap", "[", "f_", "]"}], ":>", 
       RowBox[{"Laplacian", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "Simplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], 
          "[", "\"\<chem\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "\[IndentingNewLine]", "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.941171436473826*^9, 3.941171694407404*^9}, {
   3.94125285752022*^9, 3.941252893898898*^9}, {3.94125371040281*^9, 
   3.941253715194397*^9}, {3.941253768998967*^9, 3.941253851428185*^9}, {
   3.9412556672332563`*^9, 3.941255687272386*^9}, 3.941255838268455*^9, {
   3.941272393351095*^9, 3.941272411661995*^9}, {3.94127255745091*^9, 
   3.941272582593713*^9}, {3.941272710136457*^9, 3.941272981758238*^9}, {
   3.941273080307384*^9, 3.9412730843427887`*^9}, {3.941273119190246*^9, 
   3.941273150549897*^9}, {3.9412731953896027`*^9, 3.941273244157448*^9}, {
   3.941273455037689*^9, 3.941273470038752*^9}, {3.9412746137459803`*^9, 
   3.941274625606687*^9}, {3.941712044281638*^9, 3.941712097073922*^9}, {
   3.948795227961464*^9, 3.948795287981744*^9}, {3.948795362241602*^9, 
   3.9487953665553207`*^9}, {3.948795686707243*^9, 3.948795686826044*^9}, {
   3.948796688713232*^9, 3.9487967033931427`*^9}, {3.950090252397471*^9, 
   3.950090286808387*^9}, {3.9500923067251472`*^9, 3.950092310734482*^9}, {
   3.9506703426061172`*^9, 3.950670343393428*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"a18dfcc6-ed9f-4a8f-9751-fa2f5eac1e0c"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "}"}], ",", "0"}], 
      "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
      "\"\<chem\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948795518760186*^9, 3.94879559065802*^9}, {
  3.948795698361738*^9, 3.9487957174200697`*^9}, {3.948796464524467*^9, 
  3.948796464761883*^9}, {3.950090294304977*^9, 3.950090301304985*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"3a68a126-1c28-467c-9664-b0e2027f075a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary", "Section",
 CellChangeTimes->{{3.948857072459052*^9, 
  3.9488570735709867`*^9}},ExpressionUUID->"4573ce54-6462-41c7-a2c6-\
3b8f1aca2118"],

Cell["\<\
Now we\[CloseCurlyQuote]ll do the same thing in the boundary region, which \
requires different geometric operators\
\>", "Text",
 CellChangeTimes->{{3.9506703508899517`*^9, 
  3.950670363353373*^9}},ExpressionUUID->"f97fcccf-48f8-427c-baa5-\
d86f2212c99e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "=", 
   RowBox[{"<|", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948797980760908*^9, 3.9487979817631063`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"e6a4b284-e913-447d-a79f-f02a9542e97e"],

Cell[CellGroupData[{

Cell["The boundary condition to all orders", "Subsection",
 CellChangeTimes->{{3.950155375784844*^9, 
  3.9501553816164513`*^9}},ExpressionUUID->"18ef477a-a3e0-4f57-bdf6-\
ad961545ca11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"at", "[", 
     RowBox[{"c", ",", 
      RowBox[{"\[Rho]", "->", "0"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{"matchPatt", "[", 
          RowBox[{"{", 
           RowBox[{"c", ",", "m"}], "}"}], "]"}], ")"}]}], ":>", 
       RowBox[{
        RowBox[{"f", "[", "\"\<B\>\"", "]"}], "+", 
        RowBox[{"\[Theta]", " ", 
         RowBox[{"f", "[", 
          RowBox[{"\"\<A\>\"", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Theta]"}], ")"}], 
         RowBox[{"f", "[", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f_", "[", "\"\<B\>\"", "]"}], ":>", 
       RowBox[{
        RowBox[{"f", "[", "\"\<B\>\"", "]"}], "[", 
        RowBox[{"t", ",", "s", ",", 
         RowBox[{"r", "/", "\[CurlyEpsilon]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f_", "[", 
        RowBox[{"\"\<A\>\"", ",", "i_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\"\<A\>\"", ",", "i"}], "]"}], "[", 
        RowBox[{"t", ",", "s", ",", "r"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"r", "/", "\[CurlyEpsilon]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "->", 
       RowBox[{"\[CurlyEpsilon]", " ", "\[Rho]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"at", "[", 
        RowBox[{"f_", ",", "r_"}], "]"}], ":>", 
       RowBox[{"(", 
        RowBox[{"f", "/.", "r"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "0", "]"}], "->", 
       FractionBox["1", "2"]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "dom__", "]"}], "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"c", "[", "dom", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "Simplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<boundary\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.950155023940672*^9, 3.950155136923649*^9}, {
  3.9501551755968447`*^9, 3.9501552644654217`*^9}, {3.950155296309451*^9, 
  3.950155323297379*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"2c23020d-345d-49dd-b07d-a276dbeae4b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
      
      RowBox[{"{", 
       RowBox[{"\"\<boundary\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "}"}], ",", "0"}], 
       "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
       "[", "\"\<boundary\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.950155023940672*^9, 3.950155136923649*^9}, {
  3.9501551755968447`*^9, 3.9501552644654217`*^9}, {3.950155296309451*^9, 
  3.950155323297379*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"d6890b4c-a09a-4576-8d9e-3054c7338a13"]
}, Closed]],

Cell[CellGroupData[{

Cell["Deriving the flow equations to all orders", "Subsection",
 CellChangeTimes->{{3.948797183198822*^9, 3.948797193982011*^9}, {
  3.948798246962879*^9, 
  3.94879825190508*^9}},ExpressionUUID->"057589f5-7bbf-4194-9a33-\
0fc16cb3f99c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<flow\>\"", "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{"matchPatt", "[", 
          RowBox[{"{", 
           RowBox[{"c", ",", "m"}], "}"}], "]"}], ")"}]}], ":>", 
       RowBox[{
        RowBox[{"f", "[", "\"\<B\>\"", "]"}], "+", 
        RowBox[{"\[Theta]", " ", 
         RowBox[{"f", "[", 
          RowBox[{"\"\<A\>\"", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Theta]"}], ")"}], 
         RowBox[{"f", "[", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f_", "[", "\"\<B\>\"", "]"}], ":>", 
       RowBox[{
        RowBox[{"f", "[", "\"\<B\>\"", "]"}], "[", 
        RowBox[{"t", ",", "s", ",", 
         RowBox[{"r", "/", "\[CurlyEpsilon]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f_", "[", 
        RowBox[{"\"\<A\>\"", ",", "i_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\"\<A\>\"", ",", "i"}], "]"}], "[", 
        RowBox[{"t", ",", "s", ",", "r"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"r", "/", "\[CurlyEpsilon]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dt", "[", "f_", "]"}], ":>", 
       RowBox[{"dt0", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "s", ",", "r"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hold", "[", 
        RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lap", "[", "f_", "]"}], ":>", 
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"spaceGrad", "[", 
          RowBox[{
           RowBox[{"spaceGrad", "[", 
            RowBox[{"f", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "s", ",", "r"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "s", ",", "r"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "ReleaseHold", ",", "\[IndentingNewLine]", 
      RowBox[{"h", "->", 
       RowBox[{"(", 
        RowBox[{"1", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s", ",", "r"}], "}"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"\[Kappa]", "[", 
            RowBox[{"t", ",", "s"}], "]"}], "r"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "->", 
       RowBox[{"\[CurlyEpsilon]", " ", "\[Rho]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "dom__", "]"}], "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"c", "[", "dom", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "[", "dom__", "]"}], "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", "dom", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"v\[Rho]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"v\[Sigma]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"v\[Sigma]", "[", "\"\<B\>\"", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "Simplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<flow\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.941171940831579*^9, 3.94117195530046*^9}, {
   3.941171993668068*^9, 3.941172002497511*^9}, {3.941172042772114*^9, 
   3.941172077322203*^9}, {3.9411721159750834`*^9, 3.941172116886346*^9}, {
   3.941172151788521*^9, 3.941172242991785*^9}, {3.9411722855141497`*^9, 
   3.941172346835942*^9}, {3.941172457795436*^9, 3.941172509468899*^9}, {
   3.941256142759356*^9, 3.941256220611615*^9}, {3.941256302648308*^9, 
   3.941256392880446*^9}, {3.941256786772363*^9, 3.941256806657521*^9}, {
   3.941256843576337*^9, 3.941256857937803*^9}, {3.941257054537916*^9, 
   3.941257199623256*^9}, {3.941257390798602*^9, 3.941257524752412*^9}, {
   3.941257621274355*^9, 3.941257621553357*^9}, {3.941257662692687*^9, 
   3.941257878234826*^9}, {3.941257910467929*^9, 3.941258003882989*^9}, {
   3.941258058011195*^9, 3.94125821344578*^9}, {3.941258248981173*^9, 
   3.941258250149523*^9}, {3.941258321902405*^9, 3.9412584232910185`*^9}, {
   3.941258469518918*^9, 3.941258677998743*^9}, {3.941272643808795*^9, 
   3.941272644932451*^9}, {3.941273526330634*^9, 3.9412735463858*^9}, {
   3.941273716181238*^9, 3.941273719616379*^9}, {3.941273750741795*^9, 
   3.9412738809736633`*^9}, {3.94127514563878*^9, 3.94127518420962*^9}, {
   3.9412752263165617`*^9, 3.94127531923232*^9}, 3.941406413224169*^9, {
   3.9417909150951147`*^9, 3.9417909200427837`*^9}, {3.9464601811763*^9, 
   3.9464602314234457`*^9}, {3.946460292921014*^9, 3.946460332254189*^9}, 
   3.9464607156918716`*^9, {3.946460945654853*^9, 3.946460948275955*^9}, {
   3.946460989845193*^9, 3.9464609911456547`*^9}, {3.946461080383588*^9, 
   3.9464611034136744`*^9}, {3.94646121924107*^9, 3.946461228888752*^9}, {
   3.946461280274935*^9, 3.946461319840787*^9}, {3.946461364317453*^9, 
   3.946461395537829*^9}, {3.946461478695706*^9, 3.94646148060217*^9}, {
   3.946461516687784*^9, 3.946461520063713*^9}, {3.946461553104671*^9, 
   3.9464615532693863`*^9}, {3.946461596664443*^9, 3.946461606820745*^9}, {
   3.9464616754486313`*^9, 3.9464617713999243`*^9}, {3.9464618204667797`*^9, 
   3.94646192469388*^9}, {3.946461972810583*^9, 3.946462001287072*^9}, {
   3.946462146493925*^9, 3.946462258185801*^9}, {3.946462291830277*^9, 
   3.946462362006564*^9}, {3.946462426677507*^9, 3.946462427943181*^9}, {
   3.946462535473588*^9, 3.946462564395954*^9}, {3.948797430319013*^9, 
   3.948797431714823*^9}, {3.948797464081259*^9, 3.948797466114217*^9}, {
   3.948797705290668*^9, 3.948797879782621*^9}, {3.948798007520965*^9, 
   3.948798127431443*^9}, {3.948798183322134*^9, 3.948798183710589*^9}, {
   3.948798512830862*^9, 3.948798513501997*^9}, 3.948798787491208*^9, 
   3.948798876003977*^9, 3.9494698999043694`*^9, {3.950090318033585*^9, 
   3.95009039577633*^9}, {3.950091025820805*^9, 3.950091036075235*^9}, {
   3.9500910691007442`*^9, 3.95009107877562*^9}, {3.9500911092362823`*^9, 
   3.950091238612008*^9}, {3.950091273267006*^9, 3.95009131811594*^9}, {
   3.950091404357174*^9, 3.9500914048920803`*^9}, {3.95009162902831*^9, 
   3.95009165561652*^9}, 3.950091946230057*^9, {3.9501484768657627`*^9, 
   3.950148476989874*^9}, {3.950670380766453*^9, 3.950670381531165*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"de97114c-6db3-4198-a858-950f664c3ede"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<flow\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "}"}], ",", "0"}], 
      "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
      "\"\<flow\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948798386844041*^9, 3.948798409778681*^9}, {
  3.950091638130002*^9, 3.95009164372479*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"fe95f7dd-41b8-4b59-9b25-bfb9f66b6acd"],

Cell["\<\
Ok, so the coordinate transform is useful for the chemical potential \
equation, but it\[CloseCurlyQuote]s not useful for the dynamic equation. This \
is just because we\[CloseCurlyQuote]re only dealing with a time derivative \
and a Laplacian. Do that in physical space.\
\>", "Text",
 CellChangeTimes->{{3.941274142931114*^9, 3.941274197136722*^9}, {
  3.941274236677419*^9, 3.9412743067707233`*^9}, {3.941274363142838*^9, 
  3.941274460267524*^9}, {3.9464480199070063`*^9, 3.946448020358822*^9}, {
  3.946462578791729*^9, 
  3.9464625796186323`*^9}},ExpressionUUID->"cd592fb0-f33b-41b1-8549-\
18edacf1a34c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Deriving the chemical potential equations to all orders", "Subsection",
 CellChangeTimes->{{3.948798237095887*^9, 
  3.948798257822563*^9}},ExpressionUUID->"8d1d9258-46aa-4544-b887-\
6255b978bce4"],

Cell["Now we look at the chemical potential equation", "Text",
 CellChangeTimes->{{3.946462586083293*^9, 3.946462612179708*^9}, {
  3.9487982633236713`*^9, 
  3.9487982644982853`*^9}},ExpressionUUID->"d97ef6f3-3b86-4efa-9e6c-\
d8c671254eaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<chem\>\"", "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{"matchPatt", "[", 
          RowBox[{"{", 
           RowBox[{"c", ",", "m"}], "}"}], "]"}], ")"}]}], ":>", 
       RowBox[{
        RowBox[{"f", "[", "\"\<B\>\"", "]"}], "+", 
        RowBox[{"\[Theta]", " ", 
         RowBox[{"f", "[", 
          RowBox[{"\"\<A\>\"", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Theta]"}], ")"}], 
         RowBox[{"f", "[", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f_", "[", "\"\<B\>\"", "]"}], ":>", 
       RowBox[{
        RowBox[{"f", "[", "\"\<B\>\"", "]"}], "[", 
        RowBox[{"t", ",", "s", ",", 
         RowBox[{"r", "/", "\[CurlyEpsilon]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f_", "[", 
        RowBox[{"\"\<A\>\"", ",", "i_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\"\<A\>\"", ",", "i"}], "]"}], "[", 
        RowBox[{"t", ",", "s", ",", "r"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"r", "/", "\[CurlyEpsilon]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dt", "[", "f_", "]"}], ":>", 
       RowBox[{"dt0", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "s", ",", "r"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hold", "[", 
        RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lap", "[", "f_", "]"}], ":>", 
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"spaceGrad", "[", 
          RowBox[{
           RowBox[{"spaceGrad", "[", 
            RowBox[{"f", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "s", ",", "r"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "s", ",", "r"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "ReleaseHold", ",", "\[IndentingNewLine]", 
      RowBox[{"h", "->", 
       RowBox[{"(", 
        RowBox[{"1", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s", ",", "r"}], "}"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"\[Kappa]", "[", 
            RowBox[{"t", ",", "s"}], "]"}], "r"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "->", 
       RowBox[{"\[CurlyEpsilon]", " ", "\[Rho]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "dom__", "]"}], "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"c", "[", "dom", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "[", "dom__", "]"}], "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", "dom", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"x1", ",", "x2", ",", "x3"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"v\[Rho]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"v\[Sigma]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[CurlyEpsilon]", "k"], 
            RowBox[{
             RowBox[{
              RowBox[{"v\[Sigma]", "[", "\"\<B\>\"", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "Simplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<chem\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{
  3.941171936706754*^9, {3.9412755263760147`*^9, 3.941275540301976*^9}, 
   3.941275580396317*^9, {3.941275613291905*^9, 3.9412756659321833`*^9}, {
   3.941276395341776*^9, 3.941276416131926*^9}, {3.941276552364139*^9, 
   3.9412765797157784`*^9}, 3.9416554366711683`*^9, 3.946446987983842*^9, {
   3.946460390378892*^9, 3.946460454144911*^9}, {3.946460538505547*^9, 
   3.946460562949428*^9}, {3.946460612134748*^9, 3.9464606160139313`*^9}, {
   3.9464626259704514`*^9, 3.946462718545043*^9}, {3.9464628259068127`*^9, 
   3.9464628694006033`*^9}, {3.946463011593473*^9, 3.946463041042302*^9}, {
   3.946463828835597*^9, 3.9464639122493143`*^9}, {3.948798291122527*^9, 
   3.948798363860455*^9}, {3.950091698357823*^9, 3.9500917183720903`*^9}, {
   3.950091749675503*^9, 3.950091924876122*^9}, {3.950148503624547*^9, 
   3.9501485037343407`*^9}, {3.9506705029695272`*^9, 3.9506705037712173`*^9}},
 
 CellLabel->"In[47]:=",ExpressionUUID->"8e375c6f-6c69-4b01-8798-5dca320837ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
      
      RowBox[{"{", 
       RowBox[{"\"\<chem\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "k"}], "}"}], ",", "0"}], 
       "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
       "[", "\"\<chem\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948798386844041*^9, 3.948798388811644*^9}, 
   3.9487984198552237`*^9, {3.950091881380703*^9, 3.950091889395343*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"1d2683db-ab7e-46b5-bd7c-9e7f2afeab61"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Leading order solution ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["\[CurlyEpsilon]", "0"], ")"}], TraditionalForm]],
  ExpressionUUID->"f376293f-6a42-40a4-8853-ba33cebd12e5"]
}], "Chapter",
 CellChangeTimes->{{3.941170783568218*^9, 3.941170786744946*^9}, {
  3.948857714933807*^9, 
  3.948857724512844*^9}},ExpressionUUID->"12bed0e9-0cb3-4e43-b461-\
eaa2502cd928"],

Cell[TextData[{
 "Next, we want to isolate the leading order solutions for each variable in \
each domain (area, boundary, or corner). Here on out it\[CloseCurlyQuote]s \
quite specifically about the asymptotics of the Cahn-Hilliard equation. You \
may proceed, ",
 StyleBox["if you dare",
  FontSlant->"Italic"],
 "..."
}], "Text",
 CellChangeTimes->{{3.941309284092482*^9, 3.941309306981401*^9}, {
  3.9506705402524357`*^9, 3.950670549388435*^9}, {3.950670749611886*^9, 
  3.950670821604453*^9}},ExpressionUUID->"b72b0fc8-83c7-4eaf-bcd6-\
9f29f1cd4181"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "=", 
   RowBox[{"<|", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.941711941245792*^9, 3.941711945368807*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"560b89ba-bbe8-4aaf-8de9-5be2eaa0264b"],

Cell[CellGroupData[{

Cell["Area", "Section",
 CellChangeTimes->{{3.9411707914691772`*^9, 
  3.941170791823316*^9}},ExpressionUUID->"0ad570f9-30a9-4fb8-984e-\
ef8cbf1dde2d"],

Cell[TextData[{
 "In the areas, we will see that the leading order solution to the \
concentration profiles are either 0 or 1, sitting at the minima of the free \
energy, located at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["c", 
      RowBox[{"i", ",", "0"}]], 
     SubscriptBox["A", "j"]], "=", 
    SubscriptBox["\[Delta]", 
     RowBox[{"i", ",", "j"}]]}], TraditionalForm]],ExpressionUUID->
  "e18968e1-c769-4a27-b11f-71062e6278f4"],
 "."
}], "Text",
 CellChangeTimes->{{3.941386864020132*^9, 3.941386887166259*^9}, {
   3.941388139547485*^9, 3.94138815085244*^9}, 3.941406002553785*^9, {
   3.941790864935686*^9, 
   3.941790890400021*^9}},ExpressionUUID->"f7d36f66-ef65-435b-a9b1-\
ac846ed9d971"],

Cell[CellGroupData[{

Cell["\<\
Solving leading order evolution equation to obtain the leading order chemical \
potential\
\>", "Subsection",
 CellChangeTimes->{{3.948795171096583*^9, 3.948795184356564*^9}, {
  3.9487959287390947`*^9, 
  3.94879595355116*^9}},ExpressionUUID->"7def0928-107f-4e05-8bc8-\
faec8af89c9d"],

Cell["\<\
The leading order chemical potential has to be a constant in space\
\>", "Text",
 CellChangeTimes->{{3.948796991416564*^9, 
  3.9487970002978287`*^9}},ExpressionUUID->"8031c5ca-5e32-465f-9579-\
791df9e255fc"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<flow\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<m\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"\"\<A\>\"", ",", "j_"}], "]"}], "[", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], ":>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "]"}], "[", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "&"}], 
       ")"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948795012790942*^9, 3.948795068431231*^9}, {
   3.948795784393217*^9, 3.948795811094678*^9}, {3.948795866814065*^9, 
   3.948795881829441*^9}, {3.948796737633162*^9, 3.948796759719002*^9}, {
   3.95009198951826*^9, 3.9500920073853617`*^9}, {3.950092053641614*^9, 
   3.950092065992841*^9}, {3.950092195014543*^9, 3.9500921950576057`*^9}, 
   3.950161400409416*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"ecb1889d-1db8-4170-a622-94e0c4bcfaed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solving leading order chemical potential equation to obtain the leading order \
concentration\
\>", "Subsection",
 CellChangeTimes->{{3.948795171096583*^9, 3.948795184356564*^9}, {
  3.9487959096225977`*^9, 3.94879592601569*^9}, {3.948795959802953*^9, 
  3.948795970167781*^9}},ExpressionUUID->"09aad67b-fedd-4970-80e3-\
4dd2da86c585"],

Cell[TextData[{
 "If we say ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["c", 
     RowBox[{"i", ",", "0"}], 
     SubscriptBox["A", "j"]], "=", 
    SubscriptBox["\[Delta]", 
     RowBox[{"i", ",", "j"}]]}], TraditionalForm]],ExpressionUUID->
  "99ccea3c-e214-4321-92e3-6b01faf900cd"],
 ", then we also find that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["m", 
     RowBox[{"i", ",", "0"}], 
     SubscriptBox["A", "j"]], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "b836f1ce-37ba-4f83-a7b5-f4ae44c946ef"],
 " everywhere"
}], "Text",
 CellChangeTimes->{{3.948797002647503*^9, 3.948797043448683*^9}, {
  3.948797113431279*^9, 
  3.948797164948127*^9}},ExpressionUUID->"46094073-f422-456c-9f99-\
f5e300ffe423"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j", "->", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"\"\<c\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
         "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"\"\<A\>\"", ",", "j_"}], "]"}], "[", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "==", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "]"}], "&"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"\"\<m\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
         "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"\"\<A\>\"", ",", "j_"}], "]"}], "[", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{"0", "&"}], ")"}]}]}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948795012790942*^9, 3.948795068431231*^9}, {
  3.948795784393217*^9, 3.948795811094678*^9}, {3.948795866814065*^9, 
  3.948795881829441*^9}, {3.948796019825241*^9, 3.948796080826202*^9}, {
  3.948796937489439*^9, 3.9487969629184027`*^9}, {3.9500920760140057`*^9, 
  3.950092080814034*^9}, {3.950092190413892*^9, 3.950092190554639*^9}, {
  3.95009241991527*^9, 3.9500924990577927`*^9}, {3.950094983959054*^9, 
  3.95009498431035*^9}, {3.9500951815824747`*^9, 3.95009518209087*^9}, {
  3.950095618427767*^9, 3.95009561859648*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"66775e76-3592-4e09-8f1d-53f263866be9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary", "Section",
 CellChangeTimes->{
  3.941171673645897*^9, {3.941171930961037*^9, 
   3.941171934662931*^9}},ExpressionUUID->"104ef968-4dcf-48f5-ab6b-\
bb29d00f6f7b"],

Cell[TextData[{
 "We repeat this procedure with the boundary problem. We write the outer \
solution in terms of the signed distance coordinate system ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", ",", "s", ",", "r"}], TraditionalForm]],ExpressionUUID->
  "4de9f46d-7a12-498a-b839-a638299e7280"],
 ", while the inner unknown solution depends on the rescaled coordinates ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", ",", "s", ",", 
    FractionBox["r", "\[CurlyEpsilon]"]}], TraditionalForm]],ExpressionUUID->
  "9981f89a-20af-462c-b68e-aa5ac29b6fb3"],
 ". We automatically incorporate all the scaling factors of all derivatives "
}], "Text",
 CellChangeTimes->{{3.9414064494529037`*^9, 3.941406466403897*^9}, {
  3.9417909889663477`*^9, 
  3.941791048345932*^9}},ExpressionUUID->"0174e420-8157-423e-856a-\
d99329e4f38f"],

Cell[CellGroupData[{

Cell["\<\
Solve leading order flow equations to get leading order chemical potential\
\>", "Subsection",
 CellChangeTimes->{{3.94879849449438*^9, 3.948798500893518*^9}, {
  3.948799139595778*^9, 
  3.948799152329933*^9}},ExpressionUUID->"2ee32884-cf94-47cb-8194-\
0de44e84c085"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<flow\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Rho]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "#", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], "&"}], ")"}]}]}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Rho]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "#", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], "&"}], ")"}]}]}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"testing", " ", "at", " ", "infinity", " ", "for", " ", 
        RowBox[{"m", "[", 
         RowBox[{"\"\<A\>\"", ",", 
          RowBox[{"\[PlusMinus]", "1"}]}], "]"}]}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f_", "[", "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
           
           RowBox[{"(", 
            RowBox[{"0", "&"}], ")"}]}], ",", 
          RowBox[{"\[Theta]", "->", 
           RowBox[{"(", 
            RowBox[{"0", "&"}], ")"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f_", "[", "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
           
           RowBox[{"(", 
            RowBox[{"0", "&"}], ")"}]}], ",", 
          RowBox[{"\[Theta]", "->", 
           RowBox[{"(", 
            RowBox[{"1", "&"}], ")"}]}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", 
            "\[Infinity]"}], "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"#", ",", "\[Rho]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "1", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], ",", 
            RowBox[{
             RowBox[{"C", "[", "2", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", 
                RowBox[{"-", "1"}]}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
             RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", "1"}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
             RowBox[{"t", ",", "s", ",", "0"}], "]"}]}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"solving", " ", "at", " ", "interface", " ", "for", " ", 
        RowBox[{"m", "[", "\"\<B\>\"", "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}],
            "}"}], "]"}], "/.", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
           RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      "patternToFunction", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "\[IndentingNewLine]", "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948798909754086*^9, 3.948798973173212*^9}, {
   3.948799024075845*^9, 3.948799116818115*^9}, {3.950092513804543*^9, 
   3.950092587809366*^9}, {3.950092666294729*^9, 3.950092692716724*^9}, {
   3.9500927310151243`*^9, 3.9500928920367117`*^9}, {3.950092928670567*^9, 
   3.950092994802082*^9}, {3.950093043862811*^9, 3.950093064469792*^9}, {
   3.950093096598179*^9, 3.950093102687291*^9}, {3.950093152661825*^9, 
   3.9500933015178957`*^9}, 3.950093425673427*^9, {3.9500934594288797`*^9, 
   3.95009370277526*^9}, {3.950095330996821*^9, 3.9500953543651543`*^9}, {
   3.950095502389401*^9, 3.950095540796679*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"cd238cec-db41-4e46-ba01-7bd6a118f9e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Solve leading order chemical potential equations to get leading order \
concentration\
\>", "Subsection",
 CellChangeTimes->{{3.9487991572465353`*^9, 
  3.9487991741116543`*^9}},ExpressionUUID->"5732efd9-fdd4-4b73-90b2-\
7dcf475fe972"],

Cell["Deriving the equation for the leading order profile", "Text",
 CellChangeTimes->{{3.948800373319071*^9, 
  3.948800379940591*^9}},ExpressionUUID->"3d2daffc-b357-4b22-ac68-\
386ec198d025"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "'"}], "[", "0", "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "'"}], "[", 
       RowBox[{"1", "-", "x_"}], "]"}], ":>", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<m\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "}"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "+", 
         RowBox[{"dc", "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Rho]"], 
        RowBox[{"dc", "[", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "#"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
        "[", 
        RowBox[{"{", 
         RowBox[{"\"\<chem\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
         "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"f", "[", 
          RowBox[{"dc", "[", 
           RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[PartialD]", "\[Rho]"], 
            RowBox[{"dc", "[", 
             RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], ")"}], "2"]}], 
        "+", 
        RowBox[{"C", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", "-", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Rho]"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
           "[", 
           RowBox[{"{", 
            RowBox[{"\"\<chem\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", 
             "1"}], "}"}], "]"}], ")"}]}]}], "&"}]}], ",", 
     "\[IndentingNewLine]", "FullSimplify"}], "\[IndentingNewLine]", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9487991834996567`*^9, 3.948799249954002*^9}, {
   3.94879928321347*^9, 3.948799338513855*^9}, {3.948799382254525*^9, 
   3.948799405513324*^9}, {3.948799441295001*^9, 3.948799467842176*^9}, {
   3.948799513062608*^9, 3.948799521552992*^9}, {3.94879963953446*^9, 
   3.948799740155735*^9}, {3.948799799455687*^9, 3.948799846424941*^9}, {
   3.948799944698866*^9, 3.948799945329071*^9}, {3.9488000791283693`*^9, 
   3.948800158338192*^9}, {3.9488005581989727`*^9, 3.948800613160429*^9}, 
   3.9488006529245872`*^9, {3.9500937178258266`*^9, 3.950093722277162*^9}, {
   3.950093770459694*^9, 3.950093777919902*^9}, {3.950093921412423*^9, 
   3.9500939546796627`*^9}, {3.9500940943241987`*^9, 3.95009411765909*^9}, {
   3.950094594329454*^9, 3.950094612687509*^9}, {3.950094749854459*^9, 
   3.950094817156591*^9}, {3.950094962358405*^9, 3.9500949629605713`*^9}, 
   3.950095049098667*^9, {3.950095281436413*^9, 3.950095293418789*^9}, {
   3.9500955763103456`*^9, 3.950095628012897*^9}, {3.9500958403399067`*^9, 
   3.9500958412427197`*^9}, {3.9500958816761703`*^9, 
   3.9500958825083313`*^9}, {3.950095951140039*^9, 3.950095965297762*^9}, {
   3.9500960332858143`*^9, 3.95009608580086*^9}, {3.950096121757629*^9, 
   3.950096286310587*^9}, {3.950096320849457*^9, 3.950096351975322*^9}, {
   3.950096425242675*^9, 3.950096435796516*^9}, {3.950096702364605*^9, 
   3.950096703834732*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"98387373-97c3-47fd-8a23-0cc5022f6fda"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"substituting", " ", "infinity"}], "*)"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"dc", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", 
            RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}]}], ")"}]}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"f_", "[", "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Theta]", "->", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"f_", "[", "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Theta]", "->", 
          RowBox[{"(", 
           RowBox[{"1", "&"}], ")"}]}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{"C", "[", "1", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
         "[", 
         RowBox[{"{", 
          RowBox[{"\"\<chem\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "2"}], 
          "}"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<chem\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}],
            "}"}], "]"}], "/.", "#"}]}], ")"}], "&"}]}], 
    "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950096301230054*^9, 3.950096316346333*^9}, {
  3.9500963545970917`*^9, 3.950096358632228*^9}, {3.950096450875463*^9, 
  3.950096501272909*^9}, {3.950096537832034*^9, 3.950096644188575*^9}, {
  3.950096714648301*^9, 3.950096828545988*^9}, {3.950096992880134*^9, 
  3.9500969933603563`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"de3fb32c-c4f5-4c53-9b21-2c93b221be39"],

Cell[TextData[{
 "So we know that the constant of integration is zero.\nThe far field \
conditions for dc must have that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"dc", "[", 
      RowBox[{"\[PlusMinus]", "\[Infinity]"}], "]"}], "=", 
     RowBox[{"\[PlusMinus]", "1"}]}], ","}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bfe413c4-99b7-4a85-a5ff-da078a03e232"]
}], "Text",
 CellChangeTimes->{{3.9500966870877733`*^9, 3.950096694767358*^9}, {
  3.9500968650259657`*^9, 3.950096874898527*^9}, {3.950096934854848*^9, 
  3.950096947202704*^9}, {3.950097010667997*^9, 
  3.950097027974876*^9}},ExpressionUUID->"cdf2ce8d-7f6f-4b81-add7-\
42d2a3a68a7b"],

Cell["\<\
This is an integrable equation (that is, it is a total differential, so we \
integrate it)\
\>", "Text",
 CellChangeTimes->{{3.94880038656441*^9, 
  3.948800406317853*^9}},ExpressionUUID->"3399224e-0c7b-4cb8-a5cd-\
bc221ba14dcf"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "2"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DSolve", "[", 
       RowBox[{
        RowBox[{"#", "==", "0"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], ",", "\[Rho]"}], 
       "]"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<dc\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"C", "[", "1", "]"}], "->", "0"}], ",", "\[IndentingNewLine]", 
     "FullSimplify", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<dc\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
          "}"}], "]"}], "=", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], "&"}]}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.950096808465053*^9, 3.950096851121573*^9}, {
  3.950097040276657*^9, 3.9500971392840967`*^9}, {3.950097400835837*^9, 
  3.950097411035342*^9}, {3.950097568296536*^9, 3.950097593792614*^9}, {
  3.950097637615052*^9, 3.950097638294475*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"245ab6db-c185-409b-9b8d-5c31da28d2d7"],

Cell["\<\
This is the simplest ODE to solve for the leading order profile\
\>", "Text",
 CellChangeTimes->{{3.9488004099755173`*^9, 
  3.948800420817388*^9}},ExpressionUUID->"e6627e1d-b03e-4649-b0b6-\
b3506ff73a03"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<dc\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"dc", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", 
            RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}]}], ")"}]}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Theta]\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], "=", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"Function", "[", 
        RowBox[{"\[Rho]", ",", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tanh", "[", 
             FractionBox["\[Rho]", "2"], "]"}], "+", "1"}], ")"}]}]}], 
        "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     "patternToFunction", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "=", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.950097542749257*^9, 3.950097560154999*^9}, {
  3.950097607517617*^9, 3.9500977782627287`*^9}, {3.9500978208167267`*^9, 
  3.950097822092905*^9}, {3.950148774500331*^9, 3.950148836926372*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"d9f8906e-61e2-42ab-825a-0cf6384e5ca1"],

Cell["\<\
Let\[CloseCurlyQuote]s save these identities, they will be useful for \
performing coordinate transforms.\
\>", "Text",
 CellChangeTimes->{{3.948860758635807*^9, 
  3.9488607720455227`*^9}},ExpressionUUID->"0f843082-0518-4742-80ca-\
864ed12e4a1d"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "2"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dc", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", 
            RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}]}], ")"}]}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "\[Rho]", "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", "FullSimplify", ",", "\[IndentingNewLine]", 
     "PowerExpand", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Theta]'\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
    "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.950097856879067*^9, 3.950098031038699*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"2bf0f692-514f-4184-a16c-3db0fd4f2a97"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]'\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Rho]"], "#"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<\[Theta]'\>\"", ",", "\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", "FullSimplify", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Theta]''\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Rho]"], "#"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<\[Theta]'\>\"", ",", "\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", "FullSimplify", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Theta]'''\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950098038604726*^9, 3.950098064430099*^9}, {
  3.950149074904604*^9, 3.950149153506262*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"ae289d6e-55ce-4e77-97a6-1f26d74dc0a4"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "First order terms ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["\[CurlyEpsilon]", "1"], ")"}], TraditionalForm]],
  ExpressionUUID->"3e78aee8-5f87-4f84-962d-2bc6f9e2e1ed"]
}], "Chapter",
 CellChangeTimes->{{3.941278135721281*^9, 3.941278139360862*^9}, {
  3.9488577291918993`*^9, 3.948857732675029*^9}, {3.948858607347252*^9, 
  3.948858615788837*^9}},ExpressionUUID->"292eb54d-16b9-43a1-a5f1-\
843a78773e20"],

Cell[CellGroupData[{

Cell["Area", "Section",
 CellChangeTimes->{{3.9411707914691772`*^9, 
  3.9411707918233156`*^9}},ExpressionUUID->"81804c53-844c-4742-9e57-\
d424ee990482"],

Cell[CellGroupData[{

Cell["Calculating the first order evolution equation", "Subsection",
 CellChangeTimes->{{3.9467054219986553`*^9, 3.946705428837923*^9}, {
  3.948800893064719*^9, 
  3.948800899272604*^9}},ExpressionUUID->"221676dd-5445-4adf-be90-\
ac008a6bb214"],

Cell["Using the previously derived equations", "Text",
 CellChangeTimes->{{3.948800865778965*^9, 
  3.948800871158978*^9}},ExpressionUUID->"6edc0ed4-0ab2-4b15-9134-\
92d355abd764"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<flow\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], 
         "[", 
         RowBox[{"{", 
          RowBox[{"\"\<flow\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948800696529963*^9, 3.948800817421824*^9}, {
  3.950098104545066*^9, 3.950098172157467*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"51a87db2-ad33-46dc-a7c1-19aef555a03b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculating the first order chemical potential equation", "Subsection",
 CellChangeTimes->{{3.950098240676922*^9, 
  3.9500982461148033`*^9}},ExpressionUUID->"9b66a3fa-1e3a-4b8c-a958-\
059beb516235"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], 
         "[", 
         RowBox[{"{", 
          RowBox[{"\"\<chem\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", "->", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", "->", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"\"\<A\>\"", ",", "1"}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
            RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
            RowBox[{"t", ",", "x", ",", "y"}], "]"}]}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     "patternToFunction", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<c\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.9500982335956173`*^9, {3.950098264049168*^9, 3.950098270836505*^9}, {
   3.950098340580124*^9, 3.950098446825141*^9}, {3.950098479404253*^9, 
   3.950098539093614*^9}, {3.9501481301730423`*^9, 3.950148131636994*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"79d33223-68f2-4b06-bb3a-8ab12b2ffcf1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary", "Section",
 CellChangeTimes->{{3.946480836325447*^9, 
  3.946480837020831*^9}},ExpressionUUID->"1161b4e0-d307-4e83-be62-\
e09824fa2dca"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["flow", 
    RowBox[{"i", ",", "1"}], 
    SubscriptBox["B", "j"]], TraditionalForm]],ExpressionUUID->
  "053e2078-2408-497b-9bba-ecf775d825c3"],
 ": \nSimplifying the first order flow equation\nMatching terms at infinity \
for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["m", "1", 
     SubscriptBox["A", "j"]], "@", 
    SubscriptBox["B", "j"]}], TraditionalForm]],ExpressionUUID->
  "975fbf0e-8661-4a90-86a5-37baee24e6eb"],
 "\nSolving for ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["m", "1", "B"], TraditionalForm]],ExpressionUUID->
  "498556f4-4732-41fb-9373-f234b9e4dbe3"]
}], "Subsection",
 CellChangeTimes->{{3.946705492416457*^9, 3.946705500233686*^9}, {
   3.948801502657048*^9, 3.9488015124426727`*^9}, {3.948857761935644*^9, 
   3.948857764791325*^9}, {3.948858099977401*^9, 3.948858112816957*^9}, {
   3.950147045557192*^9, 3.950147117629237*^9}, 
   3.950172217531296*^9},ExpressionUUID->"abfe3f30-e498-4f76-a08a-\
6cd0f8f78d7f"],

Cell["From the previous calculation", "Text",
 CellChangeTimes->{{3.9488015151591463`*^9, 
  3.948801518008561*^9}},ExpressionUUID->"2879db80-39b4-4b0c-866d-\
e5c4f0715401"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"\"\<flow\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"4a8674c1-17c4-49d8-b20f-484c7f863d0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<flow\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "substituting", " ", "known", " ", "solutions", " ", "from", " ", 
       "higher", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Integrating", "/", "solving"}], " ", "the", " ", "equation", 
        " ", "for", " ", 
        RowBox[{
         RowBox[{"m", "[", "\"\<B\>\"", "]"}], "[", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Rho]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "#", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], "&"}], ")"}]}]}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Rho]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "#", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], "&"}], ")"}]}]}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"testing", " ", "at", " ", "infinity", " ", "for", " ", 
        RowBox[{"m", "[", 
         RowBox[{"\"\<A\>\"", ",", 
          RowBox[{"\[PlusMinus]", "1"}]}], "]"}]}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f_", "[", "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
           
           RowBox[{"(", 
            RowBox[{"0", "&"}], ")"}]}], ",", 
          RowBox[{"\[Theta]", "->", 
           RowBox[{"(", 
            RowBox[{"0", "&"}], ")"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f_", "[", "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
           
           RowBox[{"(", 
            RowBox[{"0", "&"}], ")"}]}], ",", 
          RowBox[{"\[Theta]", "->", 
           RowBox[{"(", 
            RowBox[{"1", "&"}], ")"}]}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", 
            "\[Infinity]"}], "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"#", ",", "\[Rho]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"C", "[", "1", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], ",", 
            RowBox[{
             RowBox[{"C", "[", "2", "]"}], "[", 
             RowBox[{"t", ",", "s"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", 
                RowBox[{"-", "1"}]}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
             RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", "1"}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
             RowBox[{"t", ",", "s", ",", "0"}], "]"}]}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"solving", " ", "at", " ", "interface", " ", "for", " ", 
        RowBox[{"m", "[", "\"\<B\>\"", "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}],
            "}"}], "]"}], "/.", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
           RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      "patternToFunction", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "\[IndentingNewLine]", "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948801831948248*^9, 3.948801855074016*^9}, {
   3.95009855406214*^9, 3.950098628650448*^9}, {3.950098808467145*^9, 
   3.950098812652155*^9}, {3.950098863838724*^9, 3.950099029479281*^9}, 
   3.9500990676651487`*^9, {3.950117876103775*^9, 3.950117878204996*^9}, {
   3.9501180127551126`*^9, 3.9501180756158543`*^9}, {3.950118126266671*^9, 
   3.950118169590417*^9}, {3.950147135846634*^9, 3.950147171797371*^9}, 
   3.950161019358214*^9, {3.9501610702851954`*^9, 3.950161073301593*^9}, {
   3.950161115081436*^9, 3.95016111710781*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"3c306f5c-d9a4-4a4b-ad0e-9169b1b3136c"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["chem", "1", "B"], TraditionalForm]],ExpressionUUID->
  "af1cf8de-635a-4618-951a-c96b176b71cd"],
 ": Calculating the first order chemical potential equation"
}], "Subsection",
 CellChangeTimes->{{3.946705511086089*^9, 3.9467055136368837`*^9}, {
  3.948801919093294*^9, 3.948801923565778*^9}, {3.948858128560903*^9, 
  3.9488581398800077`*^9}, {3.950147220311132*^9, 
  3.9501472242117863`*^9}},ExpressionUUID->"38269a39-a3e9-41ea-87d5-\
ab2658cb081a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "//", "Keys"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9501472721790457`*^9, 3.950147276715695*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"9ff419a9-8e82-4437-aa5c-f4ae17c82021"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Theta]'\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", "FullSimplify", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
            RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "}"}]}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", "printReturn", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"simplified", " ", "the", " ", "equation"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<chem\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "no", " ", "far", " ", "field", " ", "behaviour", " ", "to", " ", 
       "solve"}], "*)"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948801536181758*^9, 3.948801539750732*^9}, {
   3.948801708316328*^9, 3.948801721097898*^9}, {3.948801797792857*^9, 
   3.9488018271886797`*^9}, {3.948801945810707*^9, 3.948802025359845*^9}, {
   3.95014724108438*^9, 3.950147257994994*^9}, {3.9501475592410583`*^9, 
   3.950147620846448*^9}, {3.95014774188826*^9, 3.9501478028315563`*^9}, {
   3.950147837547905*^9, 3.950147922822013*^9}, 3.950147955869226*^9, {
   3.950148018084178*^9, 3.950148055652492*^9}, {3.950148089964932*^9, 
   3.950148090219882*^9}, {3.950148151062516*^9, 3.950148169076407*^9}, {
   3.95014821487176*^9, 3.950148215866849*^9}, {3.9501482607334213`*^9, 
   3.950148261061639*^9}, {3.950148308662838*^9, 3.950148334700777*^9}, 
   3.9501483702546797`*^9, {3.950148935248549*^9, 3.950148954110325*^9}, {
   3.950148999038456*^9, 3.950149049798376*^9}, 3.950149247693849*^9, {
   3.950149287513088*^9, 3.950149411494934*^9}, {3.9501496282009907`*^9, 
   3.950149636024968*^9}, {3.950149784873611*^9, 3.950149786602995*^9}, {
   3.950149957619362*^9, 3.950149967926362*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"bc911d70-bfa8-41c4-9e8e-c80aff9210e3"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"L", ":"}], TraditionalForm]],ExpressionUUID->
  "0f47276f-8446-4b3b-bb51-f3817880c715"],
 " Understanding the new linear operator"
}], "Subsection",
 CellChangeTimes->{{3.9488594439407263`*^9, 3.948859458120919*^9}, {
  3.948859695661133*^9, 3.948859695795753*^9}, {3.9501495234240303`*^9, 
  3.950149531446558*^9}},ExpressionUUID->"5fc82c13-1517-41c9-ae33-\
ff148ff329a7"],

Cell["\<\
We have transformed our variable definitions in order to diagonalise the \
boundary equations to a pair of well-defined Sturm-Liouville operators.
Next, we want to \[OpenCurlyDoubleQuote]solve\[CloseCurlyDoubleQuote] those \
operators by transforming our coordinates.\
\>", "Text",
 CellChangeTimes->{{3.9488601185614433`*^9, 
  3.948860208432376*^9}},ExpressionUUID->"30c0a713-7784-49d4-af5d-\
de72f3e2526b"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s transform the perturbed operator weighted \
eigenproblem to ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]],ExpressionUUID->
  "fe496091-dd7e-497a-b7c0-040ae331ccff"],
 " coordinates, and do some further transformations to turn it into the \
standard hypergeometric equation"
}], "Text",
 CellChangeTimes->{{3.948860214352695*^9, 3.948860229766721*^9}, {
  3.9488615236363993`*^9, 3.948861557747979*^9}, {3.94886159776476*^9, 
  3.948861601627984*^9}, {3.948861633604076*^9, 
  3.948861643075247*^9}},ExpressionUUID->"7e6b40cb-4dac-4ba7-a057-\
884af49ae373"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<\[Theta]\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]'\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<\[Theta]''\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]''\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<\[Theta]'''\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]'''\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.95017236094692*^9, 3.9501723744639387`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"4e88bd45-5673-4045-9a53-e6cdc9569734"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", "u", "]"}], "-", 
     RowBox[{"\[Lambda]", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "\[Rho]", "]"}], "u"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "->", 
       RowBox[{"u", "[", "\[Rho]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", "\"\<L\[Rho]\>\"", 
        "]"}], "=", 
       RowBox[{
        RowBox[{"L", "[", "x_", "]"}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"f", "''"}], "[", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "-", "1"}], "]"}], 
          "x"}], "-", 
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"{", 
            RowBox[{"\[Rho]", ",", "2"}], "}"}]], "x"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "FullSimplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"printReturn", "[", 
        RowBox[{"#", ",", "\"\<\!\(\*Cell[TextData[{
Cell[BoxData[FormBox[\"L\", \
TraditionalForm]],ExpressionUUID->\"c13c6619-404f-4796-9be1-e7b4f1ef4afb\"],
\"[u(\[Rho])]\"
}],ExpressionUUID->\"ae611df1-4734-47d2-851c-4572e23a86e1\"]\)\>\""}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<L\[Rho]\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"u", "->", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{"v", "[", 
          RowBox[{"\[Theta]", "[", "x", "]"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Theta]''\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "\[Theta]"}], ",", 
      "\[IndentingNewLine]", "FullSimplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"printReturn", "[", 
        RowBox[{"#", ",", "\"\<\!\(\*Cell[TextData[{
Cell[BoxData[FormBox[\"L\", \
TraditionalForm]],ExpressionUUID->\"6ae67337-08e6-4133-896b-299a4cc94c80\"],
\"[v(\[Theta])]\"
}],ExpressionUUID->\"d5b8f3ae-6ed3-4f41-9e3b-a89ca97b3f4e\"]\)\>\""}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<L\[Theta]\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "->", 
       RowBox[{"Function", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"\[Theta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Theta]"}], ")"}], 
          RowBox[{"w", "[", "\[Theta]", "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["#", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Theta]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Theta]"}], ")"}]}], ")"}], "2"]], "&"}], ",",
       "\[IndentingNewLine]", "FullSimplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"printReturn", "[", 
        RowBox[{"#", ",", "\"\<\!\(\*Cell[TextData[Cell[BoxData[FormBox[
FractionBox[RowBox[{\"L\", \"[\", RowBox[{RowBox[{\"\[Theta]\", \"(\", \
RowBox[{\"1\", \"-\", \"\[Theta]\"}], \")\"}], RowBox[{\"w\", \"(\", \"\
\[Theta]\", \")\"}]}], \"]\"}], 
SuperscriptBox[RowBox[{
SuperscriptBox[\"\[Theta]\", \"2\"], \"(\", RowBox[{\"1\", \"-\", \
\"\[Theta]\"}], \")\"}], \"2\"]], \
TraditionalForm]],ExpressionUUID->\"1bad51d5-4d35-44c6-a203-3f2963b80d5d\"]],\
ExpressionUUID->\"7a5fc69e-56dd-407b-b26e-308c188875ee\"]\)\>\""}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<L'\[Theta]\>\"", "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"w", "->", 
       RowBox[{"Function", "[", 
        RowBox[{"t", ",", 
         RowBox[{"z", "[", 
          RowBox[{"x", "[", "t", "]"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "->", 
       RowBox[{"Function", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"2", "t"}], "-", "1"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "->", 
       FractionBox[
        RowBox[{"x", "+", "1"}], "2"]}], ",", "\[IndentingNewLine]", 
      "FullSimplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"printReturn", "[", 
        RowBox[{"#", ",", "\"\<\!\(\*Cell[TextData[Cell[BoxData[FormBox[
FractionBox[RowBox[{\"L\", \"[\", RowBox[{RowBox[{\"\[Theta]\", \"(\", \
RowBox[{\"1\", \"-\", \"\[Theta]\"}], \")\"}], RowBox[{\"z\", \"(\", \
RowBox[{RowBox[{\"2\", \"\[Theta]\"}], \"-\", \"1\"}], \")\"}]}], \"]\"}], 
SuperscriptBox[RowBox[{
SuperscriptBox[\"\[Theta]\", \"2\"], \"(\", RowBox[{\"1\", \"-\", \
\"\[Theta]\"}], \")\"}], \"2\"]], \
TraditionalForm]],ExpressionUUID->\"b4aa86eb-1104-423b-a2d7-2b2b1444b84c\"]],\
ExpressionUUID->\"f381589c-b3f1-4041-bbd5-b1647e1a32cb\"]\)\>\""}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", "\"\<L'x\>\"", "]"}], "=", "#"}], ")"}], "&"}], ","}], 
     "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948860255610173*^9, 3.948860324724986*^9}, {
   3.948860373931408*^9, 3.948860501687326*^9}, {3.948860561362905*^9, 
   3.948860587430904*^9}, {3.948860894842955*^9, 3.948860916410637*^9}, {
   3.94886106259473*^9, 3.9488611148858137`*^9}, {3.948861283754058*^9, 
   3.948861379127219*^9}, {3.9488636259616127`*^9, 3.948863706946979*^9}, {
   3.948868026061537*^9, 3.948868054223509*^9}, {3.94886816362118*^9, 
   3.948868176828711*^9}, 3.948868207367625*^9, {3.948868252053048*^9, 
   3.948868276061365*^9}, {3.948868471609737*^9, 3.948868518493527*^9}, {
   3.948868573675268*^9, 3.948868665848041*^9}, 3.948868773868464*^9, {
   3.9488688686783953`*^9, 3.948868893266321*^9}, {3.9488691515682583`*^9, 
   3.9488691537233953`*^9}, {3.948869315199793*^9, 3.948869315587826*^9}, {
   3.948869411228446*^9, 3.94886941377887*^9}, {3.95014980692701*^9, 
   3.950149917385582*^9}, {3.95015005162162*^9, 3.9501500528658867`*^9}, {
   3.9501501722801523`*^9, 3.950150173197155*^9}, {3.950150249390633*^9, 
   3.950150421625608*^9}, {3.950150456945854*^9, 3.9501504740747766`*^9}, {
   3.95015050898873*^9, 3.950150530966062*^9}, {3.950153404206184*^9, 
   3.950153420213841*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"a7151ba2-b27f-486c-9a15-2a92253f0525"],

Cell["\<\
We have some old identities that solve the unperturbed linear operator via \
factorisation\
\>", "Text",
 CellChangeTimes->{{3.9488622450952597`*^9, 
  3.948862271083046*^9}},ExpressionUUID->"5db5bd80-26dd-4a91-9d3d-\
680f02e76df3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
  "\"\<L\[Rho]\>\"", "]"}]], "Input",
 CellChangeTimes->{3.950150643009286*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"ef9c3a45-fdca-4695-b66c-c58562834498"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
   "\"\<Lf\[Rho]\>\"", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f", "''"}], "[", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "-", "1"}], "]"}], 
    RowBox[{"u", "[", "\[Rho]", "]"}]}], "-", 
   RowBox[{
    SubscriptBox["\[PartialD]", 
     RowBox[{"{", 
      RowBox[{"\[Rho]", ",", "2"}], "}"}]], 
    RowBox[{"u", "[", "\[Rho]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.950150602745276*^9, 3.950150653746004*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"5158348b-b7b0-4cf5-a5b6-635682667e2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<g\>\"", "]"}], "=", 
   RowBox[{"g", "->", 
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["x", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "2"]}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.950150760276847*^9, 3.950150765385124*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"a605b2ca-a512-4a13-b79a-b840bacef4af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "''"}], "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "-", "1"}], "]"}], "-", 
     RowBox[{
      RowBox[{"g", "''"}], "[", 
      RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "]"}]}], "/.", 
    RowBox[{"rs", "[", "\"\<f\>\"", "]"}]}], "/.", 
   RowBox[{"rs", "[", "\"\<g\>\"", "]"}]}], "//", "Simplify"}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"25c99bde-bbe6-4884-9c7d-3d77ec4a5e21"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<Lg\[Rho]\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "''"}], "[", 
      RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "]"}], 
     RowBox[{"u", "[", "\[Rho]", "]"}]}], "-", 
    RowBox[{
     SubscriptBox["\[PartialD]", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", "2"}], "}"}]], 
     RowBox[{"u", "[", "\[Rho]", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950150777322577*^9, 3.9501507863206367`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"bac4091d-df79-4794-868d-5eee0633aacb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<Lg\[Rho]2\>\"", "]"}], "=", 
   RowBox[{"Hold", "[", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       SuperscriptBox[
        RowBox[{"g", "[", 
         RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "]"}], 
        RowBox[{"1", "/", "2"}]]], 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "]"}], 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Rho]"], 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"u", "[", "\[Rho]", "]"}], 
            SuperscriptBox[
             RowBox[{"g", "[", 
              RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "]"}], 
             RowBox[{"1", "/", "2"}]]], ")"}]}]}], ")"}]}]}], ")"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9501509532669487`*^9, 3.9501509615867033`*^9}, {
  3.950152371190744*^9, 3.950152372671418*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"d54f0a9f-6d7c-430f-b646-cdfb9b8fbb7a"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     "\"\<Lg\[Rho]\>\"", "]"}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     "\"\<Lg\[Rho]2\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ReleaseHold", ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<g\>\"", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]''\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "Simplify"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.929720880116392*^9, 3.929720927912541*^9}, {
   3.92972114011831*^9, 3.929721217612969*^9}, {3.929721318155018*^9, 
   3.929721420949122*^9}, {3.929721633940404*^9, 3.929721667690834*^9}, {
   3.9488217446160927`*^9, 3.9488217560995493`*^9}, {3.950150538274674*^9, 
   3.9501505858493137`*^9}, {3.950150668037209*^9, 3.950150668897843*^9}, {
   3.950150819226869*^9, 3.950150930830428*^9}, 3.95015098509403*^9, 
   3.950151607147244*^9, {3.950152379142975*^9, 3.950152380254384*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"987ebfb2-0320-44e6-9159-eaff99ff82fd"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<Lg\[Rho]2\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", "[", "\[Rho]", "]"}], "->", 
      RowBox[{"v", "[", 
       RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Rho]"], 
          RowBox[{"(", "f_", ")"}]}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]", "'"}], "[", "\[Rho]", "]"}], " ", 
          RowBox[{"d\[Theta]", "[", "f", "]"}]}], ")"}]}], ",", 
       "\"\<Repeat\>\""}], "}"}], ",", "\[IndentingNewLine]", "ReleaseHold", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "\[Theta]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", "\[Theta]", "]"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", "\[Theta]", "]"}], "/.", 
        RowBox[{"rs", "[", "\"\<g\>\"", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"d\[Theta]", "[", 
         RowBox[{
          RowBox[{"a_", "?", 
           RowBox[{"(", 
            RowBox[{"FreeQ", "[", "\[Theta]", "]"}], ")"}]}], "b_"}], "]"}], ":>", 
        RowBox[{"a", " ", 
         RowBox[{"d\[Theta]", "[", "b", "]"}]}]}], ",", "\"\<Repeat\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", "PowerExpand", ",", 
     "\[IndentingNewLine]", "FullSimplify", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Hold", "[", 
       RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"d\[Theta]", "[", "x_", "]"}], ":>", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Theta]"], 
         RowBox[{"(", "x", ")"}]}]}], ",", "\"\<Repeat\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
         "[", "\"\<Lg\[Theta]\>\"", "]"}], "=", "#"}], ")"}], "&"}]}], 
    "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950151609543679*^9, 3.9501516385757427`*^9}, {
  3.950152289746579*^9, 3.950152347432044*^9}, {3.95015243896686*^9, 
  3.9501525022154512`*^9}, {3.9501525383759193`*^9, 3.950152727840809*^9}, {
  3.9501527595044613`*^9, 3.950152908066478*^9}, {3.950152970617568*^9, 
  3.950153044017288*^9}, {3.950153084777753*^9, 3.9501531189538927`*^9}, {
  3.9501531731808*^9, 3.950153189433712*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"6fa6296e-175c-4134-9997-bf7e76fa08c6"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<Lg\[Theta]\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
    "ReleaseHold", ",", "\[IndentingNewLine]", "Simplify", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "-", 
       RowBox[{
        RowBox[{
         RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
        "[", "\"\<L\[Theta]\>\"", "]"}]}], "&"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"\[Lambda]", "->", "0"}], ",", "\[IndentingNewLine]", 
     "Simplify"}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950153268868287*^9, 3.950153273355544*^9}, {
  3.950153303949589*^9, 3.9501533444058847`*^9}, {3.950153452866975*^9, 
  3.950153466588081*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"16f5d7e8-98e2-45f3-9549-49bd17d159e0"],

Cell["\<\
This gives us an alternate way to solve this operator against any RHS.

I wonder if this factorisation must be useful in a numerical implementation...\
\>", "Text",
 CellChangeTimes->{{3.950150995554863*^9, 3.9501510079304113`*^9}, {
  3.950151052986815*^9, 3.950151068962802*^9}, {3.9501534805708723`*^9, 
  3.950153483339528*^9}},ExpressionUUID->"a8650f76-513e-47dc-a5c9-\
30dc1e87c708"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving the weighted eigenproblem", "Subsection",
 CellChangeTimes->{{3.948861969297291*^9, 
  3.9488619775123463`*^9}},ExpressionUUID->"05ae97e9-dfa8-4e22-8a7e-\
935c3855a6cc"],

Cell["\<\
We\[CloseCurlyQuote]ll first determine possible eigenvalues by solving a \
recurrence relation assuming a polynomial solution\
\>", "Text",
 CellChangeTimes->{{3.948861721978607*^9, 
  3.9488617576906157`*^9}},ExpressionUUID->"bba283f7-9a5c-40d5-a30b-\
b6bc6d5f79e0"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<L'\[Theta]\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "->", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["#", "n"], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
     "Expand", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["\[Theta]", "n"], ",", 
          SuperscriptBox["\[Theta]", 
           RowBox[{"n", "-", "1"}]]}], "}"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Theta]", "n"], "->", 
        SuperscriptBox["\[Theta]", "6"]}], ",", 
       RowBox[{
        SuperscriptBox["\[Theta]", 
         RowBox[{"n", "-", "1"}]], "->", 
        SuperscriptBox["\[Theta]", "5"]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"#", ",", 
        SuperscriptBox["\[Theta]", "6"]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", "\[Lambda]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "->", 
      RowBox[{"\[Lambda]", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         "\"\<L':\[Lambda]\>\"", "]"}], "=", "#"}], ")"}], "&"}]}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.948861760773612*^9, 3.948861804180421*^9}, {
  3.9488618643777657`*^9, 3.948861955770665*^9}, {3.9488620000825853`*^9, 
  3.9488620177212143`*^9}, {3.9488621310968847`*^9, 3.948862186016327*^9}, {
  3.950153523742537*^9, 3.950153538972883*^9}, {3.950163538233714*^9, 
  3.9501635395337143`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"a4ff257f-a9dc-4100-874e-b3c8179562f5"],

Cell["\<\
We could also transform this hypergeometric equation to the form of the \
standard Jacobi polynomial differential equation\
\>", "Text",
 CellChangeTimes->{{3.9488622053140793`*^9, 3.9488622262555237`*^9}, {
  3.948862670684333*^9, 
  3.948862696690816*^9}},ExpressionUUID->"b4da65d5-0252-4222-869d-\
4f0a75249021"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<Jacobi\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}], ")"}], 
     RowBox[{
      RowBox[{"z", "''"}], "[", "x", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "a", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", "2"}], ")"}], "x"}]}], ")"}], 
     RowBox[{
      RowBox[{"z", "'"}], "[", "x", "]"}]}], "+", 
    RowBox[{"n", 
     RowBox[{"(", 
      RowBox[{"n", "+", "a", "+", "b", "+", "1"}], ")"}], 
     RowBox[{"z", "[", "x", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.929780127465034*^9, 3.929780138168283*^9}, {
  3.9300824964814987`*^9, 3.930082502500866*^9}, {3.948862827971657*^9, 
  3.948862833075323*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"02b0cd0e-4f6b-4580-969e-ecd5e38b2124"],

Cell["\<\
Now we figure out which specific Jacobi polynomials our solutions correspond \
to\
\>", "Text",
 CellChangeTimes->{{3.948863049665811*^9, 
  3.9488630678084583`*^9}},ExpressionUUID->"f7ca2445-b5b9-4c5f-96d4-\
3311ee2561d9"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     "\"\<L'x\>\"", "]"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     "\"\<Jacobi\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"Simplify", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"z", "[", "x", "]"}], ",", 
          RowBox[{
           RowBox[{"z", "'"}], "[", "x", "]"}]}], "}"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", "Flatten", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"#", "===", "0"}], "]"}], "&"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "\[Lambda]"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", "\"\<L'Jacobi\>\"", 
         "]"}], "=", "#"}], ")"}], "&"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948862885529652*^9, 3.948862890017599*^9}, {
  3.9488629355632057`*^9, 3.948863039546331*^9}, {3.948863284585464*^9, 
  3.948863303889333*^9}, {3.9501595258429327`*^9, 3.950159550062578*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"6d836220-d5d6-420b-808f-8f5c5e7a44da"],

Cell["Now let\[CloseCurlyQuote]s verify we\[CloseCurlyQuote]ve solved the \
eigenvalue problem", "Text",
 CellChangeTimes->{{3.948863204135972*^9, 
  3.948863213672041*^9}},ExpressionUUID->"21ddd1c4-d0ca-4970-826a-\
c91988c2ab4c"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<L'x\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "->", 
      RowBox[{"Function", "[", 
       RowBox[{"x", ",", 
        RowBox[{"JacobiP", "[", 
         RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", "\"\<L'Jacobi\>\"", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"n", "->", "5"}], ",", "\[IndentingNewLine]", "Simplify"}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9488632163002043`*^9, 3.9488632724724293`*^9}, {
  3.948863324311255*^9, 3.9488633842872*^9}, {3.948863422472908*^9, 
  3.9488634278711367`*^9}, {3.950159510721301*^9, 3.950159515336555*^9}, {
  3.950159555751939*^9, 3.950159555989668*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"be492992-d30b-4761-9c7c-972aa685a082"],

Cell["And let\[CloseCurlyQuote]s verify this in our original context", "Text",
 CellChangeTimes->{{3.948863442055509*^9, 
  3.948863452968902*^9}},ExpressionUUID->"57bd6f3b-f407-4ce5-8363-\
62b6fdebfd5e"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    "\"\<L\[Rho]\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "->", 
      RowBox[{"Function", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], ")"}], 
         RowBox[{"JacobiP", "[", 
          RowBox[{"n", ",", "a", ",", "b", ",", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "-", "1"}]}], 
          "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", "\"\<L'Jacobi\>\"", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]''\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "->", "5"}], ",", "\[IndentingNewLine]", "Simplify"}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.94886374510747*^9, 3.948863747768743*^9}, {
   3.948863821794631*^9, 3.9488638360896053`*^9}, {3.948863882808475*^9, 
   3.948864000669508*^9}, 3.950153562270754*^9, {3.950169537808896*^9, 
   3.95016954022265*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"29d36107-5b04-477c-bea0-5ec5053f66f0"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["BC", "1", 
    SubscriptBox["B", "j"]], TraditionalForm]],ExpressionUUID->
  "328cac93-1fd6-4e2c-bb51-641f48b93e0c"],
 ": Calculating the solvability condition of the first equation"
}], "Subsection",
 CellChangeTimes->{{3.946558966739393*^9, 3.946558974541888*^9}, {
  3.948858273462824*^9, 
  3.948858295989543*^9}},ExpressionUUID->"a69eaac0-5720-4db9-8c54-\
6d77377e0380"],

Cell[TextData[{
 "Take the expression, isolate the inhomogeneous part (filter out ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "[", "x", "]"}], TraditionalForm]],ExpressionUUID->
  "a8dc797c-32c7-4a40-8c06-e5d4dba785b6"],
 " terms), then change coordinates to ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]],ExpressionUUID->
  "99f55bac-8026-4a09-8d95-0962ddf5e5dd"],
 ", then perform an integration in ",
 Cell[BoxData[
  FormBox["d\[Theta]", TraditionalForm]],ExpressionUUID->
  "0206ddd6-7613-4baa-ad98-4c2d27c85b54"],
 ", which conveniently absorbs/deletes the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "'"}], TraditionalForm]],ExpressionUUID->
  "d74b67d9-b9c2-4a30-98b9-35709d7b76c7"],
 " cokernel element that we are taking the inner product with for our \
solvability condition"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.948780102200486*^9, 3.9487801498647346`*^9}, {
  3.9487802248068867`*^9, 
  3.9487802569732313`*^9}},ExpressionUUID->"9c734d65-904d-457b-bf1c-\
813dd2ff097c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"\"\<chem\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.950153683840029*^9, 3.950153684076373*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"6088f7c0-b8ca-4641-bc50-e67421a1bcf5"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "->", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"f", "''"}], "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "-", "1"}], "]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "-", 
       RowBox[{"L", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
         RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "Expand", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"List", "@@", "#"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"L", "[", "a__", "]"}]}], "]"}], "&"}]}], "]"}], "&"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Plus", "@@", "#"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
     "FullSimplify", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Integrating", " ", Cell[
       "\[Integral]f\[Theta]'d\[Rho]=\[Integral]fd\[Theta]",ExpressionUUID->
        "2c40d684-10fe-4812-b9de-c36aa8006a2e"]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "\[Theta]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
         "[", 
         RowBox[{"{", 
          RowBox[{"\"\<sol\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<m\>\"", ",", "1"}], "}"}], ",", "0"}], "}"}], "]"}], 
        "=", "#"}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"\"\<A\>\"", ",", 
              RowBox[{"-", "1"}]}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
           RowBox[{"t", ",", "s", ",", "0"}], "]"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], 
          "}"}], "]"}], "=", "#"}], ")"}], "&"}], ","}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.948779847540926*^9, 3.9487798904147787`*^9}, {
   3.9487799357199306`*^9, 3.9487800756436663`*^9}, {3.948793593826434*^9, 
   3.9487935958934927`*^9}, {3.948793704768228*^9, 3.948793708637344*^9}, {
   3.948793763381715*^9, 3.948793828451119*^9}, {3.948793859619749*^9, 
   3.948793863090899*^9}, {3.9488026682851133`*^9, 3.94880267704548*^9}, {
   3.9488028494763327`*^9, 3.948802856494664*^9}, {3.948803161213689*^9, 
   3.9488032292772083`*^9}, {3.948803287168384*^9, 3.948803298308681*^9}, {
   3.94880363735507*^9, 3.948803672997518*^9}, {3.95015367684759*^9, 
   3.950153677999743*^9}, {3.950153735303438*^9, 3.950153786383031*^9}, {
   3.9501538190950003`*^9, 3.950153862976287*^9}, {3.9501538970251703`*^9, 
   3.9501540069681463`*^9}, {3.950154038256517*^9, 3.950154290204624*^9}, {
   3.950154524446163*^9, 3.950154527491989*^9}, 3.950154594241694*^9},
 CellLabel->"In[77]:=",ExpressionUUID->"1a460aaa-518d-428c-8b93-94f735e4bcf5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["c", "1", "B"], TraditionalForm]],ExpressionUUID->
  "ecc4df39-5eac-49a1-9a6f-f21e4609f0f9"],
 ": Solving"
}], "Subsection",
 CellChangeTimes->{{3.946558966739393*^9, 3.946558974541888*^9}, {
  3.948793546348846*^9, 3.948793551118506*^9}, {3.948858259471196*^9, 
  3.948858265439836*^9}, {3.9501546076465807`*^9, 
  3.9501546301382103`*^9}},ExpressionUUID->"ead4dacb-515c-4df9-b6d7-\
c31048e93665"],

Cell["Calculate the right hand side, and solve the problem", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.948780102200486*^9, 3.9487801498647346`*^9}, {
  3.9487802248068867`*^9, 3.9487802569732313`*^9}, {3.9487935634282846`*^9, 
  3.948793572450755*^9}},ExpressionUUID->"7bbd518e-0b16-4f12-bff6-\
1dae739b786c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<\[Theta]'''\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Theta]'''\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950154797068305*^9, 3.9501548241372967`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"5a1a66de-97be-4b29-9f4f-f243c421246c"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
     "Simplify", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "->", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "}"}], ",", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"t", ",", "s"}], "]"}], 
          RowBox[{
           RowBox[{"\[Theta]", "'"}], "[", "\[Rho]", "]"}]}]}], "]"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]''\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rs", "[", "\"\<\[Theta]'''\>\"", "]"}], ",", 
     "\[IndentingNewLine]", "Simplify"}], "\[IndentingNewLine]", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.948779847540926*^9, 3.9487798904147787`*^9}, {
   3.9487799357199306`*^9, 3.9487800756436663`*^9}, {3.9487935802709084`*^9, 
   3.94879358083747*^9}, {3.948802785210986*^9, 3.948802785822126*^9}, 
   3.948803154442556*^9, {3.948803331024461*^9, 3.948803344358596*^9}, {
   3.9488034186213627`*^9, 3.948803419129035*^9}, {3.948803502157695*^9, 
   3.948803502328971*^9}, {3.948803576975523*^9, 3.948803626660039*^9}, {
   3.948803798715476*^9, 3.948803803537356*^9}, {3.948804264302512*^9, 
   3.948804325532963*^9}, 3.948816869112481*^9, {3.9488169030485287`*^9, 
   3.948816957054904*^9}, {3.9488170009276876`*^9, 3.948817001734206*^9}, {
   3.9488171754278507`*^9, 3.948817286692197*^9}, {3.948817498460525*^9, 
   3.948817513455138*^9}, {3.95015464590969*^9, 3.950154781995143*^9}, {
   3.950154833886072*^9, 3.950154869084085*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"bd22f8f1-4e7c-47f5-9e0b-6056c042d70b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Constraining the homogeneous solution with the interface condition\
\>", "Subsection",
 CellChangeTimes->{{3.950154881065765*^9, 3.950154891577116*^9}, {
  3.950155974382925*^9, 
  3.950155977399775*^9}},ExpressionUUID->"ddeb0e5f-3262-4043-b98b-\
7efff87bdf96"],

Cell["We need to apply the definition of the interface", "Text",
 CellChangeTimes->{{3.9501549014334183`*^9, 
  3.950154912168914*^9}},ExpressionUUID->"f8538ea4-6f86-4366-9f7c-\
841e63c59786"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<boundary\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
       "}"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9501555730014267`*^9, 3.950155613329171*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"b9d3a875-e594-47db-8e4f-e6087cf880de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<boundary\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Theta]\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{"A", "[", 
           RowBox[{"t", ",", "s"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "/.", "#"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
     "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9501556290887814`*^9, 3.950155659682218*^9}, {
  3.950155696000539*^9, 3.950155726929748*^9}, {3.950155763674706*^9, 
  3.950155886255331*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"cf41a503-bccb-4055-898b-3c2118f40c3c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Listing the results", "Subsection",
 CellChangeTimes->{{3.950156418217485*^9, 
  3.950156420625458*^9}},ExpressionUUID->"e4930b6d-d6b1-4d18-be41-\
ba36ca92797b"],

Cell[BoxData[
 RowBox[{"KeySelect", "[", 
  RowBox[{
   RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], ",", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}]}], "]"}], "&"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.950156429120491*^9, 3.95015644521845*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"7a0df3d5-2252-4852-b6a3-4955b46c9ed0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
     "}"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.950156458668638*^9, 3.95015649369695*^9}, {
   3.950156634065061*^9, 3.950156675222674*^9}, {3.950156723051115*^9, 
   3.9501567232395267`*^9}, {3.950156755942623*^9, 3.950156761086183*^9}, 
   3.950156893223414*^9, {3.95016158722433*^9, 3.950161589525568*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"0d866b4c-7660-4aff-accc-f237146b572d"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Second order terms ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["\[CurlyEpsilon]", "2"], ")"}], TraditionalForm]],
  ExpressionUUID->"edcc8c71-1c9c-4ef8-89fc-dfa6ff254d22"]
}], "Chapter",
 CellChangeTimes->{{3.946559510146639*^9, 3.9465595141490726`*^9}, {
  3.948858601644595*^9, 
  3.948858621926936*^9}},ExpressionUUID->"9fe1f209-bb08-40b6-866c-\
60130d3cee70"],

Cell[CellGroupData[{

Cell["Area", "Section",
 CellChangeTimes->{{3.9411707914691772`*^9, 
  3.9411707918233156`*^9}},ExpressionUUID->"50bc5791-1281-4e61-ba22-\
562b8df48784"],

Cell[CellGroupData[{

Cell["Calculating the second order evolution equation", "Subsection",
 CellChangeTimes->{{3.9467054219986553`*^9, 3.946705428837923*^9}, {
  3.948800893064719*^9, 3.948800899272604*^9}, {3.950157610567411*^9, 
  3.950157611672061*^9}},ExpressionUUID->"71d038b9-f35b-43db-bf5b-\
4065efe384ea"],

Cell["Using the previously derived equations", "Text",
 CellChangeTimes->{{3.948800865778965*^9, 
  3.948800871158978*^9}},ExpressionUUID->"b06172fa-0f90-4a62-ad0f-\
9c1f008cc888"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<flow\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", "->", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", "->", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
     "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948800696529963*^9, 3.948800817421824*^9}, {
  3.950098104545066*^9, 3.950098172157467*^9}, {3.9501576145442333`*^9, 
  3.95015773243362*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"f39055ec-9bc6-46c2-95a4-8cde24e91edf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the second order chemical potential equation", "Subsection",
 CellChangeTimes->{{3.950098240676922*^9, 3.9500982461148033`*^9}, {
  3.950169331116414*^9, 
  3.950169331683264*^9}},ExpressionUUID->"fb48f1cc-15b5-4a4e-889d-\
cb5b717d8be8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<A\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", "->", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", "->", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"\"\<A\>\"", ",", "1"}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
             RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"\"\<A\>\"", ",", 
                RowBox[{"-", "1"}]}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
             RowBox[{"t", ",", "x", ",", "y"}], "]"}]}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      "patternToFunction", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<c\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
     "}"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.9500982335956173`*^9, {3.950098264049168*^9, 3.950098270836505*^9}, {
   3.950098340580124*^9, 3.950098446825141*^9}, {3.950098479404253*^9, 
   3.950098539093614*^9}, {3.9501481301730423`*^9, 3.950148131636994*^9}, {
   3.950157741833424*^9, 3.950157789600436*^9}, {3.9501578405464087`*^9, 
   3.950157841601357*^9}, {3.950157886408696*^9, 3.950157886712885*^9}, {
   3.950157941539936*^9, 3.9501579799942408`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"0ecd546d-d7be-44be-a101-8b717667a056"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary", "Section",
 CellChangeTimes->{{3.946480836325447*^9, 
  3.946480837020831*^9}},ExpressionUUID->"f681910c-320d-444d-8a84-\
a1d91d83b46a"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["flow", "2", "B"], TraditionalForm]],ExpressionUUID->
  "0fb42ff7-b353-49ba-8f72-07d023389bf3"],
 ": Simplifying the first order flow equation\nsolving for ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["m", "2", "B"], TraditionalForm]],ExpressionUUID->
  "d0e3f4b1-9b00-4348-838b-f597ac1d2d97"]
}], "Subsection",
 CellChangeTimes->{{3.946705492416457*^9, 3.946705500233686*^9}, {
  3.948801502657048*^9, 3.9488015124426727`*^9}, {3.948857761935644*^9, 
  3.948857764791325*^9}, {3.948858099977401*^9, 3.948858112816957*^9}, {
  3.948884990509097*^9, 3.948884990764439*^9}, {3.950159942711282*^9, 
  3.950159946572364*^9}, {3.9501688255143147`*^9, 
  3.950168834347857*^9}},ExpressionUUID->"79641990-223b-4768-9846-\
949bd9864fca"],

Cell["From the previous calculation", "Text",
 CellChangeTimes->{{3.9488015151591463`*^9, 
  3.948801518008561*^9}},ExpressionUUID->"e00b74bd-23b3-4d22-9f51-\
97e0f68dc22b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<flow\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
          "}"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{
           SubscriptBox["\[PartialD]", "s"], "#"}], ",", 
          RowBox[{
           SubscriptBox["\[PartialD]", "t"], "#"}], ",", 
          RowBox[{
           SubscriptBox["\[PartialD]", 
            RowBox[{"{", 
             RowBox[{"s", ",", "2"}], "}"}]], "#"}], ",", 
          RowBox[{
           SubscriptBox["\[PartialD]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]], "#"}]}], "}"}], "&"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", "FullSimplify", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Rho]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"\"\<flow\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "#", 
             "]"}], "&"}], ")"}]}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"F", "'"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Rho]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"\"\<flow\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "#", 
             "]"}], "&"}], ")"}]}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"F", "->", 
       RowBox[{"Function", "[", 
        RowBox[{"\[Rho]", ",", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "\[Eta]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Eta]", ",", 
             RowBox[{"-", "\[Infinity]"}], ",", "\[Rho]"}], "}"}]}], "]"}]}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "2"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"testing", " ", "at", " ", "infinity", " ", "for", " ", 
        RowBox[{"m", "[", 
         RowBox[{"\"\<A\>\"", ",", 
          RowBox[{"\[PlusMinus]", "1"}]}], "]"}]}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{"\"\<B\>\"", ",", 
           RowBox[{"\[PlusMinus]", "\[Infinity]"}]}], "}"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"f_", "?", 
                RowBox[{"(", 
                 RowBox[{"matchPatt", "[", 
                  RowBox[{"{", 
                   RowBox[{"c", ",", "m"}], "}"}], "]"}], ")"}]}], "[", 
               "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
             RowBox[{"(", 
              RowBox[{"0", "&"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "'"}], "[", "\[Rho]", "]"}], "->", "0"}], 
            ",", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "0"}], ",", 
            RowBox[{
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"\[Theta]", "[", "\[Eta]", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", 
                 RowBox[{"-", "\[Infinity]"}], ",", "\[Rho]"}], "}"}]}], 
              "]"}], "->", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"f_", "?", 
                RowBox[{"(", 
                 RowBox[{"matchPatt", "[", 
                  RowBox[{"{", 
                   RowBox[{"c", ",", "m"}], "}"}], "]"}], ")"}]}], "[", 
               "\"\<B\>\"", "]"}], "[", "eps__", "]"}], "->", 
             RowBox[{"(", 
              RowBox[{"0", "&"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "'"}], "[", "\[Rho]", "]"}], "->", "0"}], 
            ",", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "1"}], ",", 
            RowBox[{
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"\[Theta]", "[", "\[Eta]", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", 
                 RowBox[{"-", "\[Infinity]"}], ",", "\[Rho]"}], "}"}]}], 
              "]"}], "->", "\[Rho]"}]}], "}"}]}], "}"}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", 
            "\[Infinity]"}], "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"#", ",", "\[Rho]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "Flatten", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"\"\<flow\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "1", 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"\"\<flow\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "2", 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"\"\<A\>\"", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "[", 
                RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
               RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "//", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[PartialD]", "\[Rho]"], "#"}], "&"}]}], "//", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{"\[Rho]", "->", "0"}]}], "&"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"\"\<A\>\"", ",", "1"}], "]"}], "[", 
                RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], "[", 
               RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "//", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[PartialD]", "\[Rho]"], "#"}], "&"}]}], "//", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{"\[Rho]", "->", "0"}]}], "&"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", 
                RowBox[{"-", "1"}]}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
             RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", "1"}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
             RowBox[{"t", ",", "s", ",", "0"}], "]"}]}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"solving", " ", "at", " ", "interface", " ", "for", " ", 
        RowBox[{"m", "[", "\"\<B\>\"", "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "2"}],
            "}"}], "]"}], "/.", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "Simplify", ",", "\[IndentingNewLine]", 
      "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<flow\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "3"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
           RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      "Simplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "patternToFunction", ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "2"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "\[IndentingNewLine]", "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948801831948248*^9, 3.948801855074016*^9}, {
   3.948884996101185*^9, 3.948884996307385*^9}, {3.948885296315432*^9, 
   3.948885362339801*^9}, {3.948885395156765*^9, 3.948885495563694*^9}, {
   3.948885601164938*^9, 3.948885617095994*^9}, {3.948885837275998*^9, 
   3.948885843499378*^9}, {3.9488858961177483`*^9, 3.948885930937522*^9}, {
   3.948886167380612*^9, 3.948886174058629*^9}, 3.950158000721479*^9, {
   3.950159814019697*^9, 3.950159846681879*^9}, {3.950159976131357*^9, 
   3.950159977036213*^9}, {3.950160262540194*^9, 3.950160275743408*^9}, {
   3.950160306275758*^9, 3.950160310137621*^9}, {3.950160428456994*^9, 
   3.950160547848968*^9}, {3.950160602238887*^9, 3.950160603329026*^9}, {
   3.9501606631277857`*^9, 3.950160720349431*^9}, 3.950160836884809*^9, {
   3.950161245097381*^9, 3.950161253791502*^9}, {3.950161487074622*^9, 
   3.9501614872870827`*^9}, {3.950161677392158*^9, 3.950161722224741*^9}, {
   3.950161825824623*^9, 3.950161845645813*^9}, {3.950161882702389*^9, 
   3.9501618834701223`*^9}, {3.950161974199758*^9, 3.9501621210316277`*^9}, {
   3.950162162520928*^9, 3.950162163055942*^9}, {3.950162256283861*^9, 
   3.950162390016271*^9}, {3.950162452649234*^9, 3.950162453456471*^9}, {
   3.9501632358350487`*^9, 3.950163248607595*^9}, {3.950163307993333*^9, 
   3.950163416417789*^9}, {3.9501634507291*^9, 3.950163477352111*^9}, {
   3.950163585125217*^9, 3.950163693983316*^9}, {3.950163953754957*^9, 
   3.950163961169093*^9}, {3.950167668656131*^9, 3.950167729083008*^9}, {
   3.95016778734932*^9, 3.950167802890236*^9}, {3.950167833747139*^9, 
   3.950167861486404*^9}, {3.9501679691161423`*^9, 3.950167987636408*^9}, {
   3.950168986215559*^9, 3.9501689944140663`*^9}, {3.950178271129438*^9, 
   3.950178276640823*^9}, {3.950178334543886*^9, 3.950178335272183*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"01cc5b37-f797-41ce-a617-0a819d6e5808"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Simplifying ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", "\[Theta]"}], TraditionalForm]],ExpressionUUID->
  "ee2d8fc5-c21c-4aec-b013-659f781c1f9c"]
}], "Subsection",
 CellChangeTimes->{{3.950168785634225*^9, 
  3.950168796821076*^9}},ExpressionUUID->"fff5da63-f145-424c-a887-\
3f76065132ae"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "\[Eta]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Eta]", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Rho]"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Integrate", "->", "int"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"int", "[", 
       RowBox[{"integrand_", ",", "interval_"}], "]"}], ":>", 
      RowBox[{"int", "[", 
       RowBox[{
        RowBox[{"integrand", " ", 
         RowBox[{"d", "[", 
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"interval", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"int", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"d", "[", "c_", "]"}], "f_"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":>", 
      RowBox[{"int", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"f", " ", 
          RowBox[{"d", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "c", "]"}]], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "a", "]"}], ",", 
          RowBox[{"\[Theta]", "[", "b", "]"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], "//", 
      "patternToFunction"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "[", 
       RowBox[{"-", "\[Infinity]"}], "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "[", "\[Theta]", "]"}], "->", 
      RowBox[{"d", "[", "\[Xi]", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "\[Eta]", "]"}], "->", "\[Xi]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "\[Theta]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"int", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"d", "[", "c_", "]"}], "f_"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":>", 
      RowBox[{"Integrate", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "a", ",", "b"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"\[Theta]", ">", "0"}], "&&", 
         RowBox[{"\[Theta]", "<", "1"}]}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "->", 
      RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rs", "[", "\"\<\[Integral]\[Theta]\>\"", "]"}], "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "\[Eta]", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Eta]", ",", 
              RowBox[{"-", "\[Infinity]"}], ",", "\[Rho]"}], "}"}]}], "]"}], "->",
           "#"}], ")"}]}], ")"}], "&"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9501680546806183`*^9, 3.950168212727973*^9}, {
  3.950168251850998*^9, 3.950168633027101*^9}, {3.950168681543097*^9, 
  3.950168748023082*^9}, {3.950168886598991*^9, 3.950168887525202*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"6252024f-35a1-4698-b67b-e5ab05d0d56f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "3"}], 
     "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "1"}], 
      "}"}], "]"}], "/.", 
    RowBox[{"rs", "[", "\"\<\[Integral]\[Theta]\>\"", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.950169044834947*^9, 3.95016909788416*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"d4a4bf4d-c8bf-4ec1-a911-8bd763138fff"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["c", "2", "B"], TraditionalForm]],ExpressionUUID->
  "04ad039a-3054-4051-83da-1eaba08b13c7"],
 ": Calculating the solution"
}], "Subsection",
 CellChangeTimes->{{3.950169127867045*^9, 3.950169134066682*^9}, {
  3.950169262851317*^9, 
  3.9501692824996977`*^9}},ExpressionUUID->"d56180b3-15c0-4179-950d-\
a2949aa8004d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"9b03c443-48bf-4a2a-8b1b-603db5e78cc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.950171632864147*^9, 3.9501716354555492`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"da89eedb-16dc-43a1-b2d4-abd2e5068242"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplifying the chemical potential equation", "Subsection",
 CellChangeTimes->{{3.950178732587668*^9, 
  3.950178738924214*^9}},ExpressionUUID->"c5470dcc-7c89-4124-b492-\
3ab1fcde0a07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "2"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "}"}], ",", "1"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "3"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Theta]'\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Theta]''\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Theta]'''\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
      "FullSimplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
            RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"\"\<A\>\"", ",", 
                RowBox[{"-", "1"}]}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
            RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
            RowBox[{"t", ",", "s"}], "]"}]}], "}"}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"simplified", " ", "the", " ", "equation"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<chem\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "1"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ","}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "no", " ", "limiting", " ", "behaviour", " ", "to", " ", "control"}], 
      "*)"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948801536181758*^9, 3.948801539750732*^9}, {
   3.948801708316328*^9, 3.948801721097898*^9}, {3.948801797792857*^9, 
   3.9488018271886797`*^9}, {3.948801945810707*^9, 3.948802025359845*^9}, {
   3.95014724108438*^9, 3.950147257994994*^9}, {3.9501475592410583`*^9, 
   3.950147620846448*^9}, {3.95014774188826*^9, 3.9501478028315563`*^9}, {
   3.950147837547905*^9, 3.950147922822013*^9}, 3.950147955869226*^9, {
   3.950148018084178*^9, 3.950148055652492*^9}, {3.950148089964932*^9, 
   3.950148090219882*^9}, {3.950148151062516*^9, 3.950148169076407*^9}, {
   3.95014821487176*^9, 3.950148215866849*^9}, {3.9501482607334213`*^9, 
   3.950148261061639*^9}, {3.950148308662838*^9, 3.950148334700777*^9}, 
   3.9501483702546797`*^9, {3.950148935248549*^9, 3.950148954110325*^9}, {
   3.950148999038456*^9, 3.950149049798376*^9}, 3.950149247693849*^9, {
   3.950149287513088*^9, 3.950149411494934*^9}, {3.9501496282009907`*^9, 
   3.950149636024968*^9}, {3.950149784873611*^9, 3.950149786602995*^9}, {
   3.950149957619362*^9, 3.950149967926362*^9}, {3.9501697064962*^9, 
   3.950169721276309*^9}, {3.950171283240888*^9, 3.9501713819786043`*^9}, {
   3.950171426246089*^9, 3.950171447474612*^9}, {3.950171486045439*^9, 
   3.9501715087736893`*^9}, {3.950171650704844*^9, 3.950171656515397*^9}, {
   3.9501716917829237`*^9, 3.950171725700171*^9}, {3.950171770683638*^9, 
   3.9501719073177137`*^9}, {3.950171943271126*^9, 3.950171994338423*^9}, {
   3.950172061527687*^9, 3.9501720686424007`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"0046c45a-663c-474f-bab7-d640e610a088"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["BC", "2", 
    SubscriptBox["B", "j"]], TraditionalForm]],ExpressionUUID->
  "785c5822-7faa-4321-801a-b3e0af44ed3e"],
 ": Calculating the solvability condition"
}], "Subsection",
 CellChangeTimes->{{3.946558966739393*^9, 3.946558974541888*^9}, {
  3.948858273462824*^9, 3.948858295989543*^9}, {3.950172233807362*^9, 
  3.950172244039578*^9}},ExpressionUUID->"dbd172c9-fbec-4716-a66a-\
9bc5847b2ed3"],

Cell[TextData[{
 "Take the expression, isolate the inhomogeneous part (filter out ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "[", "x", "]"}], TraditionalForm]],ExpressionUUID->
  "c586413f-c5db-49e2-95a3-b4d2d568488b"],
 " terms), then change coordinates to ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]],ExpressionUUID->
  "d4cf8141-4708-47cd-9450-1c71b89fe916"],
 ", then perform an integration in ",
 Cell[BoxData[
  FormBox["d\[Theta]", TraditionalForm]],ExpressionUUID->
  "98604282-8bca-43ed-8a40-9868f4e5299e"],
 ", which conveniently absorbs/deletes the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "'"}], TraditionalForm]],ExpressionUUID->
  "7b9f4281-df87-4aba-a46c-df97648448af"],
 " cokernel element that we are taking the inner product with for our \
solvability condition"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.948780102200486*^9, 3.9487801498647346`*^9}, {
  3.9487802248068867`*^9, 
  3.9487802569732313`*^9}},ExpressionUUID->"070d1099-d5be-4e17-b61c-\
83ae5e0b6089"],

Cell["Write \[Rho] in terms of \[Theta]", "Text",
 CellChangeTimes->{{3.9501724434060297`*^9, 
  3.9501724482191963`*^9}},ExpressionUUID->"86960ddb-c787-466f-85d4-\
fa32dc630164"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rs", "[", "\"\<\[Theta]\>\"", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "-", "#"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", ">", "0"}], "&&", 
         RowBox[{"\[Theta]", "<", "1"}], "&&", 
         RowBox[{"\[Rho]", "\[Element]", "Reals"}]}], ",", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"#", "==", "0"}], ",", "\[Rho]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rs", "[", "\"\<\[Rho]2\[Theta]\>\"", "]"}], "=", "#"}], 
       ")"}], "&"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950172449222755*^9, 3.9501725809269342`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"feb98649-eecf-4adf-8cb2-9b0f5139a7b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "1"}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{
          RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "->", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f", "''"}], "[", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}], "-", "1"}], "]"}], 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}]}], "-", 
        RowBox[{"L", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "\"\<B\>\"", "]"}], "[", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
          RowBox[{"t", ",", "s", ",", "\[Rho]"}], "]"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "Expand", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"List", "@@", "#"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"L", "[", "a__", "]"}]}], "]"}], "&"}]}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plus", "@@", "#"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<f\>\"", "]"}], ",", "\[IndentingNewLine]", 
      "FullSimplify", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
          "[", 
          RowBox[{"{", 
           RowBox[{"\"\<chem\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", 
            "\"\<f\>\"", ",", "0"}], "}"}], "]"}], "=", "#"}], ")"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "\[Theta]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Rho]2\[Theta]\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ArcTanh", "[", 
            RowBox[{"1", "-", 
             RowBox[{"2", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "\[Theta]"}], "]"}]}], "}"}], ",", "Simplify"}],
         "]"}], "&"}], ",", "\[IndentingNewLine]", "printReturn", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Integrating", " ", Cell[
        "\[Integral]f\[Theta]'d\[Rho]=\[Integral]fd\[Theta]",ExpressionUUID->
         "78f740e2-362e-4673-8ca6-f5e07533d7eb"]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
           "[", 
           RowBox[{"{", 
            RowBox[{"\"\<sol\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<m\>\"", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", "0"}], "}"}], "]"}], "=", 
          "#"}], ")"}], "&"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"#", "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", 
            RowBox[{"t", ",", "s", ",", "0"}], "]"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "4"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}], ",", 
      "\[IndentingNewLine]", "printReturn"}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.948779847540926*^9, 3.9487798904147787`*^9}, {
   3.9487799357199306`*^9, 3.9487800756436663`*^9}, {3.948793593826434*^9, 
   3.9487935958934927`*^9}, {3.948793704768228*^9, 3.948793708637344*^9}, {
   3.948793763381715*^9, 3.948793828451119*^9}, {3.948793859619749*^9, 
   3.948793863090899*^9}, {3.9488026682851133`*^9, 3.94880267704548*^9}, {
   3.9488028494763327`*^9, 3.948802856494664*^9}, {3.948803161213689*^9, 
   3.9488032292772083`*^9}, {3.948803287168384*^9, 3.948803298308681*^9}, {
   3.94880363735507*^9, 3.948803672997518*^9}, {3.95015367684759*^9, 
   3.950153677999743*^9}, {3.950153735303438*^9, 3.950153786383031*^9}, {
   3.9501538190950003`*^9, 3.950153862976287*^9}, {3.9501538970251703`*^9, 
   3.9501540069681463`*^9}, {3.950154038256517*^9, 3.950154290204624*^9}, {
   3.950154524446163*^9, 3.950154527491989*^9}, 3.950154594241694*^9, {
   3.950172269214767*^9, 3.950172308049348*^9}, {3.950172592807455*^9, 
   3.9501727446466722`*^9}, {3.950172779988296*^9, 3.9501727818455353`*^9}, {
   3.950172833703323*^9, 3.950172848217771*^9}, {3.950172988309832*^9, 
   3.950173026832221*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"4197185c-7eb3-4ce8-bee6-60e5472c000f"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.950178767156637*^9},ExpressionUUID->"6898da0f-ce73-4657-a56c-\
7e386129f05e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking a bunch of Jacobi identities for concrete calculations\
\>", "Subsection",
 CellChangeTimes->{{3.9488781301663733`*^9, 
  3.948878139359164*^9}},ExpressionUUID->"1f50b632-5411-412d-a569-\
6be1b3b78b3b"],

Cell[CellGroupData[{

Cell["Defining the rules", "Subsubsection",
 CellChangeTimes->{{3.9492179311924553`*^9, 
  3.949217933286392*^9}},ExpressionUUID->"06c5bbb2-42e5-4bf3-b4de-\
fabcbbc1583f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<1-x\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "x"}], "]"}], ":>", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "x"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"-", "2"}], 
              RowBox[{"(", 
               RowBox[{"n", "+", "1"}], ")"}]}], 
             RowBox[{
              RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
            RowBox[{"P", "[", 
             RowBox[{
              RowBox[{"n", "+", "1"}], ",", 
              RowBox[{"a", "-", "1"}], ",", "b", ",", "x"}], "]"}]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"n", "+", "a"}], ")"}]}], 
             RowBox[{
              RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
            RowBox[{"P", "[", 
             RowBox[{"n", ",", 
              RowBox[{"a", "-", "1"}], ",", "b", ",", "x"}], "]"}]}]}], 
          ")"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<1+x\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "x"}], "]"}], ":>", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "+", "x"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"n", "+", "1"}], ")"}]}], 
             RowBox[{
              RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
            RowBox[{"P", "[", 
             RowBox[{
              RowBox[{"n", "+", "1"}], ",", "a", ",", 
              RowBox[{"b", "-", "1"}], ",", "x"}], "]"}]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"n", "+", "b"}], ")"}]}], 
             RowBox[{
              RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
            RowBox[{"P", "[", 
             RowBox[{"n", ",", "a", ",", 
              RowBox[{"b", "-", "1"}], ",", "x"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<dx\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "x"}], "]"}], ":>", 
        RowBox[{
         FractionBox["2", 
          RowBox[{"n", "+", "a", "+", "b"}]], 
         RowBox[{
          SubscriptBox["\[PartialD]", "x"], 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", 
            RowBox[{"a", "-", "1"}], ",", 
            RowBox[{"b", "-", "1"}], ",", "x"}], "]"}]}]}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<a+1\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "x"}], "]"}], ":>", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"n", "+", "a", "+", "b", "+", "1"}], 
           RowBox[{
            RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
          RowBox[{"P", "[", 
           RowBox[{"n", ",", 
            RowBox[{"a", "+", "1"}], ",", "b", ",", "x"}], "]"}]}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"n", "+", "b"}], ")"}], 
           RowBox[{
            RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", 
            RowBox[{"a", "+", "1"}], ",", "b", ",", "x"}], "]"}]}]}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<b+1\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "x"}], "]"}], ":>", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"n", "+", "a", "+", "b", "+", "1"}], 
           RowBox[{
            RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
          RowBox[{"P", "[", 
           RowBox[{"n", ",", "a", ",", 
            RowBox[{"b", "+", "1"}], ",", "x"}], "]"}]}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"n", "+", "a"}], ")"}], 
           RowBox[{
            RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", "a", ",", 
            RowBox[{"b", "+", "1"}], ",", "x"}], "]"}]}]}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<x=1\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "1"}], "]"}], ":>", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"n", "+", "a"}], ",", "n"}], "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<-x\>\"", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ":>", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "n"], 
         RowBox[{"P", "[", 
          RowBox[{"n", ",", "b", ",", "a", ",", 
           RowBox[{"-", "x"}]}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.949139290024811*^9, 3.949139515656967*^9}, 
   3.949143266493585*^9, {3.949143317285222*^9, 3.949143356273117*^9}, {
   3.949143395863105*^9, 3.949143479055903*^9}, {3.9491435598469877`*^9, 
   3.949143560841276*^9}, {3.9491448197271757`*^9, 3.949144819899929*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"ce1b0aaf-2f58-46f0-b89d-f3c1eaf0e733"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking evaluation at zero", "Subsubsection",
 CellChangeTimes->{{3.949218362686926*^9, 
  3.949218370294642*^9}},ExpressionUUID->"68dc579e-86c5-4c4a-8dc0-\
cea462353eca"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{
      RowBox[{"2", "n"}], ",", "2", ",", "2", ",", "0"}], "]"}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "n"], 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "+", "1"}], ")"}], "!"}], 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "n"}], "-", "2"}], ")"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "+", "4"}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "!"}], ")"}], "2"]}]]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"P", "->", "JacobiP"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"n", "\[Element]", "Integers"}]}], "]"}], "&"}], ","}], 
    "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[297]:=",ExpressionUUID->"3f752748-907b-4bed-8d7d-c1a831f1ec24"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", "n"}], "+", "1"}], ",", "2", ",", "2", ",", "0"}], "]"}], "/.", 
   RowBox[{"P", "->", "JacobiP"}]}], "//", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"#", ",", 
     RowBox[{"n", "\[Element]", "Integers"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.949218195726115*^9, 3.949218249234242*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"42377d3d-653f-4f11-aa0c-92b6de69b36d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking evaluation at one", "Subsubsection",
 CellChangeTimes->{{3.9492183720391006`*^9, 
  3.949218375550561*^9}},ExpressionUUID->"a59aa8cd-aefc-4714-a69b-\
843feb80bd95"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"JacobiP", "[", 
     RowBox[{"n", ",", "a", ",", "b", ",", "1"}], "]"}], "-", 
    RowBox[{"Binomial", "[", 
     RowBox[{
      RowBox[{"n", "+", "a"}], ",", "n"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"a", "->", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"b", "->", "2"}]}], "}"}]}], "]"}]], "Input",ExpressionUUID->\
"6ac330b1-de2f-496f-8d74-05569a8a589f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking symmetry", "Subsubsection",
 CellChangeTimes->{{3.9492184129353657`*^9, 
  3.949218414808463*^9}},ExpressionUUID->"d57eee10-e3d2-4e05-a159-\
811c1f442804"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{"n", ",", "a", ",", "b", ",", "1"}], "]"}], "-", 
    RowBox[{"P", "[", 
     RowBox[{"n", ",", "a", ",", "b", ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"n", ",", "a", ",", "b", ",", 
        RowBox[{"-", "1"}]}], "]"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n", ",", "a", ",", "b", ",", 
          RowBox[{"-", "1"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<-x\>\"", 
         "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<x=1\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"a", "->", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"b", "->", "2"}], ",", "\[IndentingNewLine]", "Simplify", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "->", "2"}]}], "\[IndentingNewLine]", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.949144549884617*^9, 3.949144627863488*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"b314cc71-bada-4142-a739-9d73a437021c"],

Cell[TextData[StyleBox["Checking a Jacobi type operator (multiplication by \
nonconstant coefficients", "Subsubsection"]], "Text",
 CellChangeTimes->{{3.949137816175722*^9, 
  3.9491378302682953`*^9}},ExpressionUUID->"a45742fd-825d-4321-948d-\
3124da3e61dc"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}], 
     RowBox[{"P", "[", 
      RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]}], 
      RowBox[{
       RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", 
       RowBox[{"a", "-", "1"}], ",", "b", ",", "x"}], "]"}]}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"n", "+", "a"}], ")"}]}], 
      RowBox[{
       RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
     RowBox[{"P", "[", 
      RowBox[{"n", ",", 
       RowBox[{"a", "-", "1"}], ",", "b", ",", "x"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"P", "->", "JacobiP"}], ",", "\[IndentingNewLine]", 
     "FullSimplify"}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9491377203837433`*^9, 3.949137804932434*^9}, {
  3.949137973627261*^9, 3.949137985164713*^9}, {3.949138033299116*^9, 
  3.949138069533485*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"aee62406-e69b-4c4e-9cd2-c8e05419a18a"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], 
     RowBox[{"P", "[", 
      RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]}], 
      RowBox[{
       RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", "a", ",", 
       RowBox[{"b", "-", "1"}], ",", "x"}], "]"}]}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"n", "+", "b"}], ")"}]}], 
      RowBox[{
       RowBox[{"2", "n"}], "+", "a", "+", "b", "+", "1"}]], 
     RowBox[{"P", "[", 
      RowBox[{"n", ",", "a", ",", 
       RowBox[{"b", "-", "1"}], ",", "x"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"P", "->", "JacobiP"}], ",", "\[IndentingNewLine]", 
     "FullSimplify"}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.949137862974697*^9, 3.949137869365983*^9}, {
  3.949138079844397*^9, 3.949138125364642*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"b1d7f29f-c1da-4859-a70d-a36ef863b7fb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking differentiation", "Subsubsection",
 CellChangeTimes->{{3.949218449394394*^9, 
  3.9492184534152927`*^9}},ExpressionUUID->"15975a4b-7949-43c0-a0fb-\
0f66a0645f8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JacobiP", "[", 
    RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}], "-", 
   RowBox[{
    FractionBox["2", 
     RowBox[{"n", "+", "a", "+", "b"}]], 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"JacobiP", "[", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", 
       RowBox[{"a", "-", "1"}], ",", 
       RowBox[{"b", "-", "1"}], ",", "x"}], "]"}]}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9488769687437887`*^9, 3.948877036943125*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"0fd11c84-9a58-43d3-8b46-969a87e807c1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking integrals of the Jacobi polynomials", "Subsubsection",
 CellChangeTimes->{{3.9491450494376373`*^9, 3.949145056852953*^9}, {
  3.9492184828567333`*^9, 3.94921848614361*^9}, {3.949218558894562*^9, 
  3.949218559012908*^9}},ExpressionUUID->"b73d4e65-faea-441c-956d-\
0132a568f4e6"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"JacobiP", "[", 
       RowBox[{"n", ",", "2", ",", "2", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"4", 
       RowBox[{"(", 
        RowBox[{"n", "+", "2"}], ")"}]}], 
      RowBox[{"n", "+", "4"}]], 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", "2"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.948876570024947*^9, 3.948876594941806*^9}, {
  3.94887669293976*^9, 3.948876775119454*^9}, {3.948877231568342*^9, 
  3.948877246014407*^9}, {3.9488773432404203`*^9, 3.948877349428541*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"b7245691-2edd-4de1-89c4-23112aed130c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking normalisation of the Jacobi polynomials", "Subsubsection",
 CellChangeTimes->{{3.949145061888164*^9, 3.9491450691092243`*^9}, {
  3.949218495723486*^9, 3.949218497077458*^9}, {3.9492185602269907`*^9, 
  3.9492185614790707`*^9}},ExpressionUUID->"707934d4-690b-4094-a1ff-\
614de90fc36d"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"JacobiP", "[", 
         RowBox[{"n", ",", "2", ",", "2", ",", "x"}], "]"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["2", "5"], 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", "+", "2"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "n"}], "+", "5"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", "+", "3"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", "+", "4"}], ")"}]}]]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.94887679055122*^9, 3.948876794507601*^9}, {
  3.948877570900786*^9, 3.948877648820457*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"fe3c6f8a-4a2a-4d1f-a592-4a6a8cf69052"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculating expansion of ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["c", "2", "B"], TraditionalForm]],ExpressionUUID->
  "0b7670eb-7016-4eea-88bc-9268cc3ce8d6"]
}], "Subsection",
 CellChangeTimes->{{3.949144971557642*^9, 3.949144978287149*^9}, {
  3.949218459168763*^9, 3.9492184721070004`*^9}, {3.950172873522462*^9, 
  3.950172877765142*^9}},ExpressionUUID->"f931a0e3-5295-4bd6-90ae-\
4a607609f234"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "4"}], "}"}], 
  "]"}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"453fb5e0-210e-4e4a-92be-9ee2819a137f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<chem\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", 
       "\"\<f\>\"", ",", "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"\"\<m\>\"", ",", "\"\<B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "4"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", "Simplify", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "\[Rho]", "]"}], "->", "\[Theta]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", "[", "\"\<\[Rho]2\[Theta]\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ArcTanh", "[", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "\[Theta]"}], "]"}]}], "}"}], ",", "Simplify"}],
         "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Theta]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "#", 
             "]"}], "&"}], ")"}]}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{"-", " ", "#"}], 
        RowBox[{
         SuperscriptBox["\[Theta]", "3"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Theta]"}], ")"}], "3"]}]], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ArcTanh", "[", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "\[Theta]"}], "]"}]}], "}"}], ",", "Simplify"}],
         "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"#", ",", "\[Theta]", ",", 
         RowBox[{"GeneratedParameters", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "#", 
             "]"}], "&"}], ")"}]}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", " ", "\[Theta]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ArcTanh", "[", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "\[Theta]"}], "]"}]}], "}"}], ",", "Simplify"}],
         "]"}], "&"}], ",", "\[IndentingNewLine]", "FullSimplify", ",", 
      "\[IndentingNewLine]", "printReturn", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}],
            "}"}], "]"}], "=", "#"}], ")"}], "&"}]}], "\[IndentingNewLine]", 
     "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.950172894167337*^9, 3.950172940573893*^9}, {
  3.950173039285324*^9, 3.9501730510437307`*^9}, {3.950173422728867*^9, 
  3.950173525044958*^9}, {3.950173559112629*^9, 3.9501737337717533`*^9}, {
  3.950173776109117*^9, 3.950173793194302*^9}, {3.950173826041519*^9, 
  3.950173827319675*^9}, {3.95017428534549*^9, 3.950174303862267*^9}, {
  3.950174428537093*^9, 3.950174430871771*^9}, {3.950174510652048*^9, 
  3.950174536163217*^9}, {3.950174572378125*^9, 3.950174604974848*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"d3c9e932-988b-4ef7-9067-9d565093c1e5"],

Cell[CellGroupData[{

Cell[TextData[{
 "Check limiting behaviour of the solution to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"+", "\[Infinity]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2e02b681-0ec6-4b00-ab32-d5aa9f42e849"]
}], "Subsubsection",
 CellChangeTimes->{{3.95017465891418*^9, 3.950174664405773*^9}, {
  3.950179040479538*^9, 3.95017904263174*^9}, {3.950179097111237*^9, 
  3.950179097390267*^9}},ExpressionUUID->"6115ee79-10eb-4a97-b3ec-\
080d0481b507"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "[", 
       RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Log", "[", 
       FractionBox["1", 
        RowBox[{"1", "-", "\[Theta]"}]], "]"}], "->", 
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "\[Theta]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArcTanh", "[", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "\[Theta]"}]}], "]"}], "\[Rule]", 
      FractionBox["\[Rho]", 
       RowBox[{"-", "2", " "}]]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "\[Theta]"}], "]"}], "->", "\[Rho]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", 
        FractionBox["\[Theta]", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Theta]"}]]}], "]"}], "->", 
      RowBox[{"A", " ", 
       SuperscriptBox["\[Rho]", "2"]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Log", "[", "\[Theta]", "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", "ReleaseHold", ",", "\[IndentingNewLine]", 
     "FullSimplify", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"t", ",", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "1", 
           "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "2", 
           "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
           RowBox[{"t", ",", "s"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "Simplify"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
         "[", 
         RowBox[{"{", 
          RowBox[{"\"\<chem\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", 
           "\"\<f\>\"", ",", "\[Infinity]"}], "}"}], "]"}], "=", "#"}], ")"}],
       "&"}], ","}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9501746671834393`*^9, 3.950174732169607*^9}, {
  3.950174774388242*^9, 3.950175020515465*^9}, {3.9501751988343773`*^9, 
  3.950175200023525*^9}, {3.95017525555956*^9, 3.9501752558592587`*^9}, {
  3.950175341066639*^9, 3.950175438007368*^9}, {3.950179105985221*^9, 
  3.950179112328233*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"9826ce33-cd33-4c8f-afbf-007f24178677"],

Cell["\<\
So I need to cancel the singularities in this solution somehow. That will \
connect the various quantities\
\>", "Text",
 CellChangeTimes->{{3.9501752863654613`*^9, 
  3.950175325378393*^9}},ExpressionUUID->"480d6ee9-da32-467d-a5dd-\
aba1ea2a78bf"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "\"\<f\>\"",
       ",", "\[Infinity]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Theta]"}], ")"}], "#"}], "&"}], ",", 
     "\[IndentingNewLine]", "Expand", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"t", ",", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "1", 
           "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "2", 
           "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
           RowBox[{"t", ",", "s"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "Simplify"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "->", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", "\[Rho]", ",", "Simplify"}], "]"}], "&"}]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.9501755552131243`*^9, 3.950175569824821*^9}, {
  3.9501756056384*^9, 3.950175703353168*^9}, {3.95017897820513*^9, 
  3.950178988864275*^9}, {3.950179120680685*^9, 3.9501791772095137`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"d4fee7b0-53e5-46cc-b23b-de5edba691a8"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Check limiting behaviour of the solution to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "\[Infinity]"}], TraditionalForm]],ExpressionUUID->
  "b36611a5-2c99-4c99-92dc-eee7d9e914c1"]
}], "Subsubsection",
 CellChangeTimes->{{3.950179320595045*^9, 
  3.950179324240302*^9}},ExpressionUUID->"f93f1d6f-ed0d-49c4-86b1-\
5877337e687e"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", "\"\<sols\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<c\>\"", ",", "\"\<B\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "0"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "[", 
       RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Log", "[", 
       FractionBox["1", 
        RowBox[{"1", "-", "\[Theta]"}]], "]"}], "->", 
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "\[Theta]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArcTanh", "[", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "\[Theta]"}]}], "]"}], "\[Rule]", 
      FractionBox["\[Rho]", 
       RowBox[{"-", "2", " "}]]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "\[Theta]"}], "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", 
        FractionBox["\[Theta]", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Theta]"}]]}], "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Log", "[", "\[Theta]", "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", "ReleaseHold", ",", "\[IndentingNewLine]", 
     "FullSimplify", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"t", ",", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "1", 
           "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "2", 
           "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
           RowBox[{"t", ",", "s"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "Simplify"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], 
         "[", 
         RowBox[{"{", 
          RowBox[{"\"\<chem\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", 
           "\"\<f\>\"", ",", 
           RowBox[{"-", "\[Infinity]"}]}], "}"}], "]"}], "=", "#"}], ")"}], 
      "&"}], ","}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9501793520092287`*^9, 3.950179383903618*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"bcf58e8a-3fdf-4b7c-9fc0-803b6cc25967"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"es", "[", "\"\<eqs\>\"", "]"}], "[", "\"\<B\>\"", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"\"\<chem\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "}"}], ",", "\"\<f\>\"",
       ",", 
      RowBox[{"-", "\[Infinity]"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "#"}], "&"}], ",", "\[IndentingNewLine]", "Expand", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"t", ",", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "1", 
           "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"C", "[", 
             RowBox[{"\"\<chem\>\"", ",", "\"\<B\>\""}], "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "2"}], "]"}], "[", "2", 
           "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"\"\<A\>\"", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "1"}], "]"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"t", ",", "s", ",", "0"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v\[Rho]", "[", "\"\<B\>\"", "]"}], "[", 
            RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "0"}], "]"}], "[", 
           RowBox[{"t", ",", "s"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "Simplify"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "->", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950178997719605*^9, 3.950179001126711*^9}, {
  3.95017939305523*^9, 3.950179434591316*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"a16299ea-0b5f-4c1b-95a2-6e1ef055932e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Understanding polylogarithm", "Subsubsection",
 CellChangeTimes->{{3.9501794561979303`*^9, 
  3.950179461541666*^9}},ExpressionUUID->"fc6535b9-0b9c-4ff9-873f-\
ff6b4a84672a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyLog", "[", 
     RowBox[{"2", ",", 
      FractionBox[
       RowBox[{"-", "\[Theta]"}], 
       RowBox[{"1", "-", "\[Theta]"}]]}], "]"}], "/.", 
    RowBox[{"\[Theta]", "->", 
     RowBox[{"\[Theta]", "[", "\[Rho]", "]"}]}]}], "/.", 
   RowBox[{"rs", "[", "\"\<\[Theta]\>\"", "]"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.950174026173708*^9, 3.9501740410963793`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"7576ebb3-c725-4514-adc0-17f049f2d151"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    FractionBox[
     RowBox[{"PolyLog", "[", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", "\[Rho]"]}]}], "]"}], 
     RowBox[{
      SuperscriptBox["\[Rho]", "2"], "+", 
      RowBox[{"Sech", "[", "\[Rho]", "]"}]}]], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", 
     RowBox[{"-", "20"}], ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950174056309493*^9, 3.9501742166356697`*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"663794f9-86d7-4a5b-b73f-023bef6b8b95"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PolyLog", "[", 
    RowBox[{"2", ",", 
     FractionBox[
      RowBox[{"-", "\[Theta]"}], 
      RowBox[{"1", "-", "\[Theta]"}]]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9501739763601913`*^9, 3.950173993986738*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"7fab0152-ce0c-475f-a2ec-afc9d05a399d"],

Cell[BoxData[
 RowBox[{"applyTransforms", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}], 
    RowBox[{"P", "[", 
     RowBox[{"n", ",", "a", ",", "b", ",", "x"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<1-x\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<1+x\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<dx\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}], "[", "P", "]"}],
         "[", 
        RowBox[{"n_", ",", "a_", ",", "b_", ",", "x_"}], "]"}], ")"}], ":>", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"n", ",", "a", ",", "b", ",", "1"}], "]"}], "-", 
       RowBox[{"P", "[", 
        RowBox[{"n", ",", "a", ",", "b", ",", 
         RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"n_", ",", "a_", ",", "b_", ",", 
        RowBox[{"-", "1"}]}], "]"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"n", ",", "a", ",", "b", ",", 
          RowBox[{"-", "1"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<-x\>\"", 
         "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", "[", "\"\<Jacobi\>\"", "]"}], "[", "\"\<x=1\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"a", "->", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"b", "->", "2"}], ",", "\[IndentingNewLine]", "FullSimplify"}], 
    "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9491383767992983`*^9, 3.949138599389578*^9}, {
  3.949138636151215*^9, 3.949138654895282*^9}, {3.94914329134102*^9, 
  3.949143305093041*^9}, {3.949143502087523*^9, 3.949143526000554*^9}, {
  3.949143589702104*^9, 3.949143820671897*^9}, {3.9491440027254972`*^9, 
  3.9491440496365767`*^9}, {3.949144159266445*^9, 3.949144165823248*^9}, {
  3.9491446623163137`*^9, 3.94914472715139*^9}, {3.949144789236167*^9, 
  3.949144793919407*^9}, {3.94914485981431*^9, 3.949144901160087*^9}, {
  3.949498121400112*^9, 3.9494981214848967`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"fa2ee8b4-2649-4cee-9cdd-ae28bebaf64a"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  FractionBox[
   FractionBox[
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "n"]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", "n"}], ")"}]}]], 
   FractionBox[
    RowBox[{
     SuperscriptBox["2", "5"], 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", "+", "2"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "n"}], "+", "5"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", "+", "3"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", "+", "4"}], ")"}]}]]], "]"}]], "Input",
 CellChangeTimes->{{3.948878119607747*^9, 3.948878120822727*^9}, {
   3.9491450849859743`*^9, 3.949145094583138*^9}, 3.9494909428832083`*^9},
 CellLabel->
  "In[279]:=",ExpressionUUID->"cd66da17-2c5f-4269-892b-3df976a18719"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{787, 831},
WindowMargins->{{Automatic, 289}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
CellProlog:>SelectionMove[
  NextCell[CellStyle -> "Input"], All, Cell],
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b0e631d4-5c33-425c-81fb-34053ee10a40"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 370, 6, 235, "Title",ExpressionUUID->"9957c294-0a75-4edb-b5e5-9fa1a6fed270"],
Cell[CellGroupData[{
Cell[975, 32, 159, 3, 101, "Chapter",ExpressionUUID->"3fa8cc1f-a853-49b5-80a7-65381421731e"],
Cell[CellGroupData[{
Cell[1159, 39, 165, 3, 99, "Section",ExpressionUUID->"a2fc9a33-21f9-4606-a116-ab325b887aea"],
Cell[1327, 44, 464, 12, 83, "Text",ExpressionUUID->"d33044d5-ed65-4aa1-8f0d-931d4809a59a"],
Cell[1794, 58, 657, 16, 149, "Text",ExpressionUUID->"93a75d16-71d8-4ba9-a8bc-7709e2db438b"],
Cell[2454, 76, 803, 24, 55, "Text",ExpressionUUID->"d714e0ab-0bb9-4503-bb3a-42479fd1ffe5"],
Cell[3260, 102, 693, 18, 116, "Text",ExpressionUUID->"3b67e6ef-684b-4bc9-a155-06ed84d10fbd"],
Cell[3956, 122, 3584, 104, 180, "Text",ExpressionUUID->"e439fce4-6949-4d4d-bda5-212166485781"],
Cell[7543, 228, 1321, 36, 286, "Text",ExpressionUUID->"e80ca07a-15dd-4f83-a16e-47972fcbf85b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8913, 270, 156, 3, 101, "Chapter",ExpressionUUID->"2511758e-a1c1-43cf-8d83-d46e9bbe3aef"],
Cell[9072, 275, 202, 3, 50, "Text",ExpressionUUID->"d2f91a31-08f0-46bf-9164-6f28da40bdf1"],
Cell[9277, 280, 483, 11, 135, "Input",ExpressionUUID->"d245ddc3-c3b7-481e-85e2-5132700e0656"],
Cell[9763, 293, 721, 12, 280, "Text",ExpressionUUID->"4c8bc760-465c-480e-bbc0-425718bdc610"],
Cell[10487, 307, 3036, 66, 503, "Input",ExpressionUUID->"97a0a8a2-d246-4e28-a03e-d9266675464a"],
Cell[13526, 375, 1023, 29, 166, "Input",ExpressionUUID->"50c9be8c-32d2-4e38-bfdb-21c6784c8e77"],
Cell[14552, 406, 1943, 40, 135, "Input",ExpressionUUID->"63a54cc5-33c6-42d2-800a-ba5c5e58e255"],
Cell[16498, 448, 1062, 33, 197, "Input",ExpressionUUID->"7b991653-62d5-41b8-9bed-f40f138e2a51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17597, 486, 156, 3, 101, "Chapter",ExpressionUUID->"f723894c-d5a8-4ecd-a176-2abbbcbe47f7"],
Cell[17756, 491, 294, 6, 116, "Text",ExpressionUUID->"cc2f5f5c-f733-4666-b10b-db1ea202a563"],
Cell[18053, 499, 19913, 294, 250, "Input",ExpressionUUID->"6af17ee4-eb8b-4a2f-b8b4-cbcbb9583403"],
Cell[37969, 795, 587, 15, 116, "Text",ExpressionUUID->"2e71ec46-df48-4fb8-860c-26902e395a2d"],
Cell[38559, 812, 20612, 299, 196, "Input",ExpressionUUID->"8232a3dc-997a-4404-852c-0c1da016ef94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59208, 1116, 169, 3, 101, "Chapter",ExpressionUUID->"211e14ed-9724-47b0-b70f-9abc63754d1c"],
Cell[59380, 1121, 2169, 48, 706, "Text",ExpressionUUID->"86a157dc-9b80-477a-ab04-dec6feb2dc4b"],
Cell[61552, 1171, 2023, 62, 151, "Text",ExpressionUUID->"a105e703-c9b2-467f-a4e0-aabc6b893a8e"],
Cell[63578, 1235, 580, 10, 181, "Text",ExpressionUUID->"571b9aaa-f6f2-4e90-b2c5-bfa41e616bf0"],
Cell[64161, 1247, 756, 23, 86, "Text",ExpressionUUID->"1e04977c-8571-435d-9fed-33a3620978d6"],
Cell[64920, 1272, 814, 26, 84, "Text",ExpressionUUID->"8c74dcda-1e4e-43e5-a068-0a4a883974df"],
Cell[65737, 1300, 1992, 67, 131, "Text",ExpressionUUID->"2b777d49-127e-4b6a-8e17-a2ca8260dc09"],
Cell[67732, 1369, 1005, 19, 509, "Text",ExpressionUUID->"b7f240a0-ff3f-4412-add4-233ab11d361d"],
Cell[68740, 1390, 274, 6, 44, "Input",ExpressionUUID->"d6f58052-e3e7-4c18-a2cc-c5c2e6cc0a8b"],
Cell[69017, 1398, 38378, 786, 3260, "Input",ExpressionUUID->"1c66e148-d259-41ca-8126-105798aa12aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107432, 2189, 218, 4, 101, "Chapter",ExpressionUUID->"7ce1cebf-32b9-443e-902a-23c639c5c94c"],
Cell[CellGroupData[{
Cell[107675, 2197, 150, 3, 99, "Section",ExpressionUUID->"95d6e8a5-62e3-4927-a1a2-0dde2013826f"],
Cell[107828, 2202, 311, 7, 44, "Input",ExpressionUUID->"e669b7f6-9036-47f9-8ad4-f58016cf1478"],
Cell[CellGroupData[{
Cell[108164, 2213, 186, 3, 79, "Subsection",ExpressionUUID->"a0e8d823-0b17-4c01-abc6-210e63d8ccf0"],
Cell[108353, 2218, 1139, 34, 152, "Text",ExpressionUUID->"a96ceb7a-71ca-42f0-bbce-1b83e986f924"],
Cell[109495, 2254, 3127, 77, 428, "Input",ExpressionUUID->"5c6cf941-e756-4fa2-88c4-0841d0ee30a2"],
Cell[112625, 2333, 937, 24, 74, "Input",ExpressionUUID->"0f65d2b2-6fcd-46fa-80a9-8f4dcc864c09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113599, 2362, 195, 3, 79, "Subsection",ExpressionUUID->"bccd526b-8feb-4ec6-9e16-e15153da1f37"],
Cell[113797, 2367, 3290, 76, 397, "Input",ExpressionUUID->"a18dfcc6-ed9f-4a8f-9751-fa2f5eac1e0c"],
Cell[117090, 2445, 939, 24, 74, "Input",ExpressionUUID->"3a68a126-1c28-467c-9664-b0e2027f075a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118078, 2475, 155, 3, 99, "Section",ExpressionUUID->"4573ce54-6462-41c7-a2c6-3b8f1aca2118"],
Cell[118236, 2480, 267, 6, 83, "Text",ExpressionUUID->"f97fcccf-48f8-427c-baa5-d86f2212c99e"],
Cell[118506, 2488, 313, 7, 44, "Input",ExpressionUUID->"e6a4b284-e913-447d-a79f-f02a9542e97e"],
Cell[CellGroupData[{
Cell[118844, 2499, 186, 3, 79, "Subsection",ExpressionUUID->"18ef477a-a3e0-4f57-bdf6-ad961545ca11"],
Cell[119033, 2504, 3637, 97, 564, "Input",ExpressionUUID->"2c23020d-345d-49dd-b07d-a276dbeae4b5"],
Cell[122673, 2603, 948, 26, 74, "Input",ExpressionUUID->"d6890b4c-a09a-4576-8d9e-3054c7338a13"]
}, Closed]],
Cell[CellGroupData[{
Cell[123658, 2634, 237, 4, 53, "Subsection",ExpressionUUID->"057589f5-7bbf-4194-9a33-0fc16cb3f99c"],
Cell[123898, 2640, 9741, 221, 908, "Input",ExpressionUUID->"de97114c-6db3-4198-a858-950f664c3ede"],
Cell[133642, 2863, 842, 23, 74, "Input",ExpressionUUID->"fe95f7dd-41b8-4b59-9b25-bfb9f66b6acd"],
Cell[134487, 2888, 620, 11, 149, "Text",ExpressionUUID->"cd592fb0-f33b-41b1-8549-18edacf1a34c"]
}, Closed]],
Cell[CellGroupData[{
Cell[135144, 2904, 203, 3, 92, "Subsection",ExpressionUUID->"8d1d9258-46aa-4544-b887-6255b978bce4"],
Cell[135350, 2909, 241, 4, 50, "Text",ExpressionUUID->"d97ef6f3-3b86-4efa-9e6c-d8c671254eaa"],
Cell[135594, 2915, 7511, 192, 908, "Input",ExpressionUUID->"8e375c6f-6c69-4b01-8798-5dca320837ae"],
Cell[143108, 3109, 912, 25, 74, "Input",ExpressionUUID->"1d2683db-ab7e-46b5-bd7c-9e7f2afeab61"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144081, 3141, 409, 11, 104, "Chapter",ExpressionUUID->"12bed0e9-0cb3-4e43-b461-eaa2502cd928"],
Cell[144493, 3154, 555, 12, 149, "Text",ExpressionUUID->"b72b0fc8-83c7-4eaf-bcd6-9f29f1cd4181"],
Cell[145051, 3168, 274, 6, 44, "Input",ExpressionUUID->"560b89ba-bbe8-4aaf-8de9-5be2eaa0264b"],
Cell[CellGroupData[{
Cell[145350, 3178, 151, 3, 99, "Section",ExpressionUUID->"0ad570f9-30a9-4fb8-984e-ef8cbf1dde2d"],
Cell[145504, 3183, 741, 20, 117, "Text",ExpressionUUID->"f7d36f66-ef65-435b-a9b1-ac846ed9d971"],
Cell[CellGroupData[{
Cell[146270, 3207, 295, 7, 118, "Subsection",ExpressionUUID->"7def0928-107f-4e05-8bc8-faec8af89c9d"],
Cell[146568, 3216, 218, 5, 83, "Text",ExpressionUUID->"8031c5ca-5e32-465f-9579-791df9e255fc"],
Cell[146789, 3223, 1628, 40, 135, "Input",ExpressionUUID->"ecb1889d-1db8-4170-a622-94e0c4bcfaed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148454, 3268, 345, 7, 118, "Subsection",ExpressionUUID->"09aad67b-fedd-4970-80e3-4dd2da86c585"],
Cell[148802, 3277, 753, 24, 55, "Text",ExpressionUUID->"46094073-f422-456c-9f99-f5e300ffe423"],
Cell[149558, 3303, 2547, 62, 227, "Input",ExpressionUUID->"66775e76-3592-4e09-8f1d-53f263866be9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[152154, 3371, 179, 4, 76, "Section",ExpressionUUID->"104ef968-4dcf-48f5-ab6b-bb29d00f6f7b"],
Cell[152336, 3377, 818, 18, 186, "Text",ExpressionUUID->"0174e420-8157-423e-856a-d99329e4f38f"],
Cell[CellGroupData[{
Cell[153179, 3399, 278, 6, 118, "Subsection",ExpressionUUID->"2ee32884-cf94-47cb-8194-0de44e84c085"],
Cell[153460, 3407, 7166, 183, 809, "Input",ExpressionUUID->"cd238cec-db41-4e46-ba01-7bd6a118f9e4"]
}, Closed]],
Cell[CellGroupData[{
Cell[160663, 3595, 245, 6, 92, "Subsection",ExpressionUUID->"5732efd9-fdd4-4b73-90b2-7dcf475fe972"],
Cell[160911, 3603, 193, 3, 50, "Text",ExpressionUUID->"3d2daffc-b357-4b22-ac68-386ec198d025"],
Cell[161107, 3608, 5418, 132, 527, "Input",ExpressionUUID->"98387373-97c3-47fd-8a23-0cc5022f6fda"],
Cell[166528, 3742, 3349, 91, 381, "Input",ExpressionUUID->"de3fb32c-c4f5-4c53-9b21-2c93b221be39"],
Cell[169880, 3835, 698, 17, 83, "Text",ExpressionUUID->"cdf2ce8d-7f6f-4b81-add7-42d2a3a68a7b"],
Cell[170581, 3854, 239, 6, 83, "Text",ExpressionUUID->"3399224e-0c7b-4cb8-a5cd-bc221ba14dcf"],
Cell[170823, 3862, 2115, 53, 319, "Input",ExpressionUUID->"245ab6db-c185-409b-9b8d-5c31da28d2d7"],
Cell[172941, 3917, 215, 5, 50, "Text",ExpressionUUID->"e6627e1d-b03e-4649-b0b6-b3506ff73a03"],
Cell[173159, 3924, 3026, 80, 374, "Input",ExpressionUUID->"d9f8906e-61e2-42ab-825a-0cf6384e5ca1"],
Cell[176188, 4006, 257, 6, 83, "Text",ExpressionUUID->"0f843082-0518-4742-80ca-864ed12e4a1d"],
Cell[176448, 4014, 2337, 60, 381, "Input",ExpressionUUID->"2bf0f692-514f-4184-a16c-3db0fd4f2a97"],
Cell[178788, 4076, 2349, 60, 350, "Input",ExpressionUUID->"ae289d6e-55ce-4e77-97a6-1f26d74dc0a4"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181198, 4143, 452, 11, 104, "Chapter",ExpressionUUID->"292eb54d-16b9-43a1-a5f1-843a78773e20"],
Cell[CellGroupData[{
Cell[181675, 4158, 153, 3, 99, "Section",ExpressionUUID->"81804c53-844c-4742-9e57-d424ee990482"],
Cell[CellGroupData[{
Cell[181853, 4165, 245, 4, 79, "Subsection",ExpressionUUID->"221676dd-5445-4adf-be90-ac008a6bb214"],
Cell[182101, 4171, 180, 3, 50, "Text",ExpressionUUID->"6edc0ed4-0ab2-4b15-9134-92d355abd764"],
Cell[182284, 4176, 1376, 37, 166, "Input",ExpressionUUID->"51a87db2-ad33-46dc-a7c1-19aef555a03b"]
}, Closed]],
Cell[CellGroupData[{
Cell[183697, 4218, 205, 3, 92, "Subsection",ExpressionUUID->"9b66a3fa-1e3a-4b8c-a958-059beb516235"],
Cell[183905, 4223, 3055, 81, 319, "Input",ExpressionUUID->"79d33223-68f2-4b06-bb3a-8ab12b2ffcf1"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[187009, 4310, 153, 3, 76, "Section",ExpressionUUID->"1161b4e0-d307-4e83-be62-e09824fa2dca"],
Cell[CellGroupData[{
Cell[187187, 4317, 1032, 27, 207, "Subsection",ExpressionUUID->"abfe3f30-e498-4f76-a08a-6cd0f8f78d7f"],
Cell[188222, 4346, 173, 3, 50, "Text",ExpressionUUID->"2879db80-39b4-4b0c-866d-e5c4f0715401"],
Cell[188398, 4351, 353, 9, 44, "Input",ExpressionUUID->"4a8674c1-17c4-49d8-b20f-484c7f863d0e"],
Cell[188754, 4362, 8943, 230, 1055, "Input",ExpressionUUID->"3c306f5c-d9a4-4a4b-ad0e-9169b1b3136c"]
}, Closed]],
Cell[CellGroupData[{
Cell[197734, 4597, 514, 11, 92, "Subsection",ExpressionUUID->"38269a39-a3e9-41ea-87d5-ab2658cb081a"],
Cell[198251, 4610, 277, 6, 44, "Input",ExpressionUUID->"9ff419a9-8e82-4437-aa5c-f4ae17c82021"],
Cell[198531, 4618, 5937, 138, 612, "Input",ExpressionUUID->"bc911d70-bfa8-41c4-9e8e-c80aff9210e3"]
}, Closed]],
Cell[CellGroupData[{
Cell[204505, 4761, 427, 10, 53, "Subsection",ExpressionUUID->"5fc82c13-1517-41c9-ae33-ff148ff329a7"],
Cell[204935, 4773, 419, 8, 181, "Text",ExpressionUUID->"30c0a713-7784-49d4-af5d-de72f3e2526b"],
Cell[205357, 4783, 609, 13, 116, "Text",ExpressionUUID->"7e6b40cb-4dac-4ba7-a057-884af49ae373"],
Cell[205969, 4798, 1586, 42, 135, "Input",ExpressionUUID->"4e88bd45-5673-4045-9a53-e6cdc9569734"],
Cell[207558, 4842, 7332, 170, 991, "Input",ExpressionUUID->"a7151ba2-b27f-486c-9a15-2a92253f0525"],
Cell[214893, 5014, 242, 6, 83, "Text",ExpressionUUID->"5db5bd80-26dd-4a91-9d3d-680f02e76df3"],
Cell[215138, 5022, 268, 6, 44, "Input",ExpressionUUID->"ef9c3a45-fdca-4695-b66c-c58562834498"],
Cell[215409, 5030, 687, 20, 75, "Input",ExpressionUUID->"5158348b-b7b0-4cf5-a5b6-635682667e2e"],
Cell[216099, 5052, 510, 15, 63, "Input",ExpressionUUID->"a605b2ca-a512-4a13-b79a-b840bacef4af"],
Cell[216612, 5069, 535, 15, 74, "Input",ExpressionUUID->"25c99bde-bbe6-4884-9c7d-3d77ec4a5e21"],
Cell[217150, 5086, 672, 19, 45, "Input",ExpressionUUID->"bac4091d-df79-4794-868d-5eee0633aacb"],
Cell[217825, 5107, 1195, 34, 104, "Input",ExpressionUUID->"d54f0a9f-6d7c-430f-b646-cdfb9b8fbb7a"],
Cell[219023, 5143, 1327, 26, 227, "Input",ExpressionUUID->"987ebfb2-0320-44e6-9159-eaff99ff82fd"],
Cell[220353, 5171, 3145, 80, 473, "Input",ExpressionUUID->"6fa6296e-175c-4134-9997-bf7e76fa08c6"],
Cell[223501, 5253, 960, 23, 227, "Input",ExpressionUUID->"16f5d7e8-98e2-45f3-9549-49bd17d159e0"],
Cell[224464, 5278, 399, 8, 181, "Text",ExpressionUUID->"a8650f76-513e-47dc-a5c9-30dc1e87c708"]
}, Closed]],
Cell[CellGroupData[{
Cell[224900, 5291, 183, 3, 53, "Subsection",ExpressionUUID->"05ae97e9-dfa8-4e22-8a7e-935c3855a6cc"],
Cell[225086, 5296, 277, 6, 83, "Text",ExpressionUUID->"bba283f7-9a5c-40d5-a30b-b6bc6d5f79e0"],
Cell[225366, 5304, 2277, 60, 404, "Input",ExpressionUUID->"a4ff257f-a9dc-4100-874e-b3c8179562f5"],
Cell[227646, 5366, 325, 7, 83, "Text",ExpressionUUID->"b4da65d5-0252-4222-869d-4f0a75249021"],
Cell[227974, 5375, 986, 29, 108, "Input",ExpressionUUID->"02b0cd0e-4f6b-4580-969e-ecd5e38b2124"],
Cell[228963, 5406, 233, 6, 83, "Text",ExpressionUUID->"f7ca2445-b5b9-4c5f-96d4-3311ee2561d9"],
Cell[229199, 5414, 1801, 47, 258, "Input",ExpressionUUID->"6d836220-d5d6-420b-808f-8f5c5e7a44da"],
Cell[231003, 5463, 230, 4, 50, "Text",ExpressionUUID->"21ddd1c4-d0ca-4970-826a-c91988c2ab4c"],
Cell[231236, 5469, 1113, 24, 258, "Input",ExpressionUUID->"be492992-d30b-4761-9c7c-972aa685a082"],
Cell[232352, 5495, 204, 3, 50, "Text",ExpressionUUID->"57bd6f3b-f407-4ce5-8363-62b6fdebfd5e"],
Cell[232559, 5500, 1576, 36, 350, "Input",ExpressionUUID->"29d36107-5b04-477c-bea0-5ec5053f66f0"]
}, Closed]],
Cell[CellGroupData[{
Cell[234172, 5541, 439, 11, 95, "Subsection",ExpressionUUID->"a69eaac0-5720-4db9-8c54-6d77377e0380"],
Cell[234614, 5554, 1026, 26, 181, "Text",ExpressionUUID->"9c734d65-904d-457b-bf1c-813dd2ff097c",
 InitializationCell->True],
Cell[235643, 5582, 419, 10, 44, "Input",ExpressionUUID->"6088f7c0-b8ca-4641-bc50-e67421a1bcf5"],
Cell[236065, 5594, 5125, 126, 640, "Input",ExpressionUUID->"1a460aaa-518d-428c-8b93-94f735e4bcf5"]
}, Closed]],
Cell[CellGroupData[{
Cell[241227, 5725, 461, 11, 53, "Subsection",ExpressionUUID->"ead4dacb-515c-4df9-b6d7-c31048e93665"],
Cell[241691, 5738, 324, 5, 50, "Text",ExpressionUUID->"7bbd518e-0b16-4f12-bff6-1dae739b786c",
 InitializationCell->True],
Cell[242018, 5745, 513, 12, 44, "Input",ExpressionUUID->"5a1a66de-97be-4b29-9f4f-f243c421246c"],
Cell[242534, 5759, 2875, 63, 411, "Input",ExpressionUUID->"bd22f8f1-4e7c-47f5-9e0b-6056c042d70b"]
}, Closed]],
Cell[CellGroupData[{
Cell[245446, 5827, 271, 6, 92, "Subsection",ExpressionUUID->"ddeb0e5f-3262-4043-b98b-7efff87bdf96"],
Cell[245720, 5835, 192, 3, 50, "Text",ExpressionUUID->"f8538ea4-6f86-4366-9f7c-841e63c59786"],
Cell[245915, 5840, 1170, 30, 135, "Input",ExpressionUUID->"b9d3a875-e594-47db-8e4f-e6087cf880de"],
Cell[247088, 5872, 3311, 84, 350, "Input",ExpressionUUID->"cf41a503-bccb-4055-898b-3c2118f40c3c"]
}, Closed]],
Cell[CellGroupData[{
Cell[250436, 5961, 167, 3, 53, "Subsection",ExpressionUUID->"e4930b6d-d6b1-4d18-be41-ba36ca92797b"],
Cell[250606, 5966, 431, 11, 44, "Input",ExpressionUUID->"7a0df3d5-2252-4852-b6a3-4955b46c9ed0"],
Cell[251040, 5979, 1488, 35, 135, "Input",ExpressionUUID->"0d866b4c-7660-4aff-accc-f237146b572d"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[252589, 6021, 407, 11, 85, "Chapter",ExpressionUUID->"9fe1f209-bb08-40b6-866c-60130d3cee70"],
Cell[CellGroupData[{
Cell[253021, 6036, 153, 3, 99, "Section",ExpressionUUID->"50bc5791-1281-4e61-ba22-562b8df48784"],
Cell[CellGroupData[{
Cell[253199, 6043, 292, 4, 79, "Subsection",ExpressionUUID->"71d038b9-f35b-43db-bf5b-4065efe384ea"],
Cell[253494, 6049, 180, 3, 50, "Text",ExpressionUUID->"b06172fa-0f90-4a62-ad0f-9c1f008cc888"],
Cell[253677, 6054, 1711, 46, 197, "Input",ExpressionUUID->"f39055ec-9bc6-46c2-95a4-8cde24e91edf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255425, 6105, 255, 4, 118, "Subsection",ExpressionUUID->"fb48f1cc-15b5-4a4e-889d-cb5b717d8be8"],
Cell[255683, 6111, 3294, 82, 350, "Input",ExpressionUUID->"0ecd546d-d7be-44be-a101-8b717667a056"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[259026, 6199, 153, 3, 76, "Section",ExpressionUUID->"f681910c-320d-444d-8a84-a1d91d83b46a"],
Cell[CellGroupData[{
Cell[259204, 6206, 797, 17, 118, "Subsection",ExpressionUUID->"79641990-223b-4768-9846-949bd9864fca"],
Cell[260004, 6225, 173, 3, 50, "Text",ExpressionUUID->"e00b74bd-23b3-4d22-9f51-97e0f68dc22b"],
Cell[260180, 6230, 16441, 400, 1669, "Input",ExpressionUUID->"01cc5b37-f797-41ce-a617-0a819d6e5808"]
}, Closed]],
Cell[CellGroupData[{
Cell[276658, 6635, 319, 9, 56, "Subsection",ExpressionUUID->"fff5da63-f145-424c-a887-3f76065132ae"],
Cell[276980, 6646, 3664, 100, 575, "Input",ExpressionUUID->"6252024f-35a1-4698-b67b-e5ab05d0d56f"],
Cell[280647, 6748, 785, 21, 77, "Input",ExpressionUUID->"d4a4bf4d-c8bf-4ec1-a911-8bd763138fff"]
}, Closed]],
Cell[CellGroupData[{
Cell[281469, 6774, 381, 10, 53, "Subsection",ExpressionUUID->"d56180b3-15c0-4179-950d-a2949aa8004d"],
Cell[281853, 6786, 332, 8, 44, "Input",ExpressionUUID->"9b03c443-48bf-4a2a-8b1b-603db5e78cc2"],
Cell[282188, 6796, 400, 9, 44, "Input",ExpressionUUID->"da89eedb-16dc-43a1-b2d4-abd2e5068242"]
}, Closed]],
Cell[CellGroupData[{
Cell[282625, 6810, 191, 3, 53, "Subsection",ExpressionUUID->"c5470dcc-7c89-4124-b492-3ab1fcde0a07"],
Cell[282819, 6815, 8944, 206, 918, "Input",ExpressionUUID->"0046c45a-663c-474f-bab7-d640e610a088"]
}, Closed]],
Cell[CellGroupData[{
Cell[291800, 7026, 463, 11, 56, "Subsection",ExpressionUUID->"dbd172c9-fbec-4716-a66a-9bc5847b2ed3"],
Cell[292266, 7039, 1026, 26, 181, "Text",ExpressionUUID->"070d1099-d5be-4e17-b61c-83ae5e0b6089",
 InitializationCell->True],
Cell[293295, 7067, 179, 3, 50, "Text",ExpressionUUID->"86960ddb-c787-466f-85d4-fa32dc630164"],
Cell[293477, 7072, 1143, 29, 197, "Input",ExpressionUUID->"feb98649-eecf-4adf-8cb2-9b0f5139a7b1"],
Cell[294623, 7103, 6585, 162, 790, "Input",ExpressionUUID->"4197185c-7eb3-4ce8-bee6-60e5472c000f"],
Cell[301211, 7267, 147, 3, 74, "Input",ExpressionUUID->"6898da0f-ce73-4657-a56c-7e386129f05e"]
}, Closed]],
Cell[CellGroupData[{
Cell[301395, 7275, 221, 5, 92, "Subsection",ExpressionUUID->"1f50b632-5411-412d-a569-6be1b3b78b3b"],
Cell[CellGroupData[{
Cell[301641, 7284, 171, 3, 65, "Subsubsection",ExpressionUUID->"06c5bbb2-42e5-4bf3-b4de-fabcbbc1583f"],
Cell[301815, 7289, 5990, 164, 1064, "Input",ExpressionUUID->"ce1b0aaf-2f58-46f0-b89d-f3c1eaf0e733"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307842, 7458, 178, 3, 65, "Subsubsection",ExpressionUUID->"68dc579e-86c5-4c4a-8dc0-cea462353eca"],
Cell[308023, 7463, 1125, 36, 217, "Input",ExpressionUUID->"3f752748-907b-4bed-8d7d-c1a831f1ec24"],
Cell[309151, 7501, 501, 14, 74, "Input",ExpressionUUID->"42377d3d-653f-4f11-aa0c-92b6de69b36d"]
}, Closed]],
Cell[CellGroupData[{
Cell[309689, 7520, 179, 3, 51, "Subsubsection",ExpressionUUID->"a59aa8cd-aefc-4714-a69b-843feb80bd95"],
Cell[309871, 7525, 558, 15, 166, "Input",ExpressionUUID->"6ac330b1-de2f-496f-8d74-05569a8a589f"]
}, Closed]],
Cell[CellGroupData[{
Cell[310466, 7545, 170, 3, 51, "Subsubsection",ExpressionUUID->"d57eee10-e3d2-4e05-a159-811c1f442804"],
Cell[310639, 7550, 1300, 33, 319, "Input",ExpressionUUID->"b314cc71-bada-4142-a739-9d73a437021c"],
Cell[311942, 7585, 258, 4, 98, "Text",ExpressionUUID->"a45742fd-825d-4321-948d-3124da3e61dc"],
Cell[312203, 7591, 1323, 39, 297, "Input",ExpressionUUID->"aee62406-e69b-4c4e-9cd2-c8e05419a18a"],
Cell[313529, 7632, 1272, 38, 298, "Input",ExpressionUUID->"b1d7f29f-c1da-4859-a70d-a36ef863b7fb"]
}, Closed]],
Cell[CellGroupData[{
Cell[314838, 7675, 177, 3, 51, "Subsubsection",ExpressionUUID->"15975a4b-7949-43c0-a0fb-0f66a0645f8e"],
Cell[315018, 7680, 615, 18, 130, "Input",ExpressionUUID->"0fd11c84-9a58-43d3-8b46-969a87e807c1"]
}, Closed]],
Cell[CellGroupData[{
Cell[315670, 7703, 293, 4, 51, "Subsubsection",ExpressionUUID->"b73d4e65-faea-441c-956d-0132a568f4e6"],
Cell[315966, 7709, 935, 26, 106, "Input",ExpressionUUID->"b7245691-2edd-4de1-89c4-23112aed130c"]
}, Closed]],
Cell[CellGroupData[{
Cell[316938, 7740, 300, 4, 51, "Subsubsection",ExpressionUUID->"707934d4-690b-4094-a1ff-614de90fc36d"],
Cell[317241, 7746, 1223, 37, 192, "Input",ExpressionUUID->"fe3c6f8a-4a2a-4d1f-a592-4a6a8cf69052"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[318513, 7789, 426, 10, 53, "Subsection",ExpressionUUID->"f931a0e3-5295-4bd6-90ae-4a607609f234"],
Cell[318942, 7801, 336, 9, 44, "Input",ExpressionUUID->"453fb5e0-210e-4e4a-92be-9ee2819a137f"],
Cell[319281, 7812, 4778, 120, 746, "Input",ExpressionUUID->"d3c9e932-988b-4ef7-9067-9d565093c1e5"],
Cell[CellGroupData[{
Cell[324084, 7936, 471, 11, 65, "Subsubsection",ExpressionUUID->"6115ee79-10eb-4a97-b3ec-080d0481b507"],
Cell[324558, 7949, 4030, 105, 653, "Input",ExpressionUUID->"9826ce33-cd33-4c8f-afbf-007f24178677"],
Cell[328591, 8056, 258, 6, 83, "Text",ExpressionUUID->"480d6ee9-da32-467d-a5dd-aba1ea2a78bf"],
Cell[328852, 8064, 2630, 67, 370, "Input",ExpressionUUID->"d4fee7b0-53e5-46cc-b23b-de5edba691a8"]
}, Closed]],
Cell[CellGroupData[{
Cell[331519, 8136, 347, 9, 51, "Subsubsection",ExpressionUUID->"f93f1d6f-ed0d-49c4-86b1-5877337e687e"],
Cell[331869, 8147, 3752, 101, 684, "Input",ExpressionUUID->"bcf58e8a-3fdf-4b7c-9fc0-803b6cc25967"],
Cell[335624, 8250, 2357, 62, 339, "Input",ExpressionUUID->"a16299ea-0b5f-4c1b-95a2-6e1ef055932e"]
}, Closed]],
Cell[CellGroupData[{
Cell[338018, 8317, 180, 3, 51, "Subsubsection",ExpressionUUID->"fc6535b9-0b9c-4ff9-873f-ff6b4a84672a"],
Cell[338201, 8322, 537, 15, 62, "Input",ExpressionUUID->"7576ebb3-c725-4514-adc0-17f049f2d151"],
Cell[338741, 8339, 600, 17, 70, "Input",ExpressionUUID->"663794f9-86d7-4a5b-b73f-023bef6b8b95"],
Cell[339344, 8358, 444, 12, 62, "Input",ExpressionUUID->"7fab0152-ce0c-475f-a2ec-afc9d05a399d"],
Cell[339791, 8372, 2643, 63, 442, "Input",ExpressionUUID->"fa2ee8b4-2649-4cee-9cdd-ae28bebaf64a"],
Cell[342437, 8437, 1008, 33, 107, "Input",ExpressionUUID->"cd66da17-2c5f-4269-892b-3df976a18719"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

